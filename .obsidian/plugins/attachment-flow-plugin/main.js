/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);
var __async = (__this, __arguments, generator) => {
  return new Promise((resolve, reject) => {
    var fulfilled = (value) => {
      try {
        step(generator.next(value));
      } catch (e) {
        reject(e);
      }
    };
    var rejected = (value) => {
      try {
        step(generator.throw(value));
      } catch (e) {
        reject(e);
      }
    };
    var step = (x) => x.done ? resolve(x.value) : Promise.resolve(x.value).then(fulfilled, rejected);
    step((generator = generator.apply(__this, __arguments)).next());
  });
};

// src/main.ts
var main_exports = {};
__export(main_exports, {
  default: () => AttachFlowPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian7 = require("obsidian");

// src/options/deleleAllAttachsInTheNote.ts
var import_obsidian4 = require("obsidian");

// src/util.ts
var import_obsidian = require("obsidian");
var import_child_process = require("child_process");
var import_fs = require("fs");
var import_obsidian2 = require("obsidian");
var DEBUG = false;
var SUCCESS_NOTICE_TIMEOUT = 1800;
var print = (message, ...optionalParams) => {
  if (DEBUG) {
    console.log(message, ...optionalParams);
  }
};
function setDebug(value) {
  DEBUG = value;
}
var checkReferenceInfo = (target_file, currentMd) => {
  const resolvedLinks = app.metadataCache.resolvedLinks;
  let CurMDPath;
  let result = {
    state: 0,
    mdPath: []
  };
  let refNum = 0;
  for (const [mdFile, links] of Object.entries(resolvedLinks)) {
    if (currentMd.path === mdFile) {
      CurMDPath = currentMd.path;
      result.mdPath.unshift(CurMDPath);
    }
    for (const [filePath, nr] of Object.entries(links)) {
      if ((target_file == null ? void 0 : target_file.path) === filePath) {
        refNum++;
        if (nr > 1) {
          result.state = 2 /* MORE */;
          result.mdPath.push(mdFile);
          return result;
        }
        result.mdPath.push(mdFile);
      }
    }
  }
  if (refNum > 1) {
    result.state = 1 /* MUTIPLE */;
  } else {
    result.state = 0 /* ONCE */;
  }
  return result;
};
var getFileByBaseName = (currentMd, FileBaseName) => {
  const resolvedLinks = app.metadataCache.resolvedLinks;
  for (const [mdFile, links] of Object.entries(resolvedLinks)) {
    if (currentMd.path === mdFile) {
      for (const [filePath, nr] of Object.entries(links)) {
        if (filePath.includes(FileBaseName)) {
          try {
            const AttachFile = app.vault.getAbstractFileByPath(filePath);
            if (AttachFile instanceof import_obsidian.TFile) {
              return AttachFile;
            }
          } catch (error) {
            new import_obsidian.Notice(` cannot get the image file`);
            console.error(error);
          }
        }
      }
    }
  }
};
var PureClearAttachment = (file, target_type, plugin) => __async(void 0, null, function* () {
  const deleteOption = plugin.settings.deleteOption;
  const delFileFolder = onlyOneFileExists(file);
  const fileFolder = getFileParentFolder(file);
  let name = target_type == "img" ? "Image" : "File";
  try {
    if (deleteOption === ".trash") {
      yield app.vault.trash(file, false);
      new import_obsidian.Notice(name + " moved to Obsidian Trash !", SUCCESS_NOTICE_TIMEOUT);
      if (delFileFolder) {
        yield app.vault.trash(fileFolder, false);
        new import_obsidian.Notice("Attachment folder have been deleted!", 3e3);
      }
    } else if (deleteOption === "system-trash") {
      yield app.vault.trash(file, true);
      new import_obsidian.Notice(name + " moved to System Trash !", SUCCESS_NOTICE_TIMEOUT);
      if (delFileFolder) {
        yield app.vault.trash(fileFolder, true);
        new import_obsidian.Notice("Attachment folder have been deleted!", 3e3);
      }
    } else if (deleteOption === "permanent") {
      yield app.vault.delete(file);
      new import_obsidian.Notice(name + " deleted Permanently !", SUCCESS_NOTICE_TIMEOUT);
      if (delFileFolder) {
        yield app.vault.delete(fileFolder, true);
        new import_obsidian.Notice("Attachment folder have been deleted!", 3e3);
      }
    }
  } catch (error) {
    console.error(error);
    new import_obsidian.Notice("Faild to delelte the " + name + "!", SUCCESS_NOTICE_TIMEOUT);
  }
});
var handlerDelFileNew = (FileBaseName, currentMd, plugin, target_type, target_pos, in_table, in_callout) => {
  let logs;
  let modal;
  const target_file = getFileByBaseName(currentMd, FileBaseName);
  const refInfo = checkReferenceInfo(target_file, currentMd);
  let state = refInfo.state;
  switch (state) {
    case 0:
      deleteCurTargetLink(FileBaseName, plugin, target_type, target_pos, in_table, in_callout);
      PureClearAttachment(target_file, target_type, plugin);
      break;
    case 1:
    case 2:
      deleteCurTargetLink(FileBaseName, plugin, target_type, target_pos, in_table, in_callout);
      logs = refInfo.mdPath;
      new import_obsidian.Notice("As other references of current file exist, just deleted the current reference link without deleting the actual file.", 3500);
    default:
      break;
  }
};
var deleteCurTargetLink = (file_base_name, plugin, target_type, target_pos, in_table, in_callout) => {
  file_base_name = file_base_name.startsWith("/") ? file_base_name.substring(1) : file_base_name;
  const activeView = plugin.app.workspace.getActiveViewOfType(import_obsidian.MarkdownView);
  const editor = activeView.editor;
  const editorView = editor.cm;
  let target_line = editorView.state.doc.lineAt(target_pos);
  let line_text = target_line.text;
  if (!in_table && !in_callout) {
    let finds = findLinkInLine(file_base_name, line_text);
    if (finds.length == 0) {
      new import_obsidian.Notice("Fail to find the link-text, please delete it manually!", 0);
      return;
    } else if (finds.length != 1) {
      new import_obsidian.Notice("Find multiple same Link in current line, please delete it manually!", 0);
      return;
    } else {
      editor.replaceRange("", { line: target_line.number - 1, ch: finds[0][0] }, { line: target_line.number - 1, ch: finds[0][1] });
      return;
    }
  }
  let startReg = {
    "table": /^\s*\|/,
    "callout": /^>/
  };
  let mode = in_table ? "table" : "callout";
  let finds_lines = [];
  let finds_all = [];
  for (let i = target_line.number; i <= editor.lineCount(); i++) {
    let line_text2 = editor.getLine(i - 1);
    if (!startReg[mode].test(line_text2))
      break;
    print(`line_${i}_text:`, line_text2);
    let finds = findLinkInLine(file_base_name, line_text2);
    if (finds.length > 0) {
      finds_lines.push(...new Array(finds.length).fill(i));
      finds_all.push(...finds);
    }
  }
  for (let i = target_line.number - 1; i >= 1; i--) {
    let line_text2 = editor.getLine(i - 1);
    if (!startReg[mode].test(line_text2))
      break;
    print(`line_${i}_text:`, line_text2);
    let finds = findLinkInLine(file_base_name, line_text2);
    if (finds.length > 0) {
      finds_lines.push(...new Array(finds.length).fill(i));
      finds_all.push(...finds);
    }
  }
  if (finds_all.length == 0) {
    new import_obsidian.Notice(`Fail to find the link-text (for links in ${mode}), please delete it manually!`, 0);
    return;
  } else if (finds_all.length != 1) {
    new import_obsidian.Notice(`Find multiple same Link in current ${mode}, please delete it manually!`, 0);
    return;
  } else {
    editor.replaceRange("", { line: finds_lines[0] - 1, ch: finds_all[0][0] }, { line: finds_lines[0] - 1, ch: finds_all[0][1] });
  }
  editor.focus();
};
var handlerCopyFile = (FileBaseName, currentMd, plugin) => __async(void 0, null, function* () {
  const file = getFileByBaseName(currentMd, FileBaseName);
  const basePath = file.vault.adapter.basePath;
  const file_ab_path = basePath + "/" + file.path;
  try {
    copyFileToClipboardCMD(file_ab_path);
    new import_obsidian.Notice("Copied to clipboard !", SUCCESS_NOTICE_TIMEOUT);
  } catch (error) {
    console.error(error);
    new import_obsidian.Notice("Faild to copy the file !", SUCCESS_NOTICE_TIMEOUT);
  }
});
var getFileParentFolder = (file) => {
  if (file instanceof import_obsidian.TFile) {
    if (file.parent instanceof import_obsidian.TFolder) {
      return file.parent;
    }
  }
  return;
};
var onlyOneFileExists = (file) => {
  const fileFolder = getFileParentFolder(file);
  return fileFolder.children.length === 1;
};
function copyFileToClipboardCMD(filePath) {
  if (!(0, import_fs.existsSync)(filePath)) {
    console.error(`File ${filePath} does not exist`);
    return;
  }
  const callback = (error, stdout, stderr) => {
    if (error) {
      new import_obsidian.Notice(`Error executing command: ${error.message}`, SUCCESS_NOTICE_TIMEOUT);
      console.error(`Error executing command: ${error.message}`);
      return;
    }
  };
  if (process.platform === "darwin") {
    (0, import_child_process.execSync)(`open -R "${filePath}"`);
    (0, import_child_process.execSync)(`osascript -e 'tell application "System Events" to keystroke "c" using command down'`);
    (0, import_child_process.execSync)(`osascript -e 'tell application "System Events" to keystroke "w" using command down'`);
    (0, import_child_process.execSync)(`open -a "Obsidian.app"`);
  } else if (process.platform === "linux") {
  } else if (process.platform === "win32") {
    (0, import_child_process.exec)(`powershell -command "Set-Clipboard -Path '${filePath}'"`, callback);
  }
}
var findLinkInLine = (file_name, line_text) => {
  const file_name_mdlink = file_name.replace(/ /g, "%20");
  let regWikiLink = /\!\[\[[^\[\]]*?\]\]/g;
  let regMdLink = /\!\[[^\[\]]*?\]\([^\s\)\(\[\]\{\}']*\)/g;
  print("target_name (WIKI/MD):", file_name, file_name_mdlink);
  let search_result = [];
  if (line_text.includes(file_name)) {
    while (true) {
      let match = regWikiLink.exec(line_text);
      if (!match)
        break;
      let matched_link = match[0];
      print("matched_link:", matched_link);
      print("matched_link.includes(file_name)", matched_link.includes(file_name));
      if (matched_link.includes(file_name)) {
        search_result.push([match.index, match.index + matched_link.length]);
      }
    }
  }
  if (line_text.includes(file_name_mdlink)) {
    while (true) {
      let match = regMdLink.exec(line_text);
      if (!match)
        break;
      let matched_link = match[0];
      print("matched_link:", matched_link);
      print("matched_link.includes(file_name_mdlink)", matched_link.includes(file_name_mdlink));
      if (matched_link.includes(file_name_mdlink)) {
        search_result.push([match.index, match.index + matched_link.length]);
      }
    }
  }
  return search_result;
};
var handlerRenameFile = (FileBaseName, currentMd, plugin) => {
  const target_file = getFileByBaseName(currentMd, FileBaseName);
  let path = target_file.path;
  let name = target_file.name;
  let target_folder = path.substring(0, path.length - name.length);
  let file_type = name.split(".").pop();
  new RenameModal(plugin.app, target_folder, name.substring(0, name.length - file_type.length - 1), file_type, (result) => {
    if (!result)
      return;
    if (result == path)
      return;
    app.vault.adapter.exists(result).then((exists) => {
      if (exists) {
        new import_obsidian.Notice(`Fail to rename for there alreay exist file ${result}`);
      } else {
        plugin.app.fileManager.renameFile(target_file, `${result}`);
      }
    });
  }).open();
};
var RenameModal = class extends import_obsidian2.Modal {
  constructor(app2, folder, name, filetype, onSubmit) {
    super(app2);
    this.onSubmit = onSubmit;
    this.folder = folder;
    this.name = name;
    this.filetype = filetype;
  }
  onOpen() {
    const { contentEl } = this;
    let setting = new import_obsidian2.Setting(contentEl).setName("Rename:").addText((text) => text.setValue(this.name).onChange((value) => {
      this.result = `${this.folder}${value}.${this.filetype}`;
    }));
    setTimeout(() => {
      let inputBox = setting.settingEl.querySelector('input[type="text"]');
      if (inputBox && inputBox.parentElement) {
        let folder_indicator = document.createElement("label");
        folder_indicator.innerText = `${this.folder}`;
        folder_indicator.style.marginRight = "4px";
        inputBox.parentElement.insertBefore(folder_indicator, inputBox);
        let file_type_indicator = document.createElement("label");
        file_type_indicator.innerText = `.${this.filetype}`;
        file_type_indicator.style.marginLeft = "4px";
        inputBox.after(file_type_indicator);
        let parentEl = setting.settingEl.parentElement;
        if (parentEl) {
          parentEl.style.display = "flex";
          parentEl.style.justifyContent = "center";
        }
        let inputElem = inputBox;
        inputElem.select();
      } else {
        console.error("\u65E0\u6CD5\u627E\u5230\u6587\u672C\u8F93\u5165\u6846");
      }
    }, 0);
    this.scope.register([], "Enter", (evt) => {
      if (evt.isComposing) {
        return;
      }
      this.close();
      this.onSubmit(this.result);
    });
  }
  onClose() {
    let { contentEl } = this;
    contentEl.empty();
  }
};

// src/utils/deleteFile.ts
var import_obsidian3 = require("obsidian");
var SUCCESS_NOTICE_TIMEOUT2 = 1800;
var deleteFile = (file, plugin) => __async(void 0, null, function* () {
  const deleteOption = plugin.settings.deleteOption;
  try {
    if (deleteOption === ".trash") {
      yield app.vault.trash(file, false);
    } else if (deleteOption === "system-trash") {
      yield app.vault.trash(file, true);
    } else if (deleteOption === "permanent") {
      yield app.vault.delete(file);
    }
  } catch (error) {
    console.error(error);
    new import_obsidian3.Notice("Faild to delete the file/folder !", SUCCESS_NOTICE_TIMEOUT2);
  }
});

// src/options/deleleAllAttachsInTheNote.ts
var deleteAllAttachs = (plugin) => __async(void 0, null, function* () {
  const activeMd = app.workspace.getActiveFile();
  const resolvedLinks = app.metadataCache.resolvedLinks;
  const attachsPaths = [];
  for (const [mdFile, links] of Object.entries(resolvedLinks)) {
    if ((activeMd == null ? void 0 : activeMd.path) === mdFile) {
      let fileCount = 0;
      let flag = false;
      for (const [filePath, nr] of Object.entries(links)) {
        if (filePath.match(/.*\.md$/m))
          continue;
        if (isReferencedByOtherNotes(filePath, activeMd))
          continue;
        attachsPaths.push(filePath);
        try {
          const AttachFile = app.vault.getAbstractFileByPath(filePath);
          if (AttachFile instanceof import_obsidian4.TFile) {
            deleteFile(AttachFile, plugin);
          }
          const parentFolder = getFileParentFolder(AttachFile);
          if (!flag) {
            fileCount = parentFolder.children.length;
            flag = !flag;
          }
          fileCount = fileCount - 1;
          if (!fileCount) {
            yield deleteFile(parentFolder, plugin);
            new import_obsidian4.Notice("All attachments and its parent folder deleted!", 3e3);
          }
        } catch (error) {
          console.warn(error);
        }
      }
    }
  }
});
var isReferencedByOtherNotes = (attachPath, currentMd) => {
  const resolvedLinks = app.metadataCache.resolvedLinks;
  let flag = false;
  for (const [mdFile, links] of Object.entries(resolvedLinks)) {
    if (mdFile !== currentMd.path) {
      for (const [filePath, nr] of Object.entries(links)) {
        if (filePath === attachPath) {
          flag = true;
        }
      }
    }
  }
  return flag;
};
var getRefencedLinkCount = () => {
  const activeMd = app.workspace.getActiveFile();
  const resolvedLinks = app.metadataCache.resolvedLinks;
  const attachsPaths = [];
  for (const [mdFile, links] of Object.entries(resolvedLinks)) {
    if ((activeMd == null ? void 0 : activeMd.path) === mdFile) {
      for (const [filePath, nr] of Object.entries(links)) {
        if (filePath.match(/.*\.md$/m))
          continue;
        if (isReferencedByOtherNotes(filePath, activeMd))
          continue;
        attachsPaths.push(filePath);
      }
    }
  }
  return attachsPaths.length;
};

// src/config/addCommand-config.ts
var addCommand = (myPlugin) => {
  myPlugin.addCommand({
    id: "clear-all-attachments-in-current-file",
    name: "clear all attachments in current file",
    callback: () => __async(void 0, null, function* () {
      deleteAllAttachs(myPlugin);
    })
  });
};

// src/settings.ts
var import_obsidian5 = require("obsidian");
var DEFAULT_SETTINGS = {
  deleteOption: ".trash",
  logsModal: true,
  dragResize: false,
  debug: false
};
var AttachFlowSettingsTab = class extends import_obsidian5.PluginSettingTab {
  constructor(app2, plugin) {
    super(app2, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "AttachFlow plugin Settings" });
    new import_obsidian5.Setting(containerEl).setName("Deleted Attachment Destination").setDesc("Select where you want Attachments to be moved once they are deleted").addDropdown((dropdown) => {
      dropdown.addOption("permanent", "Delete Permanently");
      dropdown.addOption(".trash", "Move to Obsidian Trash");
      dropdown.addOption("system-trash", "Move to System Trash");
      dropdown.setValue(this.plugin.settings.deleteOption);
      dropdown.onChange((option) => {
        this.plugin.settings.deleteOption = option;
        this.plugin.saveSettings();
      });
    });
    new import_obsidian5.Setting(containerEl).setName("Drag To Resize Images").setDesc("\u62D6\u62FD\u8C03\u6574\u56FE\u7247\u5927\u5C0F").addToggle((toggle) => {
      toggle.setValue(this.plugin.settings.dragResize).onChange((value) => __async(this, null, function* () {
        this.plugin.settings.dragResize = value;
        yield this.plugin.saveSettings();
      }));
    });
    new import_obsidian5.Setting(containerEl).setName("Print Debug Information").setDesc("\u63A7\u5236\u53F0\u8F93\u51FA\u8C03\u8BD5\u4FE1\u606F").addToggle((toggle) => {
      toggle.setValue(this.plugin.settings.debug).onChange((value) => __async(this, null, function* () {
        this.plugin.settings.debug = value;
        setDebug(value);
        yield this.plugin.saveSettings();
      }));
    });
  }
};

// src/utils/handlerEvent.ts
var getMouseEventTarget = (event) => {
  event.preventDefault();
  const target = event.target;
  return target;
};

// src/modals/deletionPrompt.ts
var import_obsidian6 = require("obsidian");
var DeleteAllLogsModal = class extends import_obsidian6.Modal {
  constructor(note, myPlugin) {
    super(app);
    this.note = note;
    this.myPlugin = myPlugin;
  }
  getLog() {
    const referenceMessage = `Are you sure you want to delete "${this.note.basename}.md"?

It will be moved to your ${this.myPlugin.settings.deleteOption}.`;
    return referenceMessage;
  }
  showLogs() {
    const logs = this.contentEl.createEl("div");
    logs.addClass("attachment-flow-log");
    logs.setText(this.getLog());
  }
  onOpen() {
    const { contentEl } = this;
    const myModal = this;
    const headerWrapper = contentEl.createEl("div");
    headerWrapper.addClass("attachment-flow-center-wrapper");
    this.showLogs();
    const referencedMessageWrapper = contentEl.createEl("span");
    referencedMessageWrapper.style.color = "red";
    const referencedMessage = `There are(is) currently  [${getRefencedLinkCount()}]  non-multi-referenced link(s) pointing to this note.`;
    referencedMessageWrapper.append(referencedMessage);
    const buttonWrapper = this.contentEl.createEl("div");
    buttonWrapper.addClass("attachment-flow-center-wrapper");
    const headerEl = headerWrapper.createEl("h1", {
      text: "Delete the file and its all attachments - logs "
    });
    headerEl.addClass("modal-title");
    this.showConfirmButton(buttonWrapper, myModal);
    this.showCancelBtn(buttonWrapper, myModal);
  }
  showCancelBtn(buttonWrapper, myModal) {
    const closeButton = buttonWrapper.createEl("button", {
      text: "Cancel"
    });
    closeButton.setAttribute("aria-label", "Cancel the operation");
    closeButton.addEventListener("click", () => {
      myModal.close();
    });
  }
  showConfirmButton(buttonWrapper, myModal) {
    const removeLinkButton = buttonWrapper.createEl("button", {
      text: "Confirm"
    });
    removeLinkButton.setAttribute("aria-label", "Continue to delete current file and its all non-multi-referenced attachments");
    removeLinkButton.addClass("mod-warning");
    removeLinkButton.addEventListener("click", () => __async(this, null, function* () {
      deleteFile(this.note, this.myPlugin);
      deleteAllAttachs(this.myPlugin);
      myModal.close();
    }));
  }
};

// src/helpers.ts
function onElement(el, event, selector, listener, options) {
  el.on(event, selector, listener, options);
  return () => el.off(event, selector, listener, options);
}

// src/main.ts
var AttachFlowPlugin = class extends import_obsidian7.Plugin {
  constructor() {
    super(...arguments);
    this.addMenuExtendedSourceMode = (menu, FileBaseName, currentMd, target_type, target_pos, inTable, inCallout) => {
      menu.addItem((item) => item.setIcon("trash-2").setTitle("Clear file and associated link").onClick(() => __async(this, null, function* () {
        try {
          handlerDelFileNew(FileBaseName, currentMd, this, target_type, target_pos, inTable, inCallout);
        } catch (e) {
          new import_obsidian7.Notice("Error, could not clear the file!");
        }
      })));
      menu.addItem((item) => item.setIcon("pencil").setTitle("Rename").onClick(() => __async(this, null, function* () {
        try {
          print("test rename");
          handlerRenameFile(FileBaseName, currentMd, this);
        } catch (e) {
          new import_obsidian7.Notice("Error, could not rename the file!");
        }
      })));
      this.addMenuExtendedPreviewMode(menu, FileBaseName, currentMd);
    };
    this.addMenuExtendedPreviewMode = (menu, FileBaseName, currentMd) => {
      const file = getFileByBaseName(currentMd, FileBaseName);
      menu.addItem((item) => item.setIcon("copy").setTitle("Copy file to clipboard").onClick(() => __async(this, null, function* () {
        try {
          handlerCopyFile(FileBaseName, currentMd, this);
        } catch (e) {
          new import_obsidian7.Notice("Error, could not copy the file!");
        }
      })));
      menu.addItem((item) => item.setIcon("arrow-up-right").setTitle("Open in default app").onClick(() => this.app.openWithDefaultApp(file.path)));
      menu.addItem((item) => item.setIcon("arrow-up-right").setTitle(import_obsidian7.Platform.isMacOS ? "Reveal in finder" : "Show in system explorer").onClick(() => {
        this.app.showInFolder(file.path);
      }));
      menu.addItem((item) => item.setIcon("folder").setTitle("Reveal file in navigation").onClick(() => {
        const abstractFilePath = this.app.vault.getAbstractFileByPath(file.path);
        this.app.internalPlugins.getEnabledPluginById("file-explorer").revealInFolder(abstractFilePath);
      }));
    };
  }
  onload() {
    return __async(this, null, function* () {
      console.log("AttachFlow plugin loaded...");
      this.addSettingTab(new AttachFlowSettingsTab(this.app, this));
      yield this.loadSettings();
      this.registerDocument(document);
      app.workspace.on("window-open", (workspaceWindow, window) => {
        this.registerDocument(window.document);
      });
      this.registerEvent(this.app.workspace.on("file-menu", (menu, file) => {
        if (file instanceof import_obsidian7.TFile) {
          if (!file.path.endsWith(".md"))
            return;
          const addMenuItem = (item) => {
            item.setTitle("Delete file and its attachments").setIcon("trash-2").setSection("danger");
            item.onClick(() => __async(this, null, function* () {
              const modal = new DeleteAllLogsModal(file, this);
              modal.open();
            }));
          };
          menu.addItem(addMenuItem);
        }
      }));
      addCommand(this);
      setDebug(this.settings.debug);
    });
  }
  onunload() {
    console.log("AttachFlow plugin unloaded...");
  }
  registerDocument(document2) {
    this.register(onElement(document2, "contextmenu", "img, iframe, video, div.file-embed-title, audio", this.onClick.bind(this)));
    this.register(onElement(document2, "mousedown", "img, video", (event) => {
      var _a, _b;
      if (!this.settings.dragResize)
        return;
      const currentMd = app.workspace.getActiveFile();
      if (currentMd.name.endsWith(".canvas"))
        return;
      const inPreview = ((_a = this.app.workspace.getActiveViewOfType(import_obsidian7.MarkdownView)) == null ? void 0 : _a.getMode()) == "preview";
      if (inPreview)
        return;
      if (event.button === 0) {
        event.preventDefault();
      }
      const img = event.target;
      const editor = (_b = this.app.workspace.getActiveViewOfType(import_obsidian7.MarkdownView)) == null ? void 0 : _b.editor;
      const editorView = editor.cm;
      const target_pos = editorView.posAtDOM(img);
      let target_line = editorView.state.doc.lineAt(target_pos);
      const inTable = img.closest("table") != null;
      const inCallout = img.closest(".callout") != null;
      const isExcalidraw = img.classList.contains("excalidraw-embedded-img");
      print("InTable", inTable);
      print("Target Element", img);
      if (isExcalidraw) {
        print("Excalidraw file!");
      }
      const rect = img.getBoundingClientRect();
      const x = event.clientX - rect.left;
      const y = event.clientY - rect.top;
      const edgeSize = 30;
      if (x < edgeSize || y < edgeSize || x > rect.width - edgeSize || y > rect.height - edgeSize) {
        const startX = event.clientX;
        const startY = event.clientY;
        const startWidth = img.clientWidth;
        const startHeight = img.clientHeight;
        let lastUpdateX = startX;
        let lastUpdateY = startY;
        const updateThreshold = 5;
        const onMouseMove = (event2) => {
          var _a2;
          const currentX = event2.clientX;
          let newWidth = startWidth + (currentX - startX);
          const aspectRatio = startWidth / startHeight;
          newWidth = Math.max(newWidth, 50);
          let newHeight = newWidth / aspectRatio;
          newWidth = Math.round(newWidth);
          newHeight = Math.round(newHeight);
          if (img instanceof HTMLImageElement) {
            img.style.border = "solid";
            img.style.borderWidth = "2px";
            img.style.borderColor = "blue";
            img.style.boxSizing = "border-box";
            img.style.width = `${newWidth}px`;
          } else if (img instanceof HTMLVideoElement) {
            img.style.border = "solid";
            img.style.borderWidth = "2px";
            img.style.borderColor = "blue";
            img.style.boxSizing = "border-box";
            if (img.parentElement) {
              const containerWidth = img.parentElement.clientWidth;
              const newWidthPercentage = newWidth / containerWidth * 100;
              img.style.width = `${newWidthPercentage}%`;
            }
          }
          if (Math.abs(event2.clientX - lastUpdateX) > updateThreshold) {
            const activeView = this.app.workspace.getActiveViewOfType(import_obsidian7.MarkdownView);
            if (activeView) {
              print("update new Width", newWidth);
              let imageName = img.getAttribute("src");
              if (imageName == null ? void 0 : imageName.startsWith("http")) {
                updateExternalLink(activeView, img, target_pos, newWidth, newHeight, inTable, inCallout);
              } else if (isExcalidraw) {
                let target_name = img.getAttribute("filesource");
                let draw_base_name = target_name;
                if (draw_base_name.includes("/")) {
                  let temp_arr = draw_base_name.split("/");
                  draw_base_name = temp_arr[temp_arr.length - 1];
                } else if (draw_base_name.includes("\\")) {
                  let temp_arr = draw_base_name.split("\\");
                  draw_base_name = temp_arr[temp_arr.length - 1];
                }
                draw_base_name = draw_base_name.endsWith(".md") ? draw_base_name.substring(0, draw_base_name.length - 3) : draw_base_name;
                print(target_name);
                print("excalidraw file:", draw_base_name);
                img.style.maxWidth = "none";
                updateInternalLink(activeView, img, target_pos, draw_base_name, newWidth, newHeight, inTable, inCallout);
              } else {
                imageName = (_a2 = img.parentElement) == null ? void 0 : _a2.getAttribute("src");
                updateInternalLink(activeView, img, target_pos, imageName, newWidth, newHeight, inTable, inCallout);
              }
            }
            lastUpdateX = event2.clientX;
            lastUpdateY = event2.clientY;
          }
        };
        const onMouseUp = (event2) => {
          event2.preventDefault();
          img.style.borderStyle = "none";
          img.style.outline = "none";
          img.style.cursor = "default";
          document2.removeEventListener("mousemove", onMouseMove);
          document2.removeEventListener("mouseup", onMouseUp);
        };
        document2.addEventListener("mousemove", onMouseMove);
        document2.addEventListener("mouseup", onMouseUp);
      }
    }));
    this.register(onElement(document2, "mouseover", "img, video", (event) => {
      var _a;
      if (!this.settings.dragResize)
        return;
      const currentMd = app.workspace.getActiveFile();
      if (currentMd.name.endsWith(".canvas"))
        return;
      const inPreview = ((_a = this.app.workspace.getActiveViewOfType(import_obsidian7.MarkdownView)) == null ? void 0 : _a.getMode()) == "preview";
      if (inPreview)
        return;
      const img = event.target;
      const rect = img.getBoundingClientRect();
      const edgeSize = 30;
      const isExcalidraw = img.classList.contains("excalidraw-embedded-img");
      let lastMove = 0;
      const mouseOverHandler = (event2) => {
        if (!this.settings.dragResize)
          return;
        const now = Date.now();
        if (now - lastMove < 100)
          return;
        lastMove = now;
        const x = event2.clientX - rect.left;
        const y = event2.clientY - rect.top;
        if (x >= rect.width - edgeSize || x <= edgeSize || (y >= rect.height - edgeSize || y <= edgeSize)) {
          img.style.cursor = "nwse-resize";
          img.style.outline = "solid";
          img.style.outlineWidth = "6px";
          img.style.outlineColor = "#dfb0f283";
        } else {
          img.style.cursor = "default";
          img.style.outline = "none";
        }
      };
      this.registerDomEvent(img, "mousemove", mouseOverHandler);
    }));
    this.register(onElement(document2, "mouseout", "img, video", (event) => {
      var _a;
      if (!this.settings.dragResize)
        return;
      const currentMd = app.workspace.getActiveFile();
      if (currentMd.name.endsWith(".canvas"))
        return;
      const inPreview = ((_a = this.app.workspace.getActiveViewOfType(import_obsidian7.MarkdownView)) == null ? void 0 : _a.getMode()) == "preview";
      if (inPreview)
        return;
      const img = event.target;
      img.style.borderStyle = "none";
      img.style.cursor = "default";
      img.style.outline = "none";
    }));
  }
  loadSettings() {
    return __async(this, null, function* () {
      this.settings = Object.assign({}, DEFAULT_SETTINGS, yield this.loadData());
    });
  }
  saveSettings() {
    return __async(this, null, function* () {
      yield this.saveData(this.settings);
    });
  }
  registerEscapeButton(menu, document2 = activeDocument) {
    menu.register(onElement(document2, "keydown", "*", (e) => {
      if (e.key === "Escape") {
        e.preventDefault();
        e.stopPropagation();
        menu.hide();
      }
    }));
  }
  onClick(event) {
    var _a, _b, _c, _d, _e;
    const target = getMouseEventTarget(event);
    const curTargetType = target.localName;
    const currentMd = app.workspace.getActiveFile();
    const inCanvas = currentMd.name.endsWith(".canvas");
    const SupportedTargetType = ["img", "iframe", "video", "div", "audio"];
    const menu = new import_obsidian7.Menu();
    if (!SupportedTargetType.includes(curTargetType))
      return;
    const inTable = target.closest("table") != null;
    const inCallout = target.closest(".callout") != null;
    const inPreview = ((_a = this.app.workspace.getActiveViewOfType(import_obsidian7.MarkdownView)) == null ? void 0 : _a.getMode()) == "preview";
    const isExcalidraw = target.classList.contains("excalidraw-embedded-img");
    let target_name = target.getAttribute("src");
    if (target_name && target_name.startsWith("http"))
      return;
    if (inCanvas) {
      if ((_b = target.parentElement) == null ? void 0 : _b.classList.contains("canvas-node-content"))
        return;
      let file_name = (_c = target.parentElement) == null ? void 0 : _c.getAttribute("src");
      return;
    }
    if (isExcalidraw) {
      target_name = target.getAttribute("filesource");
      let file_base_name = target_name;
      if (file_base_name.includes("/")) {
        let temp_arr = file_base_name.split("/");
        file_base_name = temp_arr[temp_arr.length - 1];
      } else if (file_base_name.includes("\\")) {
        let temp_arr = file_base_name.split("\\");
        file_base_name = temp_arr[temp_arr.length - 1];
      }
      file_base_name = file_base_name.endsWith(".md") ? file_base_name.substring(0, file_base_name.length - 3) : file_base_name;
      target_name = file_base_name;
    } else {
      target_name = (_d = target.parentElement) == null ? void 0 : _d.getAttribute("src");
      target_name = target_name.replace(/^(\.\.\/)+/g, "");
      let pdf_match = target_name.match(/.*\.pdf/);
      target_name = pdf_match ? pdf_match[0] : target_name;
      if (curTargetType == "img" && pdf_match)
        return;
    }
    if (inPreview) {
      if (SupportedTargetType.includes(curTargetType)) {
        this.addMenuExtendedPreviewMode(menu, target_name, currentMd);
      }
    } else {
      const editor = (_e = this.app.workspace.getActiveViewOfType(import_obsidian7.MarkdownView)) == null ? void 0 : _e.editor;
      const editorView = editor.cm;
      const target_pos = editorView.posAtDOM(target);
      let target_line = editorView.state.doc.lineAt(target_pos);
      print("target line information: line-content, line-number(1-based), target.ch");
      print(target_line.text, target_line.number, target_pos - target_line.from);
      if (SupportedTargetType.includes(curTargetType)) {
        this.addMenuExtendedSourceMode(menu, target_name, currentMd, curTargetType, target_pos, inTable, inCallout);
      }
    }
    this.registerEscapeButton(menu);
    if (inTable && !inPreview) {
      menu.showAtPosition({ x: event.pageX, y: event.pageY - 163 });
    } else {
      menu.showAtPosition({ x: event.pageX, y: event.pageY });
    }
    this.app.workspace.trigger("AttachFlow:contextmenu", menu);
  }
};
function updateInternalLink(activeView, target, target_pos, imageName, newWidth, newHeight, inTable, inCallout) {
  const editor = activeView.editor;
  const editorView = editor.cm;
  let target_line = editorView.state.doc.lineAt(target_pos);
  if (!inCallout && !inTable) {
    let matched = matchLineWithInternalLink(target_line.text, imageName, newWidth, inTable);
    if (matched.length == 1) {
      editorView.dispatch({
        changes: {
          from: target_line.from + matched[0].from_ch,
          to: target_line.from + matched[0].to_ch,
          insert: matched[0].new_link
        }
      });
    } else if (matched.length == 0) {
    } else {
      new import_obsidian7.Notice("Find multiple same image-link in line, please zoom manually!");
    }
    return;
  }
  let startReg = {
    "table": /^\s*\|/,
    "callout": /^>/
  };
  let mode = inTable ? "table" : "callout";
  print("mode", mode);
  const start_reg = startReg[mode];
  let start_line_number = target_line.number;
  let matched_results = [];
  let matched_lines = [];
  for (let i = start_line_number; i <= editor.lineCount(); i++) {
    let line = editorView.state.doc.line(i);
    if (!start_reg.test(line.text))
      break;
    let matched = matchLineWithInternalLink(line.text, imageName, newWidth, inTable);
    matched_results.push(...matched);
    matched_lines.push(...new Array(matched.length).fill(i));
  }
  for (let i = start_line_number - 1; i >= 1; i--) {
    let line = editorView.state.doc.line(i);
    if (!start_reg.test(line.text))
      break;
    let matched = matchLineWithInternalLink(line.text, imageName, newWidth, inTable);
    matched_results.push(...matched);
    matched_lines.push(...new Array(matched.length).fill(i));
  }
  if (matched_results.length == 1) {
    let target_line2 = editorView.state.doc.line(matched_lines[0]);
    if (mode == "table") {
      let old_text = target_line2.text;
      let new_line_text = old_text.substring(0, matched_results[0].from_ch) + matched_results[0].new_link + old_text.substring(matched_results[0].to_ch);
      editorView.dispatch({
        changes: {
          from: target_line2.from,
          to: target_line2.from + old_text.length,
          insert: new_line_text
        }
      });
    } else {
      editorView.dispatch({
        changes: {
          from: target_line2.from + matched_results[0].from_ch,
          to: target_line2.from + matched_results[0].to_ch,
          insert: matched_results[0].new_link
        }
      });
    }
  } else if (matched_results.length == 0) {
    new import_obsidian7.Notice(`Fail to find current image-link in ${mode}, please zoom manually!`);
  } else {
    new import_obsidian7.Notice(`Find multiple same image-link in ${mode}, please zoom manually!`);
  }
  return;
}
function updateExternalLink(activeView, target, target_pos, newWidth, newHeight, inTable, inCallout) {
  const editor = activeView.editor;
  const editorView = editor.cm;
  let target_line = editorView.state.doc.lineAt(target_pos);
  const link = target.getAttribute("src");
  const altText = target.getAttribute("alt");
  if (!inCallout && !inTable) {
    let matched = matchLineWithExternalLink(target_line.text, link, altText, newWidth, inTable);
    if (matched.length == 1) {
      editorView.dispatch({
        changes: {
          from: target_line.from + matched[0].from_ch,
          to: target_line.from + matched[0].to_ch,
          insert: matched[0].new_link
        }
      });
    } else if (matched.length == 0) {
    } else {
      new import_obsidian7.Notice("Find multiple same image-link in line, please zoom manually!");
    }
    return;
  }
  let startReg = {
    "table": /^\s*\|/,
    "callout": /^>/
  };
  let mode = inTable ? "table" : "callout";
  print("mode", mode);
  const start_reg = startReg[mode];
  let start_line_number = target_line.number;
  let matched_results = [];
  let matched_lines = [];
  for (let i = start_line_number; i <= editor.lineCount(); i++) {
    let line = editorView.state.doc.line(i);
    if (!start_reg.test(line.text))
      break;
    let matched = matchLineWithExternalLink(line.text, link, altText, newWidth, inTable);
    matched_results.push(...matched);
    matched_lines.push(...new Array(matched.length).fill(i));
  }
  for (let i = start_line_number - 1; i >= 1; i--) {
    let line = editorView.state.doc.line(i);
    if (!start_reg.test(line.text))
      break;
    let matched = matchLineWithExternalLink(line.text, link, altText, newWidth, inTable);
    matched_results.push(...matched);
    matched_lines.push(...new Array(matched.length).fill(i));
  }
  print(matched_results);
  print(matched_lines);
  if (matched_results.length == 1) {
    let target_line2 = editorView.state.doc.line(matched_lines[0]);
    if (mode == "table") {
      let old_text = target_line2.text;
      let new_line_text = old_text.substring(0, matched_results[0].from_ch) + matched_results[0].new_link + old_text.substring(matched_results[0].to_ch);
      editorView.dispatch({
        changes: {
          from: target_line2.from,
          to: target_line2.from + old_text.length,
          insert: new_line_text
        }
      });
    } else {
      editorView.dispatch({
        changes: {
          from: target_line2.from + matched_results[0].from_ch,
          to: target_line2.from + matched_results[0].to_ch,
          insert: matched_results[0].new_link
        }
      });
    }
  } else if (matched_results.length == 0) {
    new import_obsidian7.Notice(`Fail to find current image-link in ${mode}, please zoom manually!`);
  } else {
    new import_obsidian7.Notice(`Find multiple same image-link in ${mode}, please zoom manually!`);
  }
  return;
}
function matchLineWithInternalLink(line_text, target_name, new_width, intable) {
  let regWikiLink = /\!\[\[[^\[\]]*?\]\]/g;
  let regMdLink = /\!\[[^\[\]]*?\]\([^\s\)\(\[\]\{\}']*\)/g;
  const target_name_mdlink = target_name.replace(/ /g, "%20");
  if (!line_text.includes(target_name) && !line_text.includes(target_name_mdlink))
    return [];
  let result = [];
  while (true) {
    let wiki_match = regWikiLink.exec(line_text);
    if (!wiki_match)
      break;
    const matched_link = wiki_match[0];
    if (matched_link.includes(target_name)) {
      let normal_link = intable ? matched_link.replace(/\\\|/g, "|") : matched_link;
      console.log(normal_link);
      let link_match = normal_link.match(/!\[\[(.*?)(\||\]\])/);
      let link_text = link_match ? link_match[1] : "";
      let alt_match = matched_link.match(/!\[\[.*?(\|(.*?))\]\]/);
      let alt_text = alt_match ? alt_match[1] : "";
      let alt_text_list = alt_text.split("|");
      let alt_text_wo_size = "";
      let new_alt_text = "";
      for (let alt of alt_text_list) {
        if (!/^\d+$/.test(alt) && !/^\s*$/.test(alt)) {
          alt_text_wo_size = alt_text_wo_size + "|" + alt;
        }
      }
      new_alt_text = new_width != 0 ? `${alt_text_wo_size}|${new_width}` : alt_text_wo_size;
      new_alt_text = intable ? new_alt_text.replace(/\|/g, "\\|") : new_alt_text;
      let newWikiLink = link_match ? `![[${link_text}${new_alt_text}]]` : `![[${target_name}${new_alt_text}]]`;
      result.push({
        old_link: matched_link,
        new_link: newWikiLink,
        from_ch: wiki_match.index,
        to_ch: wiki_match.index + matched_link.length
      });
    }
  }
  while (true) {
    let match = regMdLink.exec(line_text);
    if (!match)
      break;
    const matched_link = match[0];
    if (matched_link.includes(target_name_mdlink)) {
      let alt_text_match = matched_link.match(/\[.*?\]/g);
      let alt_text = alt_text_match[0].substring(1, alt_text_match[0].length - 1);
      let pure_alt = alt_text.replace(/\|\d+(\|\d+)?$/g, "");
      if (intable) {
        pure_alt = alt_text.replace(/\\\|\d+(\|\d+)?$/g, "");
      }
      let link_text = matched_link.substring(alt_text_match[0].length + 2, matched_link.length - 1);
      let newMDLink = intable ? `![${pure_alt}\\|${new_width}](${link_text})` : `![${pure_alt}|${new_width}](${link_text})`;
      if (/^\d*$/.test(alt_text)) {
        newMDLink = `![${new_width}](${link_text})`;
      }
      result.push({
        old_link: matched_link,
        new_link: newMDLink,
        from_ch: match.index,
        to_ch: match.index + matched_link.length
      });
    }
  }
  print("Line Text: ", line_text);
  print("MatchedInfo:", result);
  return result;
}
function matchLineWithExternalLink(line_text, link, alt_text, new_width, intable) {
  let result = [];
  let regMdLink = /\!\[[^\[\]]*?\]\([^\s\)\(\[\]\{\}']*\)/g;
  if (!line_text.includes(link) || !line_text.includes(alt_text))
    return [];
  let newExternalLink = intable ? `![${alt_text}\\|${new_width}](${link})` : `![${alt_text}|${new_width}](${link})`;
  if (/^\d*$/.test(alt_text) || /^\s*$/.test(alt_text)) {
    newExternalLink = `![${new_width}](${link})`;
  }
  while (true) {
    let match = regMdLink.exec(line_text);
    if (!match)
      break;
    let matched_link = match[0];
    if (matched_link.includes(link) && matched_link.includes(alt_text)) {
      result.push({
        old_link: matched_link,
        new_link: newExternalLink,
        from_ch: match.index,
        to_ch: match.index + matched_link.length
      });
    }
  }
  print("Line Text: ", line_text);
  print("MatchedInfo:", result);
  return result;
}
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL21haW4udHMiLCAic3JjL29wdGlvbnMvZGVsZWxlQWxsQXR0YWNoc0luVGhlTm90ZS50cyIsICJzcmMvdXRpbC50cyIsICJzcmMvdXRpbHMvZGVsZXRlRmlsZS50cyIsICJzcmMvY29uZmlnL2FkZENvbW1hbmQtY29uZmlnLnRzIiwgInNyYy9zZXR0aW5ncy50cyIsICJzcmMvdXRpbHMvaGFuZGxlckV2ZW50LnRzIiwgInNyYy9tb2RhbHMvZGVsZXRpb25Qcm9tcHQudHMiLCAic3JjL2hlbHBlcnMudHMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbImltcG9ydCB7IE1lbnUsIE1lbnVJdGVtLCBOb3RpY2UsIFBsdWdpbiwgVEZpbGUsIE1hcmtkb3duVmlldywgUGxhdGZvcm0gfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IGFkZENvbW1hbmQgfSBmcm9tIFwiLi9jb25maWcvYWRkQ29tbWFuZC1jb25maWdcIjtcbmltcG9ydCB7IEF0dGFjaEZsb3dTZXR0aW5nc1RhYiB9IGZyb20gXCIuL3NldHRpbmdzXCI7XG5pbXBvcnQgeyBBdHRhY2hGbG93U2V0dGluZ3MsIERFRkFVTFRfU0VUVElOR1MgfSBmcm9tIFwiLi9zZXR0aW5nc1wiO1xuaW1wb3J0ICogYXMgVXRpbCBmcm9tIFwiLi91dGlsXCI7XG5pbXBvcnQgeyBwcmludCwgc2V0RGVidWcgfSBmcm9tICcuL3V0aWwnXG5pbXBvcnQgeyBnZXRNb3VzZUV2ZW50VGFyZ2V0IH0gZnJvbSBcIi4vdXRpbHMvaGFuZGxlckV2ZW50XCI7XG5pbXBvcnQgeyBEZWxldGVBbGxMb2dzTW9kYWwgfSBmcm9tIFwiLi9tb2RhbHMvZGVsZXRpb25Qcm9tcHRcIjtcbmltcG9ydCB7IEVkaXRvclZpZXcsIGtleW1hcCwgVmlld1VwZGF0ZSB9IGZyb20gJ0Bjb2RlbWlycm9yL3ZpZXcnO1xuaW1wb3J0IHtcblx0RWxlY3Ryb25XaW5kb3csIEZpbGVTeXN0ZW1BZGFwdGVyV2l0aEludGVybmFsQXBpLFxuXHRsb2FkSW1hZ2VCbG9iLCBBcHBXaXRoRGVza3RvcEludGVybmFsQXBpLCBFZGl0b3JJbnRlcm5hbEFwaSwgb25FbGVtZW50XG59IGZyb20gXCIuL2hlbHBlcnNcIlxuXG5pbnRlcmZhY2UgTWF0Y2hlZExpbmtJbkxpbmV7XG5cdG9sZF9saW5rOnN0cmluZywgXG5cdG5ld19saW5rOiBzdHJpbmcsIFxuXHRmcm9tX2NoOiBudW1iZXIsIFxuXHR0b19jaDogbnVtYmVyXG59XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEF0dGFjaEZsb3dQbHVnaW4gZXh0ZW5kcyBQbHVnaW4ge1xuXHRzZXR0aW5nczogQXR0YWNoRmxvd1NldHRpbmdzO1xuXG5cdGFzeW5jIG9ubG9hZCgpIHtcblx0XHRjb25zb2xlLmxvZyhcIkF0dGFjaEZsb3cgcGx1Z2luIGxvYWRlZC4uLlwiKTtcblxuXHRcdHRoaXMuYWRkU2V0dGluZ1RhYihuZXcgQXR0YWNoRmxvd1NldHRpbmdzVGFiKHRoaXMuYXBwLCB0aGlzKSk7XG5cblx0XHRhd2FpdCB0aGlzLmxvYWRTZXR0aW5ncygpO1xuXHRcdHRoaXMucmVnaXN0ZXJEb2N1bWVudChkb2N1bWVudCk7XG5cdFx0YXBwLndvcmtzcGFjZS5vbihcIndpbmRvdy1vcGVuXCIsICh3b3Jrc3BhY2VXaW5kb3csIHdpbmRvdykgPT4ge1xuXHRcdFx0dGhpcy5yZWdpc3RlckRvY3VtZW50KHdpbmRvdy5kb2N1bWVudCk7XG5cdFx0fSk7XG5cdFx0Ly8gYWRkIGNvbnRleHRtZW51IG9uIGZpbGUgY29udGV4dFxuXHRcdHRoaXMucmVnaXN0ZXJFdmVudChcblx0XHRcdHRoaXMuYXBwLndvcmtzcGFjZS5vbihcImZpbGUtbWVudVwiLCAobWVudSwgZmlsZSkgPT4ge1xuXHRcdFx0XHRpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSB7XG5cdFx0XHRcdFx0aWYgKCFmaWxlLnBhdGguZW5kc1dpdGgoXCIubWRcIikpIHJldHVybjtcblx0XHRcdFx0XHRjb25zdCBhZGRNZW51SXRlbSA9IChpdGVtOiBNZW51SXRlbSkgPT4ge1xuXHRcdFx0XHRcdFx0aXRlbS5zZXRUaXRsZShcIkRlbGV0ZSBmaWxlIGFuZCBpdHMgYXR0YWNobWVudHNcIilcblx0XHRcdFx0XHRcdFx0LnNldEljb24oXCJ0cmFzaC0yXCIpXG5cdFx0XHRcdFx0XHRcdC5zZXRTZWN0aW9uKFwiZGFuZ2VyXCIpO1xuXHRcdFx0XHRcdFx0aXRlbS5vbkNsaWNrKGFzeW5jICgpID0+IHtcblx0XHRcdFx0XHRcdFx0Y29uc3QgbW9kYWwgPSBuZXcgRGVsZXRlQWxsTG9nc01vZGFsKGZpbGUsIHRoaXMpO1xuXHRcdFx0XHRcdFx0XHRtb2RhbC5vcGVuKCk7XG5cdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHR9O1xuXHRcdFx0XHRcdG1lbnUuYWRkSXRlbShhZGRNZW51SXRlbSk7XG5cdFx0XHRcdH1cblx0XHRcdH0pXG5cdFx0KTtcblx0XHQvLyByZWdpc3RlciBhbGwgY29tbWFuZHMgaW4gYWRkQ29tbWFuZCBmdW5jdGlvblxuXHRcdGFkZENvbW1hbmQodGhpcyk7XG5cblx0XHRzZXREZWJ1Zyh0aGlzLnNldHRpbmdzLmRlYnVnKTtcblx0fVxuXG5cdG9udW5sb2FkKCkge1xuXHRcdGNvbnNvbGUubG9nKFwiQXR0YWNoRmxvdyBwbHVnaW4gdW5sb2FkZWQuLi5cIik7XG5cdH1cblxuXHRyZWdpc3RlckRvY3VtZW50KGRvY3VtZW50OiBEb2N1bWVudCkge1xuXHRcdHRoaXMucmVnaXN0ZXIoXG5cdFx0XHRvbkVsZW1lbnQoXG5cdFx0XHRcdGRvY3VtZW50LFxuXHRcdFx0XHRcImNvbnRleHRtZW51XCIgYXMga2V5b2YgSFRNTEVsZW1lbnRFdmVudE1hcCxcblx0XHRcdFx0XCJpbWcsIGlmcmFtZSwgdmlkZW8sIGRpdi5maWxlLWVtYmVkLXRpdGxlLCBhdWRpb1wiLFxuXHRcdFx0XHR0aGlzLm9uQ2xpY2suYmluZCh0aGlzKVxuXHRcdFx0KVxuXHRcdCk7XG5cdFx0XG5cdFx0Ly8gXHU0RUU1XHU0RTBCXHU0RTA5XHU0RTJBXHU0RThCXHU0RUY2XHU2NjJGXHU0RTNBXHU0RTg2XHU1QjlFXHU3M0IwXHU2MkQ2XHU2MkZEXHU2NTM5XHU1M0Q4XHU1NkZFXHU3MjQ3XHU1OTI3XHU1QzBGXHU3Njg0XHU1MjlGXHU4MEZEXHVGRjBDXHU0RkVFXHU2NTM5XHU4MUVBIGh0dHBzOi8vZ2l0aHViLmNvbS94Unl1bC9vYnNpZGlhbi1pbWFnZS1jb252ZXJ0ZXJcblx0XHQvLyBcdTk2NDRcdTRFMEFcdTUxNzYgTUlUIExpY2Vuc2Vcblx0XHQvLyBNSVQgTGljZW5zZVxuXHRcdC8vIENvcHlyaWdodCAoYykgMjAyMyB4Unl1bFxuXHRcdC8vIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcblx0XHQvLyBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsXG5cdFx0Ly8gaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xuXHRcdC8vIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcblx0XHQvLyBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXNcblx0XHQvLyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOlxuXG5cdFx0Ly8gVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW4gYWxsXG5cdFx0Ly8gY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cblxuXHRcdC8vIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1Jcblx0XHQvLyBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcblx0XHQvLyBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEVcblx0XHQvLyBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSXG5cdFx0Ly8gTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcblx0XHQvLyBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOIFRIRVxuXHRcdC8vIFNPRlRXQVJFLlxuXG5cdFx0dGhpcy5yZWdpc3Rlcihcblx0XHRcdG9uRWxlbWVudChcblx0XHRcdFx0ZG9jdW1lbnQsXG5cdFx0XHRcdFwibW91c2Vkb3duXCIsXG5cdFx0XHRcdFwiaW1nLCB2aWRlb1wiLFxuXHRcdFx0XHQoZXZlbnQ6IE1vdXNlRXZlbnQpID0+IHtcblx0XHRcdFx0XHRpZighdGhpcy5zZXR0aW5ncy5kcmFnUmVzaXplKSByZXR1cm47XG5cdFx0XHRcdFx0Y29uc3QgY3VycmVudE1kID0gYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCkgYXMgVEZpbGU7XG5cdFx0XHRcdFx0aWYgKGN1cnJlbnRNZC5uYW1lLmVuZHNXaXRoKCcuY2FudmFzJykpIHJldHVybjtcblx0XHRcdFx0XHRjb25zdCBpblByZXZpZXc6IGJvb2xlYW4gPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpPy5nZXRNb2RlKCkgPT0gXCJwcmV2aWV3XCI7XG5cdFx0XHRcdFx0aWYgKGluUHJldmlldykgcmV0dXJuO1xuXG5cdFx0XHRcdFx0aWYgKGV2ZW50LmJ1dHRvbiA9PT0gMCkge1xuXHRcdFx0XHRcdFx0ZXZlbnQucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0Y29uc3QgaW1nID0gZXZlbnQudGFyZ2V0IGFzIEhUTUxJbWFnZUVsZW1lbnQgfCBIVE1MVmlkZW9FbGVtZW50O1xuXHRcdFx0XHRcdGNvbnN0IGVkaXRvciA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk/LmVkaXRvcjtcblx0XHRcdFx0XHQvLyAgQHRzLWV4cGVjdC1lcnJvciwgbm90IHR5cGVkXG5cdFx0XHRcdFx0Y29uc3QgZWRpdG9yVmlldyA9IGVkaXRvci5jbSBhcyBFZGl0b3JWaWV3O1xuXHRcdFx0XHRcdGNvbnN0IHRhcmdldF9wb3MgPSBlZGl0b3JWaWV3LnBvc0F0RE9NKGltZyk7XG5cdFx0XHRcdFx0bGV0IHRhcmdldF9saW5lID0gZWRpdG9yVmlldy5zdGF0ZS5kb2MubGluZUF0KHRhcmdldF9wb3MpO1xuXG5cdFx0XHRcdFx0Y29uc3QgaW5UYWJsZTogYm9vbGVhbiA9IGltZy5jbG9zZXN0KCd0YWJsZScpICE9IG51bGw7XG5cdFx0XHRcdFx0Y29uc3QgaW5DYWxsb3V0OiBib29sZWFuID0gaW1nLmNsb3Nlc3QoJy5jYWxsb3V0JykgIT0gbnVsbDtcblx0XHRcdFx0XHRjb25zdCBpc0V4Y2FsaWRyYXcgPSBpbWcuY2xhc3NMaXN0LmNvbnRhaW5zKCdleGNhbGlkcmF3LWVtYmVkZGVkLWltZycpO1xuXHRcdFx0XHRcdHByaW50KCdJblRhYmxlJywgaW5UYWJsZSlcblx0XHRcdFx0XHRwcmludCgnVGFyZ2V0IEVsZW1lbnQnLCBpbWcpXG5cdFx0XHRcdFx0aWYgKGlzRXhjYWxpZHJhdyl7XG5cdFx0XHRcdFx0XHRwcmludCgnRXhjYWxpZHJhdyBmaWxlIScpO1xuXHRcdFx0XHRcdFx0Ly8gcmV0dXJuO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHQvLyBwcmludChcImltZy5wYXJlbnRcIiwgaW1nLnBhcmVudEVsZW1lbnQ/aW1nLnBhcmVudEVsZW1lbnQ6J05VTEwnKVxuXG5cdFx0XHRcdFx0Y29uc3QgcmVjdCA9IGltZy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblx0XHRcdFx0XHRjb25zdCB4ID0gZXZlbnQuY2xpZW50WCAtIHJlY3QubGVmdDtcblx0XHRcdFx0XHRjb25zdCB5ID0gZXZlbnQuY2xpZW50WSAtIHJlY3QudG9wO1xuXHRcdFx0XHRcdGNvbnN0IGVkZ2VTaXplID0gMzA7IC8vIHNpemUgb2YgdGhlIGVkZ2UgaW4gcGl4ZWxzXG5cdFx0XHRcdFx0aWYgKHggPCBlZGdlU2l6ZSB8fCB5IDwgZWRnZVNpemUgfHwgeCA+IHJlY3Qud2lkdGggLSBlZGdlU2l6ZSB8fCB5ID4gcmVjdC5oZWlnaHQgLSBlZGdlU2l6ZSkge1xuXHRcdFx0XHRcdFx0Y29uc3Qgc3RhcnRYID0gZXZlbnQuY2xpZW50WDtcblx0XHRcdFx0XHRcdGNvbnN0IHN0YXJ0WSA9IGV2ZW50LmNsaWVudFk7XG5cdFx0XHRcdFx0XHRjb25zdCBzdGFydFdpZHRoID0gaW1nLmNsaWVudFdpZHRoO1xuXHRcdFx0XHRcdFx0Y29uc3Qgc3RhcnRIZWlnaHQgPSBpbWcuY2xpZW50SGVpZ2h0O1xuXHRcdFx0XHRcdFx0bGV0IGxhc3RVcGRhdGVYID0gc3RhcnRYO1xuXHRcdFx0XHRcdFx0bGV0IGxhc3RVcGRhdGVZID0gc3RhcnRZO1xuXHRcdFx0XHRcdFx0Y29uc3QgdXBkYXRlVGhyZXNob2xkID0gNTsgLy8gVGhlIG1vdXNlIG11c3QgbW92ZSBhdCBsZWFzdCA1IHBpeGVscyBiZWZvcmUgYW4gdXBkYXRlXG5cdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdGNvbnN0IG9uTW91c2VNb3ZlID0gKGV2ZW50OiBNb3VzZUV2ZW50KSA9PiB7XG5cdFx0XHRcdFx0XHRcdGNvbnN0IGN1cnJlbnRYID0gZXZlbnQuY2xpZW50WDtcblx0XHRcdFx0XHRcdFx0bGV0IG5ld1dpZHRoID0gc3RhcnRXaWR0aCArIChjdXJyZW50WCAtIHN0YXJ0WCk7XG5cdFx0XHRcdFx0XHRcdGNvbnN0IGFzcGVjdFJhdGlvID0gc3RhcnRXaWR0aCAvIHN0YXJ0SGVpZ2h0O1xuXG5cdFx0XHRcdFx0XHRcdC8vIEVuc3VyZSB0aGUgaW1hZ2UgZG9lc24ndCBnZXQgdG9vIHNtYWxsXG5cdFx0XHRcdFx0XHRcdG5ld1dpZHRoID0gTWF0aC5tYXgobmV3V2lkdGgsIDUwKTtcblxuXHRcdFx0XHRcdFx0XHRsZXQgbmV3SGVpZ2h0ID0gbmV3V2lkdGggLyBhc3BlY3RSYXRpbztcblx0XHRcdFx0XHRcdFx0Ly8gUm91bmQgdGhlIHZhbHVlcyB0byB0aGUgbmVhcmVzdCB3aG9sZSBudW1iZXJcblx0XHRcdFx0XHRcdFx0bmV3V2lkdGggPSBNYXRoLnJvdW5kKG5ld1dpZHRoKTtcblx0XHRcdFx0XHRcdFx0bmV3SGVpZ2h0ID0gTWF0aC5yb3VuZChuZXdIZWlnaHQpO1xuXG5cdFx0XHRcdFx0XHRcdC8vIEFwcGx5IHRoZSBuZXcgZGltZW5zaW9ucyB0byB0aGUgaW1hZ2Ugb3IgdmlkZW9cblx0XHRcdFx0XHRcdFx0aWYgKGltZyBpbnN0YW5jZW9mIEhUTUxJbWFnZUVsZW1lbnQpIHtcblx0XHRcdFx0XHRcdFx0XHRpbWcuc3R5bGUuYm9yZGVyID0gJ3NvbGlkJztcblx0XHRcdFx0XHRcdFx0XHRpbWcuc3R5bGUuYm9yZGVyV2lkdGggPSAnMnB4Jztcblx0XHRcdFx0XHRcdFx0XHRpbWcuc3R5bGUuYm9yZGVyQ29sb3IgPSAnYmx1ZSc7XG5cdFx0XHRcdFx0XHRcdFx0aW1nLnN0eWxlLmJveFNpemluZyA9ICdib3JkZXItYm94Jztcblx0XHRcdFx0XHRcdFx0XHRpbWcuc3R5bGUud2lkdGggPSBgJHtuZXdXaWR0aH1weGA7XG5cdFx0XHRcdFx0XHRcdFx0Ly8gaW1nLnN0eWxlLmhlaWdodCA9IGAke25ld0hlaWdodH1weGA7XG5cdFx0XHRcdFx0XHRcdH0gZWxzZSBpZiAoaW1nIGluc3RhbmNlb2YgSFRNTFZpZGVvRWxlbWVudCkge1xuXHRcdFx0XHRcdFx0XHRcdGltZy5zdHlsZS5ib3JkZXIgPSAnc29saWQnO1xuXHRcdFx0XHRcdFx0XHRcdGltZy5zdHlsZS5ib3JkZXJXaWR0aCA9ICcycHgnO1xuXHRcdFx0XHRcdFx0XHRcdGltZy5zdHlsZS5ib3JkZXJDb2xvciA9ICdibHVlJztcblx0XHRcdFx0XHRcdFx0XHRpbWcuc3R5bGUuYm94U2l6aW5nID0gJ2JvcmRlci1ib3gnO1xuXHRcdFx0XHRcdFx0XHRcdC8vIENoZWNrIGlmIGltZy5wYXJlbnRFbGVtZW50IGlzIG5vdCBudWxsIGJlZm9yZSB0cnlpbmcgdG8gYWNjZXNzIGl0cyBjbGllbnRXaWR0aCBwcm9wZXJ0eVxuXHRcdFx0XHRcdFx0XHRcdGlmIChpbWcucGFyZW50RWxlbWVudCl7XG5cdFx0XHRcdFx0XHRcdFx0XHRjb25zdCBjb250YWluZXJXaWR0aCA9IGltZy5wYXJlbnRFbGVtZW50LmNsaWVudFdpZHRoO1xuXHRcdFx0XHRcdFx0XHRcdFx0Y29uc3QgbmV3V2lkdGhQZXJjZW50YWdlID0gKG5ld1dpZHRoIC8gY29udGFpbmVyV2lkdGgpICogMTAwO1xuXHRcdFx0XHRcdFx0XHRcdFx0aW1nLnN0eWxlLndpZHRoID0gYCR7bmV3V2lkdGhQZXJjZW50YWdlfSVgO1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRcdC8vIENoZWNrIGlmIHRoZSBtb3VzZSBoYXMgbW92ZWQgbW9yZSB0aGFuIHRoZSB1cGRhdGUgdGhyZXNob2xkXG5cdFx0XHRcdFx0XHRcdGlmIChNYXRoLmFicyhldmVudC5jbGllbnRYIC0gbGFzdFVwZGF0ZVgpID4gdXBkYXRlVGhyZXNob2xkKSB7XG5cdFx0XHRcdFx0XHRcdFx0Y29uc3QgYWN0aXZlVmlldyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk7XG5cdFx0XHRcdFx0XHRcdFx0aWYgKGFjdGl2ZVZpZXcpIHtcblx0XHRcdFx0XHRcdFx0XHRcdHByaW50KFwidXBkYXRlIG5ldyBXaWR0aFwiLCBuZXdXaWR0aCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRsZXQgaW1hZ2VOYW1lID0gaW1nLmdldEF0dHJpYnV0ZSgnc3JjJyk7XG5cdFx0XHRcdFx0XHRcdFx0XHRpZiAoaW1hZ2VOYW1lPy5zdGFydHNXaXRoKCdodHRwJykpe1xuXHRcdFx0XHRcdFx0XHRcdFx0XHR1cGRhdGVFeHRlcm5hbExpbmsoYWN0aXZlVmlldywgaW1nLCB0YXJnZXRfcG9zLCBuZXdXaWR0aCwgbmV3SGVpZ2h0LCBpblRhYmxlLCBpbkNhbGxvdXQpO1xuXHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0ZWxzZSBpZihpc0V4Y2FsaWRyYXcpe1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRsZXQgdGFyZ2V0X25hbWUgPSBpbWcuZ2V0QXR0cmlidXRlKCdmaWxlc291cmNlJykgYXMgc3RyaW5nO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRsZXQgZHJhd19iYXNlX25hbWUgPSB0YXJnZXRfbmFtZVxuXHRcdFx0XHRcdFx0XHRcdFx0XHRpZihkcmF3X2Jhc2VfbmFtZS5pbmNsdWRlcygnLycpKXtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRsZXQgdGVtcF9hcnIgPSBkcmF3X2Jhc2VfbmFtZS5zcGxpdCgnLycpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGRyYXdfYmFzZV9uYW1lID0gdGVtcF9hcnJbdGVtcF9hcnIubGVuZ3RoLTFdXG5cdFx0XHRcdFx0XHRcdFx0XHRcdH1lbHNlIGlmKGRyYXdfYmFzZV9uYW1lLmluY2x1ZGVzKCdcXFxcJykpe1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGxldCB0ZW1wX2FyciA9IGRyYXdfYmFzZV9uYW1lLnNwbGl0KCdcXFxcJyk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0ZHJhd19iYXNlX25hbWUgPSB0ZW1wX2Fyclt0ZW1wX2Fyci5sZW5ndGgtMV1cblx0XHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0XHRkcmF3X2Jhc2VfbmFtZSA9IGRyYXdfYmFzZV9uYW1lLmVuZHNXaXRoKCcubWQnKSA/XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0ZHJhd19iYXNlX25hbWUuc3Vic3RyaW5nKDAsIGRyYXdfYmFzZV9uYW1lLmxlbmd0aC0zKSA6XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0ZHJhd19iYXNlX25hbWU7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdHByaW50KHRhcmdldF9uYW1lKVxuXHRcdFx0XHRcdFx0XHRcdFx0XHRwcmludCgnZXhjYWxpZHJhdyBmaWxlOicsIGRyYXdfYmFzZV9uYW1lKVxuXHRcdFx0XHRcdFx0XHRcdFx0XHRpbWcuc3R5bGUubWF4V2lkdGggPSAnbm9uZSc7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdHVwZGF0ZUludGVybmFsTGluayhhY3RpdmVWaWV3LCBpbWcsIHRhcmdldF9wb3MsIGRyYXdfYmFzZV9uYW1lLCBuZXdXaWR0aCwgbmV3SGVpZ2h0LCBpblRhYmxlLCBpbkNhbGxvdXQpO1xuXHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0ZWxzZXtcblx0XHRcdFx0XHRcdFx0XHRcdFx0aW1hZ2VOYW1lID0gaW1nLnBhcmVudEVsZW1lbnQ/LmdldEF0dHJpYnV0ZSgnc3JjJykgYXMgc3RyaW5nO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHR1cGRhdGVJbnRlcm5hbExpbmsoYWN0aXZlVmlldywgaW1nLCB0YXJnZXRfcG9zLCBpbWFnZU5hbWUsIG5ld1dpZHRoLCBuZXdIZWlnaHQsIGluVGFibGUsIGluQ2FsbG91dCk7XG5cdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRcdFx0Ly8gVXBkYXRlIHRoZSBsYXN0IHVwZGF0ZSBjb29yZGluYXRlc1xuXHRcdFx0XHRcdFx0XHRcdGxhc3RVcGRhdGVYID0gZXZlbnQuY2xpZW50WDtcblx0XHRcdFx0XHRcdFx0XHRsYXN0VXBkYXRlWSA9IGV2ZW50LmNsaWVudFk7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0Y29uc3Qgb25Nb3VzZVVwID0gKGV2ZW50OiBNb3VzZUV2ZW50KSA9PiB7XG5cdFx0XHRcdFx0XHRcdGV2ZW50LnByZXZlbnREZWZhdWx0KClcblx0XHRcdFx0XHRcdFx0aW1nLnN0eWxlLmJvcmRlclN0eWxlID0gJ25vbmUnXG5cdFx0XHRcdFx0XHRcdGltZy5zdHlsZS5vdXRsaW5lID0gJ25vbmUnO1xuXHRcdFx0XHRcdFx0XHRpbWcuc3R5bGUuY3Vyc29yID0gJ2RlZmF1bHQnO1xuXHRcdFx0XHRcdFx0XHRkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwibW91c2Vtb3ZlXCIsIG9uTW91c2VNb3ZlKTtcblx0XHRcdFx0XHRcdFx0ZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1vdXNldXBcIiwgb25Nb3VzZVVwKTtcblx0XHRcdFx0XHRcdH07XG5cdFx0XHRcdFx0XHRkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vtb3ZlXCIsIG9uTW91c2VNb3ZlKTtcblx0XHRcdFx0XHRcdGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZXVwXCIsIG9uTW91c2VVcCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHQpXG5cdFx0KVxuXHRcdHRoaXMucmVnaXN0ZXIoXG5cdFx0XHRvbkVsZW1lbnQoXG5cdFx0XHRcdGRvY3VtZW50LFxuXHRcdFx0XHRcIm1vdXNlb3ZlclwiLFxuXHRcdFx0XHRcImltZywgdmlkZW9cIixcblx0XHRcdFx0KGV2ZW50OiBNb3VzZUV2ZW50KSA9PiB7XG5cdFx0XHRcdFx0aWYoIXRoaXMuc2V0dGluZ3MuZHJhZ1Jlc2l6ZSkgcmV0dXJuO1xuXHRcdFx0XHRcdGNvbnN0IGN1cnJlbnRNZCA9IGFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpIGFzIFRGaWxlO1xuXHRcdFx0XHRcdGlmIChjdXJyZW50TWQubmFtZS5lbmRzV2l0aCgnLmNhbnZhcycpKSByZXR1cm47XG5cdFx0XHRcdFx0Y29uc3QgaW5QcmV2aWV3OiBib29sZWFuID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KT8uZ2V0TW9kZSgpID09IFwicHJldmlld1wiO1xuXHRcdFx0XHRcdGlmIChpblByZXZpZXcpIHJldHVybjtcblxuXHRcdFx0XHRcdGNvbnN0IGltZyA9IGV2ZW50LnRhcmdldCBhcyBIVE1MSW1hZ2VFbGVtZW50IHwgSFRNTFZpZGVvRWxlbWVudDtcblx0XHRcdFx0XHRjb25zdCByZWN0ID0gaW1nLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOyAvLyBDYWNoZSB0aGlzXG5cdFx0XHRcdFx0Y29uc3QgZWRnZVNpemUgPSAzMDsgLy8gc2l6ZSBvZiB0aGUgZWRnZSBpbiBwaXhlbHNcblxuXHRcdFx0XHRcdGNvbnN0IGlzRXhjYWxpZHJhdyA9IGltZy5jbGFzc0xpc3QuY29udGFpbnMoJ2V4Y2FsaWRyYXctZW1iZWRkZWQtaW1nJyk7XG5cdFx0XHRcdFx0Ly8gaWYgKGlzRXhjYWxpZHJhdykgcmV0dXJuO1xuXG5cdFx0XHRcdFx0Ly8gVGhyb3R0bGUgbW91c2Vtb3ZlIGV2ZW50c1xuXHRcdFx0XHRcdGxldCBsYXN0TW92ZSA9IDA7XG5cdFx0XHRcdFx0Y29uc3QgbW91c2VPdmVySGFuZGxlciA9IChldmVudDogTW91c2VFdmVudCkgPT4ge1xuXHRcdFx0XHRcdFx0aWYoIXRoaXMuc2V0dGluZ3MuZHJhZ1Jlc2l6ZSkgcmV0dXJuO1xuXHRcdFx0XHRcdFx0Y29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcblx0XHRcdFx0XHRcdGlmIChub3cgLSBsYXN0TW92ZSA8IDEwMCkgcmV0dXJuOyAvLyBPbmx5IGV4ZWN1dGUgb25jZSBldmVyeSAxMDBtc1xuXHRcdFx0XHRcdFx0bGFzdE1vdmUgPSBub3c7XG5cblx0XHRcdFx0XHRcdGNvbnN0IHggPSBldmVudC5jbGllbnRYIC0gcmVjdC5sZWZ0O1xuXHRcdFx0XHRcdFx0Y29uc3QgeSA9IGV2ZW50LmNsaWVudFkgLSByZWN0LnRvcDtcblxuXHRcdFx0XHRcdFx0aWYgKCh4ID49IHJlY3Qud2lkdGggLSBlZGdlU2l6ZSB8fCB4IDw9IGVkZ2VTaXplKSB8fCAoeSA+PSByZWN0LmhlaWdodCAtIGVkZ2VTaXplIHx8IHkgPD0gZWRnZVNpemUpKSB7XG5cdFx0XHRcdFx0XHRcdGltZy5zdHlsZS5jdXJzb3IgPSAnbndzZS1yZXNpemUnO1xuXHRcdFx0XHRcdFx0XHRpbWcuc3R5bGUub3V0bGluZSA9ICdzb2xpZCc7XG5cdFx0XHRcdFx0XHRcdGltZy5zdHlsZS5vdXRsaW5lV2lkdGggPSAnNnB4Jztcblx0XHRcdFx0XHRcdFx0aW1nLnN0eWxlLm91dGxpbmVDb2xvciA9ICcjZGZiMGYyODMnO1xuXHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0aW1nLnN0eWxlLmN1cnNvciA9ICdkZWZhdWx0Jztcblx0XHRcdFx0XHRcdFx0aW1nLnN0eWxlLm91dGxpbmUgPSAnbm9uZSc7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fTtcblx0XHRcdFx0XHR0aGlzLnJlZ2lzdGVyRG9tRXZlbnQoaW1nLCAnbW91c2Vtb3ZlJywgbW91c2VPdmVySGFuZGxlcik7XG5cdFx0XHRcdH1cblx0XHRcdClcblx0XHQpO1xuXG5cdFx0dGhpcy5yZWdpc3Rlcihcblx0XHRcdG9uRWxlbWVudChcblx0XHRcdFx0ZG9jdW1lbnQsXG5cdFx0XHRcdFwibW91c2VvdXRcIixcblx0XHRcdFx0XCJpbWcsIHZpZGVvXCIsXG5cdFx0XHRcdChldmVudDogTW91c2VFdmVudCkgPT4ge1xuXHRcdFx0XHRcdGlmKCF0aGlzLnNldHRpbmdzLmRyYWdSZXNpemUpIHJldHVybjtcblx0XHRcdFx0XHRjb25zdCBjdXJyZW50TWQgPSBhcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKSBhcyBURmlsZTtcblx0XHRcdFx0XHRpZiAoY3VycmVudE1kLm5hbWUuZW5kc1dpdGgoJy5jYW52YXMnKSkgcmV0dXJuO1xuXHRcdFx0XHRcdGNvbnN0IGluUHJldmlldzogYm9vbGVhbiA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk/LmdldE1vZGUoKSA9PSBcInByZXZpZXdcIjtcblx0XHRcdFx0XHRpZiAoaW5QcmV2aWV3KSByZXR1cm47XG5cdFx0XHRcdFx0Y29uc3QgaW1nID0gZXZlbnQudGFyZ2V0IGFzIEhUTUxJbWFnZUVsZW1lbnQgfCBIVE1MVmlkZW9FbGVtZW50O1xuXHRcdFx0XHRcdGltZy5zdHlsZS5ib3JkZXJTdHlsZSA9ICdub25lJztcblx0XHRcdFx0XHRpbWcuc3R5bGUuY3Vyc29yID0gJ2RlZmF1bHQnO1xuXHRcdFx0XHRcdGltZy5zdHlsZS5vdXRsaW5lID0gJ25vbmUnO1xuXHRcdFx0XHR9XG5cdFx0XHQpXG5cdFx0KTtcblx0fVxuXG5cdGFzeW5jIGxvYWRTZXR0aW5ncygpIHtcblx0XHR0aGlzLnNldHRpbmdzID0gT2JqZWN0LmFzc2lnbihcblx0XHRcdHt9LFxuXHRcdFx0REVGQVVMVF9TRVRUSU5HUyxcblx0XHRcdGF3YWl0IHRoaXMubG9hZERhdGEoKVxuXHRcdCk7XG5cdH1cblxuXHRhc3luYyBzYXZlU2V0dGluZ3MoKSB7XG5cdFx0YXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLnNldHRpbmdzKTtcblx0fVxuXHRyZWdpc3RlckVzY2FwZUJ1dHRvbihtZW51OiBNZW51LCBkb2N1bWVudDogRG9jdW1lbnQgPSBhY3RpdmVEb2N1bWVudCkge1xuXHRcdG1lbnUucmVnaXN0ZXIoXG5cdFx0XHRvbkVsZW1lbnQoXG5cdFx0XHRcdGRvY3VtZW50LFxuXHRcdFx0XHRcImtleWRvd25cIiBhcyBrZXlvZiBIVE1MRWxlbWVudEV2ZW50TWFwLFxuXHRcdFx0XHRcIipcIixcblx0XHRcdFx0KGU6IEtleWJvYXJkRXZlbnQpID0+IHtcblx0XHRcdFx0XHRpZiAoZS5rZXkgPT09IFwiRXNjYXBlXCIpIHtcblx0XHRcdFx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0XHRcdFx0XHRtZW51LmhpZGUoKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdClcblx0XHQpO1xuXHR9XG5cblxuXHQvKipcblx0ICogXHU4QkJFXHU3RjZFXHU4M0RDXHU1MzU1XHU2MzA5XHU5NEFFXHVGRjBDXHU1RTc2XHU4QkJFXHU3RjZFXHU3MEI5XHU1MUZCXHU0RThCXHU0RUY2XG5cdCAqXG5cdCAqIEBwYXJhbSBtZW51XG5cdCAqIEBwYXJhbSBGaWxlQmFzZU5hbWVcblx0ICogQHBhcmFtIGN1cnJlbnRNZFxuXHQgKi9cblx0YWRkTWVudUV4dGVuZGVkU291cmNlTW9kZSA9IChtZW51OiBNZW51LCBGaWxlQmFzZU5hbWU6IHN0cmluZywgY3VycmVudE1kOiBURmlsZSwgdGFyZ2V0X3R5cGU6IHN0cmluZywgdGFyZ2V0X3BvczogbnVtYmVyLCBpblRhYmxlOiBib29sZWFuLCBpbkNhbGxvdXQ6IGJvb2xlYW4pID0+IHtcblx0XHRtZW51LmFkZEl0ZW0oKGl0ZW06IE1lbnVJdGVtKSA9PlxuXHRcdFx0aXRlbVxuXHRcdFx0XHQuc2V0SWNvbihcInRyYXNoLTJcIilcblx0XHRcdFx0LnNldFRpdGxlKFwiQ2xlYXIgZmlsZSBhbmQgYXNzb2NpYXRlZCBsaW5rXCIpXG5cdFx0XHRcdC8vIC5zZXRDaGVja2VkKHRydWUpXG5cdFx0XHRcdC5vbkNsaWNrKGFzeW5jICgpID0+IHtcblx0XHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdFx0Ly8gVXRpbC5oYW5kbGVyRGVsRmlsZShGaWxlQmFzZU5hbWUsIGN1cnJlbnRNZCwgdGhpcyk7XG5cdFx0XHRcdFx0XHRVdGlsLmhhbmRsZXJEZWxGaWxlTmV3KEZpbGVCYXNlTmFtZSwgY3VycmVudE1kLCB0aGlzLCB0YXJnZXRfdHlwZSwgdGFyZ2V0X3BvcywgaW5UYWJsZSwgaW5DYWxsb3V0KTtcblx0XHRcdFx0XHR9IGNhdGNoIHtcblx0XHRcdFx0XHRcdG5ldyBOb3RpY2UoXCJFcnJvciwgY291bGQgbm90IGNsZWFyIHRoZSBmaWxlIVwiKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pXG5cdFx0KTtcblx0XHRtZW51LmFkZEl0ZW0oKGl0ZW06IE1lbnVJdGVtKSA9PlxuXHRcdFx0aXRlbVxuXHRcdFx0XHQuc2V0SWNvbihcInBlbmNpbFwiKVxuXHRcdFx0XHQuc2V0VGl0bGUoXCJSZW5hbWVcIilcblx0XHRcdFx0Lm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuXHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHRwcmludChcInRlc3QgcmVuYW1lXCIpXG5cdFx0XHRcdFx0XHRVdGlsLmhhbmRsZXJSZW5hbWVGaWxlKEZpbGVCYXNlTmFtZSwgY3VycmVudE1kLCB0aGlzKTtcblx0XHRcdFx0XHR9IGNhdGNoIHtcblx0XHRcdFx0XHRcdG5ldyBOb3RpY2UoXCJFcnJvciwgY291bGQgbm90IHJlbmFtZSB0aGUgZmlsZSFcIik7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KVxuXHRcdClcblx0XHR0aGlzLmFkZE1lbnVFeHRlbmRlZFByZXZpZXdNb2RlKG1lbnUsIEZpbGVCYXNlTmFtZSwgY3VycmVudE1kKTtcblx0fTtcblxuXG5cdC8qKlxuXHQgKiBcdThCQkVcdTdGNkVcdTgzRENcdTUzNTVcdTYzMDlcdTk0QUVcdUZGMENcdTVFNzZcdThCQkVcdTdGNkVcdTcwQjlcdTUxRkJcdTRFOEJcdTRFRjZcblx0ICpcblx0ICogQHBhcmFtIG1lbnVcblx0ICogQHBhcmFtIEZpbGVCYXNlTmFtZVxuXHQgKiBAcGFyYW0gY3VycmVudE1kXG5cdCAqL1xuXHRhZGRNZW51RXh0ZW5kZWRQcmV2aWV3TW9kZSA9IChtZW51OiBNZW51LCBGaWxlQmFzZU5hbWU6IHN0cmluZywgY3VycmVudE1kOiBURmlsZSkgPT4ge1xuXHRcdGNvbnN0IGZpbGUgPSBVdGlsLmdldEZpbGVCeUJhc2VOYW1lKGN1cnJlbnRNZCwgRmlsZUJhc2VOYW1lKSBhcyBURmlsZTtcblx0XHQvLyBjb25zdCBiYXNlUGF0aCA9IChmaWxlLnZhdWx0LmFkYXB0ZXIgYXMgYW55KS5iYXNlUGF0aDtcblx0XHQvLyBjb25zdCByZWxhdGl2ZUZpbGVQYXRoID0gZmlsZS5wYXRoO1xuXG5cdFx0bWVudS5hZGRJdGVtKChpdGVtOiBNZW51SXRlbSkgPT5cblx0XHRcdGl0ZW1cblx0XHRcdFx0LnNldEljb24oXCJjb3B5XCIpXG5cdFx0XHRcdC5zZXRUaXRsZShcIkNvcHkgZmlsZSB0byBjbGlwYm9hcmRcIilcblx0XHRcdFx0Ly8gLnNldENoZWNrZWQodHJ1ZSlcblx0XHRcdFx0Lm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuXHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHRVdGlsLmhhbmRsZXJDb3B5RmlsZShGaWxlQmFzZU5hbWUsIGN1cnJlbnRNZCwgdGhpcyk7XG5cdFx0XHRcdFx0fSBjYXRjaCB7XG5cdFx0XHRcdFx0XHRuZXcgTm90aWNlKFwiRXJyb3IsIGNvdWxkIG5vdCBjb3B5IHRoZSBmaWxlIVwiKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pXG5cdFx0KTtcblx0XHRtZW51LmFkZEl0ZW0oKGl0ZW06IE1lbnVJdGVtKSA9PiBpdGVtXG5cdFx0XHQuc2V0SWNvbihcImFycm93LXVwLXJpZ2h0XCIpXG5cdFx0XHQuc2V0VGl0bGUoXCJPcGVuIGluIGRlZmF1bHQgYXBwXCIpXG5cdFx0XHQub25DbGljaygoKSA9PiAodGhpcy5hcHAgYXMgQXBwV2l0aERlc2t0b3BJbnRlcm5hbEFwaSkub3BlbldpdGhEZWZhdWx0QXBwKGZpbGUucGF0aCkpXG5cdFx0KTtcblx0XHRtZW51LmFkZEl0ZW0oKGl0ZW06IE1lbnVJdGVtKSA9PiBpdGVtXG5cdFx0XHQuc2V0SWNvbihcImFycm93LXVwLXJpZ2h0XCIpXG5cdFx0XHQuc2V0VGl0bGUoUGxhdGZvcm0uaXNNYWNPUyA/IFwiUmV2ZWFsIGluIGZpbmRlclwiIDogXCJTaG93IGluIHN5c3RlbSBleHBsb3JlclwiKVxuXHRcdFx0Lm9uQ2xpY2soKCkgPT4ge1xuXHRcdFx0XHQodGhpcy5hcHAgYXMgQXBwV2l0aERlc2t0b3BJbnRlcm5hbEFwaSkuc2hvd0luRm9sZGVyKGZpbGUucGF0aCk7XG5cdFx0XHR9KVxuXHRcdCk7XG5cdFx0bWVudS5hZGRJdGVtKChpdGVtOiBNZW51SXRlbSkgPT4gaXRlbVxuXHRcdFx0LnNldEljb24oXCJmb2xkZXJcIilcblx0XHRcdC5zZXRUaXRsZShcIlJldmVhbCBmaWxlIGluIG5hdmlnYXRpb25cIilcblx0XHRcdC5vbkNsaWNrKCgpID0+IHtcblx0XHRcdFx0Y29uc3QgYWJzdHJhY3RGaWxlUGF0aCA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChmaWxlLnBhdGgpO1xuXHRcdFx0XHQodGhpcy5hcHAgYXMgYW55KS5pbnRlcm5hbFBsdWdpbnMuZ2V0RW5hYmxlZFBsdWdpbkJ5SWQoXCJmaWxlLWV4cGxvcmVyXCIpLnJldmVhbEluRm9sZGVyKGFic3RyYWN0RmlsZVBhdGgpO1xuXHRcdFx0fSlcblx0XHQpO1xuXHR9O1xuXG5cblx0LyoqXG5cdCAqIFx1OUYyMFx1NjgwN1x1NzBCOVx1NTFGQlx1NEU4Qlx1NEVGNlxuXHQgKi9cblx0b25DbGljayhldmVudDogTW91c2VFdmVudCkge1xuXHRcdGNvbnN0IHRhcmdldCA9IGdldE1vdXNlRXZlbnRUYXJnZXQoZXZlbnQpO1xuXHRcdGNvbnN0IGN1clRhcmdldFR5cGUgPSB0YXJnZXQubG9jYWxOYW1lO1xuXG5cdFx0Y29uc3QgY3VycmVudE1kID0gYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCkgYXMgVEZpbGU7XG5cdFx0Y29uc3QgaW5DYW52YXMgPSBjdXJyZW50TWQubmFtZS5lbmRzV2l0aCgnLmNhbnZhcycpO1xuXHRcdGNvbnN0IFN1cHBvcnRlZFRhcmdldFR5cGUgPSBbXCJpbWdcIiwgXCJpZnJhbWVcIiwgXCJ2aWRlb1wiLCBcImRpdlwiLCBcImF1ZGlvXCJdO1xuXG5cdFx0Y29uc3QgbWVudSA9IG5ldyBNZW51KCk7XG5cblx0XHRpZiAoIVN1cHBvcnRlZFRhcmdldFR5cGUuaW5jbHVkZXMoY3VyVGFyZ2V0VHlwZSkpIHJldHVybjtcblxuXHRcdC8vIFx1NTIyNFx1NjVBRFx1NUY1M1x1NTI0RFx1NzBCOVx1NTFGQlx1NzY4NFx1NTczMFx1NjVCOVx1NjYyRlx1NTQyNlx1NEUzQVx1ODg2OFx1NjgzQ1xuXHRcdC8vIGNvbnN0IGluVGFibGU6Ym9vbGVhbiA9IHRhcmdldC5wYXJlbnRFbGVtZW50Py5wYXJlbnRFbGVtZW50Py5nZXRBdHRyaWJ1dGUoJ2NsYXNzJyk9PSd0YWJsZS1jZWxsLXdyYXBwZXInO1xuXHRcdGNvbnN0IGluVGFibGU6IGJvb2xlYW4gPSB0YXJnZXQuY2xvc2VzdCgndGFibGUnKSAhPSBudWxsO1xuXHRcdGNvbnN0IGluQ2FsbG91dDogYm9vbGVhbiA9IHRhcmdldC5jbG9zZXN0KCcuY2FsbG91dCcpICE9IG51bGw7XG5cdFx0Y29uc3QgaW5QcmV2aWV3OmJvb2xlYW4gPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpPy5nZXRNb2RlKCkgPT0gXCJwcmV2aWV3XCI7XG5cdFx0Y29uc3QgaXNFeGNhbGlkcmF3OmJvb2xlYW4gPSB0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdleGNhbGlkcmF3LWVtYmVkZGVkLWltZycpO1xuXG5cdFx0bGV0IHRhcmdldF9uYW1lID0gdGFyZ2V0LmdldEF0dHJpYnV0ZShcInNyY1wiKSBhcyBzdHJpbmc7XG5cdFx0Ly8gXHU1QkY5XHU0RThFIENhbGxvdXQgXHU1NDhDIFRhYmxlIFx1NEUyRFx1NzY4NFx1N0Y1MVx1N0VEQ1x1NTZGRVx1NzI0N1x1RkYwQ1x1NkNBMVx1NjcwOVx1NTNGM1x1OTUyRVx1ODNEQ1x1NTM1NVxuXHRcdGlmICh0YXJnZXRfbmFtZSAmJiB0YXJnZXRfbmFtZS5zdGFydHNXaXRoKCdodHRwJykpIHJldHVybjtcblxuXHRcdGlmIChpbkNhbnZhcyl7XG5cdFx0XHQvLyBcdTU5ODJcdTY3OUNcdTY2MkZcdTU2RkVcdTUwQ0ZcdTgyODJcdTcwQjlcdUZGMENcdThGRDRcdTU2REVcblx0XHRcdGlmICh0YXJnZXQucGFyZW50RWxlbWVudD8uY2xhc3NMaXN0LmNvbnRhaW5zKCdjYW52YXMtbm9kZS1jb250ZW50JykpIHJldHVybjtcblx0XHRcdGxldCBmaWxlX25hbWUgPSB0YXJnZXQucGFyZW50RWxlbWVudD8uZ2V0QXR0cmlidXRlKCdzcmMnKTtcblx0XHRcdC8vIHByaW50KFwiVGFyZ2V0IE5hbWU6XCIsIGZpbGVfbmFtZSk7XG5cblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHRpZiAoaXNFeGNhbGlkcmF3KXtcblx0XHRcdHRhcmdldF9uYW1lID0gdGFyZ2V0LmdldEF0dHJpYnV0ZSgnZmlsZXNvdXJjZScpIGFzIHN0cmluZztcblx0XHRcdGxldCBmaWxlX2Jhc2VfbmFtZSA9IHRhcmdldF9uYW1lXG5cdFx0XHRpZihmaWxlX2Jhc2VfbmFtZS5pbmNsdWRlcygnLycpKXtcblx0XHRcdFx0bGV0IHRlbXBfYXJyID0gZmlsZV9iYXNlX25hbWUuc3BsaXQoJy8nKTtcblx0XHRcdFx0ZmlsZV9iYXNlX25hbWUgPSB0ZW1wX2Fyclt0ZW1wX2Fyci5sZW5ndGgtMV1cblx0XHRcdH1lbHNlIGlmKGZpbGVfYmFzZV9uYW1lLmluY2x1ZGVzKCdcXFxcJykpe1xuXHRcdFx0XHRsZXQgdGVtcF9hcnIgPSBmaWxlX2Jhc2VfbmFtZS5zcGxpdCgnXFxcXCcpO1xuXHRcdFx0XHRmaWxlX2Jhc2VfbmFtZSA9IHRlbXBfYXJyW3RlbXBfYXJyLmxlbmd0aC0xXVxuXHRcdFx0fVxuXHRcdFx0ZmlsZV9iYXNlX25hbWUgPSBmaWxlX2Jhc2VfbmFtZS5lbmRzV2l0aCgnLm1kJykgPyBcblx0XHRcdFx0ZmlsZV9iYXNlX25hbWUuc3Vic3RyaW5nKDAsIGZpbGVfYmFzZV9uYW1lLmxlbmd0aC0zKSA6IFxuXHRcdFx0XHRmaWxlX2Jhc2VfbmFtZTtcblx0XHRcdHRhcmdldF9uYW1lID0gZmlsZV9iYXNlX25hbWU7XG5cdFx0fVxuXHRcdGVsc2V7XG5cdFx0XHR0YXJnZXRfbmFtZSA9IHRhcmdldC5wYXJlbnRFbGVtZW50Py5nZXRBdHRyaWJ1dGUoXCJzcmNcIikgYXMgc3RyaW5nO1xuXHRcdFx0Ly8gXHU1MjIwXHU5NjY0IHRhcmdldF9uYW1lIFx1NTNFRlx1ODBGRFx1NTI0RFx1N0YwMFx1NzY4NFx1NTkxQVx1NEUyQSAnLi4vJ1x1RkYwQ1x1NjUyRlx1NjMwMVx1OTRGRVx1NjNBNVx1OERFRlx1NUY4NFx1NEUzQVx1NUY1M1x1NTI0RFx1N0IxNFx1OEJCMFx1NzY4NFx1NzZGOFx1NUJGOVx1OERFRlx1NUY4NFxuXHRcdFx0dGFyZ2V0X25hbWUgPSB0YXJnZXRfbmFtZS5yZXBsYWNlKC9eKFxcLlxcLlxcLykrL2csICcnKTtcblx0XHRcdGxldCBwZGZfbWF0Y2ggPSB0YXJnZXRfbmFtZS5tYXRjaCgvLipcXC5wZGYvKTtcblx0XHRcdHRhcmdldF9uYW1lID0gcGRmX21hdGNoID8gcGRmX21hdGNoWzBdIDogdGFyZ2V0X25hbWU7XG5cdFx0XHRpZiAoY3VyVGFyZ2V0VHlwZT09J2ltZycgJiYgcGRmX21hdGNoKSByZXR1cm47XG5cdFx0fVxuXG5cdFx0aWYgKGluUHJldmlldykge1xuXHRcdFx0aWYgKFN1cHBvcnRlZFRhcmdldFR5cGUuaW5jbHVkZXMoY3VyVGFyZ2V0VHlwZSkpIHtcblx0XHRcdFx0Ly8gY29uc29sZS5sb2coXCJGaWxlQmFzZU5hbWVcIiwgRmlsZUJhc2VOYW1lKTtcblx0XHRcdFx0dGhpcy5hZGRNZW51RXh0ZW5kZWRQcmV2aWV3TW9kZShtZW51LCB0YXJnZXRfbmFtZSwgY3VycmVudE1kKTtcblx0XHRcdH1cblx0XHR9XG5cdFx0ZWxzZXtcblx0XHRcdGNvbnN0IGVkaXRvciA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk/LmVkaXRvcjtcblx0XHRcdC8vICBAdHMtZXhwZWN0LWVycm9yLCBub3QgdHlwZWRcblx0XHRcdGNvbnN0IGVkaXRvclZpZXcgPSBlZGl0b3IuY20gYXMgRWRpdG9yVmlldztcblx0XHRcdGNvbnN0IHRhcmdldF9wb3MgPSBlZGl0b3JWaWV3LnBvc0F0RE9NKHRhcmdldCk7XG5cdFx0XHQvLyBjb25zb2xlLmxvZygndGFyZ2V0JywgdGFyZ2V0KVxuXHRcdFx0Ly8gY29uc29sZS5sb2coJ3RhcmdldC5wYXJlbnRFbGVtZW50JywgdGFyZ2V0LnBhcmVudEVsZW1lbnQpXG5cdFx0XHQvLyBjb25zdCBwcmV2X3BvcyA9IGVkaXRvclZpZXcucG9zQXRET00odGFyZ2V0LnBhcmVudEVsZW1lbnQ/LnByZXZpb3VzRWxlbWVudFNpYmxpbmcgYXMgSFRNTEVsZW1lbnQpO1xuXHRcdFx0Ly8gY29uc3QgbmV4dF9wb3MgPSBlZGl0b3JWaWV3LnBvc0F0RE9NKHRhcmdldC5wYXJlbnRFbGVtZW50Py5uZXh0RWxlbWVudFNpYmxpbmcgYXMgSFRNTEVsZW1lbnQpO1xuXHRcdFx0Ly8gbGV0IHByZXZfdGFyZ2V0X2xpbmUgPSBlZGl0b3JWaWV3LnN0YXRlLmRvYy5saW5lQXQocHJldl9wb3MpO1xuXHRcdFx0Ly8gbGV0IG5leHRfdGFyZ2V0X2xpbmUgPSBlZGl0b3JWaWV3LnN0YXRlLmRvYy5saW5lQXQobmV4dF9wb3MpO1xuXHRcdFx0Ly8gY29uc29sZS5sb2coJ3ByZXYgdGFyZ2V0IGxpbmUgaW5mb3JtYXRpb246IGxpbmUtY29udGVudCwgbGluZS1udW1iZXIoMS1iYXNlZCksIHRhcmdldC5jaCcpO1xuXHRcdFx0Ly8gY29uc29sZS5sb2cocHJldl90YXJnZXRfbGluZS50ZXh0LCBwcmV2X3RhcmdldF9saW5lLm51bWJlciwgcHJldl9wb3MtcHJldl90YXJnZXRfbGluZS5mcm9tKVxuXG5cdFx0XHRsZXQgdGFyZ2V0X2xpbmUgPSBlZGl0b3JWaWV3LnN0YXRlLmRvYy5saW5lQXQodGFyZ2V0X3Bvcyk7XG5cdFx0XHRwcmludCgndGFyZ2V0IGxpbmUgaW5mb3JtYXRpb246IGxpbmUtY29udGVudCwgbGluZS1udW1iZXIoMS1iYXNlZCksIHRhcmdldC5jaCcpO1xuXHRcdFx0cHJpbnQodGFyZ2V0X2xpbmUudGV4dCwgdGFyZ2V0X2xpbmUubnVtYmVyLCB0YXJnZXRfcG9zIC0gdGFyZ2V0X2xpbmUuZnJvbSk7XG5cblx0XHRcdC8vIC0tLS0tLS0tLS0gRWRpdG9ySW50ZXJuYWxBcGkucG9zQXRNb3VzZSBcdTRFMERcdTY2MkZcdTVGODhcdTUxQzZcdTc4NkVcdUZGMENcdTRFMERcdTc3RTVcdTkwNTNcdTRFM0FcdTRFQzBcdTRFNDhcdUZGMENcdTg4NENcdTUzRjdcdTU0OENjaFx1OTBGRFx1NEUwRFx1NTFDNlx1Nzg2RSAtLS0tLS0tLS0tXG5cdFx0XHQvLyBjb25zdCBlZGl0b3IyID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KT8uZWRpdG9yIGFzIEVkaXRvckludGVybmFsQXBpO1xuXHRcdCAgICAvLyBjb25zdCBwb3NpdGlvbiA9IGVkaXRvcjIucG9zQXRNb3VzZShldmVudCk7XG5cdFx0XHQvLyBjb25zb2xlLmxvZygnSW50ZXJBUElQb3MgbGluZSBpbmZvcm1hdGlvbjogbGluZS1jb250ZW50LCBsaW5lLW51bWJlcigxLWJhc2VkKSwgdGFyZ2V0LmNoJylcblx0XHRcdC8vIGNvbnNvbGUubG9nKGVkaXRvcj8uZ2V0TGluZShwb3NpdGlvbi5saW5lKSwgcG9zaXRpb24ubGluZSsxLCBwb3NpdGlvbi5jaClcblx0XHRcdC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5cdFx0XHQvLyBjb25zb2xlLmxvZygnbmV4dCB0YXJnZXQgbGluZSBpbmZvcm1hdGlvbjogbGluZS1jb250ZW50LCBsaW5lLW51bWJlcigxLWJhc2VkKSwgdGFyZ2V0LmNoJyk7XG5cdFx0XHQvLyBjb25zb2xlLmxvZyhuZXh0X3RhcmdldF9saW5lLnRleHQsIG5leHRfdGFyZ2V0X2xpbmUubnVtYmVyLCBuZXh0X3Bvcy1uZXh0X3RhcmdldF9saW5lLmZyb20pXG5cblx0XHRcdGlmIChTdXBwb3J0ZWRUYXJnZXRUeXBlLmluY2x1ZGVzKGN1clRhcmdldFR5cGUpKSB7XG5cdFx0XHRcdHRoaXMuYWRkTWVudUV4dGVuZGVkU291cmNlTW9kZShtZW51LCB0YXJnZXRfbmFtZSwgY3VycmVudE1kLCBjdXJUYXJnZXRUeXBlLCB0YXJnZXRfcG9zLCBpblRhYmxlLCBpbkNhbGxvdXQpO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHRoaXMucmVnaXN0ZXJFc2NhcGVCdXR0b24obWVudSk7XG5cdFx0XG5cdFx0aWYgKGluVGFibGUgJiYgIWluUHJldmlldyl7XG5cdFx0XHRtZW51LnNob3dBdFBvc2l0aW9uKHsgeDogZXZlbnQucGFnZVgsIHk6IGV2ZW50LnBhZ2VZLTE2M30pO1xuXHRcdH1cblx0XHRlbHNle1xuXHRcdFx0bWVudS5zaG93QXRQb3NpdGlvbih7IHg6IGV2ZW50LnBhZ2VYLCB5OiBldmVudC5wYWdlWSB9KTtcblx0XHR9XG5cdFx0dGhpcy5hcHAud29ya3NwYWNlLnRyaWdnZXIoXCJBdHRhY2hGbG93OmNvbnRleHRtZW51XCIsIG1lbnUpO1xuXHR9XG5cbn1cblxuZnVuY3Rpb24gdXBkYXRlSW50ZXJuYWxMaW5rKGFjdGl2ZVZpZXc6IE1hcmtkb3duVmlldywgdGFyZ2V0OiBIVE1MSW1hZ2VFbGVtZW50IHwgSFRNTFZpZGVvRWxlbWVudCwgdGFyZ2V0X3BvczogbnVtYmVyLCBpbWFnZU5hbWU6IHN0cmluZywgbmV3V2lkdGg6IG51bWJlciwgbmV3SGVpZ2h0OiBudW1iZXIsIGluVGFibGU6IGJvb2xlYW4sIGluQ2FsbG91dDogYm9vbGVhbik6IHZvaWQge1xuXHRjb25zdCBlZGl0b3IgPSBhY3RpdmVWaWV3LmVkaXRvcjtcblx0Ly8gIEB0cy1leHBlY3QtZXJyb3IsIG5vdCB0eXBlZFxuXHRjb25zdCBlZGl0b3JWaWV3ID0gZWRpdG9yLmNtIGFzIEVkaXRvclZpZXc7XG5cdGxldCB0YXJnZXRfbGluZSA9IGVkaXRvclZpZXcuc3RhdGUuZG9jLmxpbmVBdCh0YXJnZXRfcG9zKTtcblx0Ly8gcHJpbnQoJ3RhcmdldCBsaW5lIGluZm9ybWF0aW9uOiBsaW5lLWNvbnRlbnQsIGxpbmUtbnVtYmVyKDEtYmFzZWQpLCB0YXJnZXQuY2gnKTtcblx0Ly8gcHJpbnQodGFyZ2V0X2xpbmUudGV4dCwgdGFyZ2V0X2xpbmUubnVtYmVyLCB0YXJnZXRfcG9zIC0gdGFyZ2V0X2xpbmUuZnJvbSk7XG5cblxuXHRpZiAoIWluQ2FsbG91dCAmJiAhaW5UYWJsZSl7XG5cdFx0bGV0IG1hdGNoZWQgPSBtYXRjaExpbmVXaXRoSW50ZXJuYWxMaW5rKHRhcmdldF9saW5lLnRleHQsIGltYWdlTmFtZSwgbmV3V2lkdGgsIGluVGFibGUpO1xuXHRcdGlmIChtYXRjaGVkLmxlbmd0aD09MSl7XG5cdFx0XHRlZGl0b3JWaWV3LmRpc3BhdGNoKHsgXG5cdFx0XHRcdGNoYW5nZXM6IHsgXG5cdFx0XHRcdFx0ZnJvbTogdGFyZ2V0X2xpbmUuZnJvbSttYXRjaGVkWzBdLmZyb21fY2gsIFxuXHRcdFx0XHRcdHRvOiB0YXJnZXRfbGluZS5mcm9tK21hdGNoZWRbMF0udG9fY2gsIFxuXHRcdFx0XHRcdGluc2VydDogbWF0Y2hlZFswXS5uZXdfbGluayBcblx0XHRcdFx0fSBcblx0XHRcdH0pO1xuXHRcdFx0Ly8gZWRpdG9yLnJlcGxhY2VSYW5nZShtYXRjaGVkWzBdLm5ld19saW5rLCBcblx0XHRcdC8vIFx0e2xpbmU6dGFyZ2V0X2xpbmUubnVtYmVyLTEsIGNoOm1hdGNoZWRbMF0uZnJvbV9jaH0sIFxuXHRcdFx0Ly8gXHR7bGluZTp0YXJnZXRfbGluZS5udW1iZXItMSwgY2g6bWF0Y2hlZFswXS50b19jaH1cblx0XHRcdC8vIFx0KTtcblx0XHR9XG5cdFx0ZWxzZSBpZihtYXRjaGVkLmxlbmd0aD09MCl7XG5cdFx0XHQvLyBuZXcgTm90aWNlKCdGYWlsIHRvIGZpbmQgY3VycmVudCBpbWFnZS1saW5rLCBwbGVhc2Ugem9vbSBtYW51YWxseSEnKVxuXHRcdH1cblx0XHRlbHNle1xuXHRcdFx0bmV3IE5vdGljZSgnRmluZCBtdWx0aXBsZSBzYW1lIGltYWdlLWxpbmsgaW4gbGluZSwgcGxlYXNlIHpvb20gbWFudWFsbHkhJylcblx0XHR9XG5cdFx0cmV0dXJuO1xuXHR9XG5cblx0dHlwZSBSZWdEaWN0aW9uYXJ5ID0ge1xuXHRcdFtrZXk6IHN0cmluZ106IFJlZ0V4cDtcblx0fTtcblx0XG5cdGxldCBzdGFydFJlZzogUmVnRGljdGlvbmFyeSA9IHtcblx0XHQndGFibGUnOiAvXlxccypcXHwvLFxuXHRcdCdjYWxsb3V0JzogL14+Lyxcblx0fTtcblxuXHRsZXQgbW9kZSA9IGluVGFibGUgPyAndGFibGUnIDogJ2NhbGxvdXQnO1xuXHRwcmludCgnbW9kZScsIG1vZGUpXG5cblx0Y29uc3Qgc3RhcnRfcmVnID0gc3RhcnRSZWdbbW9kZV07XG5cdGxldCBzdGFydF9saW5lX251bWJlciA9IHRhcmdldF9saW5lLm51bWJlcjtcblx0bGV0IG1hdGNoZWRfcmVzdWx0czogTWF0Y2hlZExpbmtJbkxpbmVbXSA9IFtdO1xuXHRsZXQgbWF0Y2hlZF9saW5lczogbnVtYmVyW10gPSBbXTsgIC8vMS1iYXNlZFxuXHRmb3IgKGxldCBpID0gc3RhcnRfbGluZV9udW1iZXI7IGkgPD0gZWRpdG9yLmxpbmVDb3VudCgpOyBpKyspe1xuXHRcdGxldCBsaW5lID0gZWRpdG9yVmlldy5zdGF0ZS5kb2MubGluZShpKTtcblx0XHRpZiAoIXN0YXJ0X3JlZy50ZXN0KGxpbmUudGV4dCkpIGJyZWFrO1xuXHRcdGxldCBtYXRjaGVkID0gbWF0Y2hMaW5lV2l0aEludGVybmFsTGluayhsaW5lLnRleHQsIGltYWdlTmFtZSwgbmV3V2lkdGgsIGluVGFibGUpO1xuXHRcdG1hdGNoZWRfcmVzdWx0cy5wdXNoKC4uLm1hdGNoZWQpO1xuXHRcdG1hdGNoZWRfbGluZXMucHVzaCguLi5uZXcgQXJyYXkobWF0Y2hlZC5sZW5ndGgpLmZpbGwoaSkpO1xuXHR9XG5cblx0Zm9yIChsZXQgaSA9IHN0YXJ0X2xpbmVfbnVtYmVyLTE7IGkgPj0gMTsgaS0tKXtcblx0XHRsZXQgbGluZSA9IGVkaXRvclZpZXcuc3RhdGUuZG9jLmxpbmUoaSk7XG5cdFx0aWYgKCFzdGFydF9yZWcudGVzdChsaW5lLnRleHQpKSBicmVhaztcblx0XHRsZXQgbWF0Y2hlZCA9IG1hdGNoTGluZVdpdGhJbnRlcm5hbExpbmsobGluZS50ZXh0LCBpbWFnZU5hbWUsIG5ld1dpZHRoLCBpblRhYmxlKTtcblx0XHRtYXRjaGVkX3Jlc3VsdHMucHVzaCguLi5tYXRjaGVkKTtcblx0XHRtYXRjaGVkX2xpbmVzLnB1c2goLi4ubmV3IEFycmF5KG1hdGNoZWQubGVuZ3RoKS5maWxsKGkpKTtcblx0fVxuXG5cdC8vIHByaW50KFwiTWF0Y2hlZCBJbmZvcm1hdGlvblwiKVxuXHQvLyBwcmludChtYXRjaGVkX3Jlc3VsdHMpXG5cdC8vIHByaW50KG1hdGNoZWRfbGluZXMpXG5cblx0aWYgKG1hdGNoZWRfcmVzdWx0cy5sZW5ndGg9PTEpe1xuXHRcdGxldCB0YXJnZXRfbGluZSA9IGVkaXRvclZpZXcuc3RhdGUuZG9jLmxpbmUobWF0Y2hlZF9saW5lc1swXSk7XG5cdFx0aWYgKG1vZGUgPT0gJ3RhYmxlJyl7XG5cdFx0XHRsZXQgb2xkX3RleHQgPSB0YXJnZXRfbGluZS50ZXh0O1xuXHRcdFx0bGV0IG5ld19saW5lX3RleHQgPSBvbGRfdGV4dC5zdWJzdHJpbmcoMCwgbWF0Y2hlZF9yZXN1bHRzWzBdLmZyb21fY2gpICtcblx0XHRcdFx0XHRcdG1hdGNoZWRfcmVzdWx0c1swXS5uZXdfbGluayArIFxuXHRcdFx0XHRcdFx0b2xkX3RleHQuc3Vic3RyaW5nKG1hdGNoZWRfcmVzdWx0c1swXS50b19jaCk7XG5cdFx0XHRlZGl0b3JWaWV3LmRpc3BhdGNoKHsgXG5cdFx0XHRcdGNoYW5nZXM6IHsgXG5cdFx0XHRcdFx0ZnJvbTogdGFyZ2V0X2xpbmUuZnJvbSwgXG5cdFx0XHRcdFx0dG86IHRhcmdldF9saW5lLmZyb20rb2xkX3RleHQubGVuZ3RoLCBcblx0XHRcdFx0XHRpbnNlcnQ6IG5ld19saW5lX3RleHRcblx0XHRcdFx0fSBcblx0XHRcdH0pO1xuXHRcdH1lbHNle1xuXHRcdFx0ZWRpdG9yVmlldy5kaXNwYXRjaCh7IFxuXHRcdFx0XHRjaGFuZ2VzOiB7IFxuXHRcdFx0XHRcdGZyb206IHRhcmdldF9saW5lLmZyb20rbWF0Y2hlZF9yZXN1bHRzWzBdLmZyb21fY2gsIFxuXHRcdFx0XHRcdHRvOiB0YXJnZXRfbGluZS5mcm9tK21hdGNoZWRfcmVzdWx0c1swXS50b19jaCwgXG5cdFx0XHRcdFx0aW5zZXJ0OiBtYXRjaGVkX3Jlc3VsdHNbMF0ubmV3X2xpbmsgXG5cdFx0XHRcdH0gXG5cdFx0XHR9KTtcblx0XHR9XG5cdH1cblx0ZWxzZSBpZihtYXRjaGVkX3Jlc3VsdHMubGVuZ3RoPT0wKXtcblx0XHRuZXcgTm90aWNlKGBGYWlsIHRvIGZpbmQgY3VycmVudCBpbWFnZS1saW5rIGluICR7bW9kZX0sIHBsZWFzZSB6b29tIG1hbnVhbGx5IWApXG5cdH1cblx0ZWxzZXtcblx0XHRuZXcgTm90aWNlKGBGaW5kIG11bHRpcGxlIHNhbWUgaW1hZ2UtbGluayBpbiAke21vZGV9LCBwbGVhc2Ugem9vbSBtYW51YWxseSFgKVxuXHR9XG5cdHJldHVybjtcbn1cblxuXG5mdW5jdGlvbiB1cGRhdGVFeHRlcm5hbExpbmsoYWN0aXZlVmlldzogTWFya2Rvd25WaWV3LCB0YXJnZXQ6IEhUTUxJbWFnZUVsZW1lbnQgfCBIVE1MVmlkZW9FbGVtZW50LCB0YXJnZXRfcG9zOiBudW1iZXIsIG5ld1dpZHRoOiBudW1iZXIsIG5ld0hlaWdodDogbnVtYmVyLCBpblRhYmxlOiBib29sZWFuLCBpbkNhbGxvdXQ6IGJvb2xlYW4pOiB2b2lkIHtcblx0Y29uc3QgZWRpdG9yID0gYWN0aXZlVmlldy5lZGl0b3I7XG5cdC8vICBAdHMtZXhwZWN0LWVycm9yLCBub3QgdHlwZWRcblx0Y29uc3QgZWRpdG9yVmlldyA9IGVkaXRvci5jbSBhcyBFZGl0b3JWaWV3O1xuXHRsZXQgdGFyZ2V0X2xpbmUgPSBlZGl0b3JWaWV3LnN0YXRlLmRvYy5saW5lQXQodGFyZ2V0X3Bvcyk7XG5cblx0Y29uc3QgbGluayA9IHRhcmdldC5nZXRBdHRyaWJ1dGUoJ3NyYycpIGFzIHN0cmluZztcblx0Y29uc3QgYWx0VGV4dCA9IHRhcmdldC5nZXRBdHRyaWJ1dGUoXCJhbHRcIikgYXMgc3RyaW5nO1xuXG5cdGlmICghaW5DYWxsb3V0ICYmICFpblRhYmxlKXtcblx0XHRsZXQgbWF0Y2hlZCA9IG1hdGNoTGluZVdpdGhFeHRlcm5hbExpbmsodGFyZ2V0X2xpbmUudGV4dCwgbGluaywgYWx0VGV4dCwgbmV3V2lkdGgsIGluVGFibGUpO1xuXHRcdGlmIChtYXRjaGVkLmxlbmd0aD09MSl7XG5cdFx0XHRlZGl0b3JWaWV3LmRpc3BhdGNoKHsgXG5cdFx0XHRcdGNoYW5nZXM6IHsgXG5cdFx0XHRcdFx0ZnJvbTogdGFyZ2V0X2xpbmUuZnJvbSttYXRjaGVkWzBdLmZyb21fY2gsIFxuXHRcdFx0XHRcdHRvOiB0YXJnZXRfbGluZS5mcm9tK21hdGNoZWRbMF0udG9fY2gsIFxuXHRcdFx0XHRcdGluc2VydDogbWF0Y2hlZFswXS5uZXdfbGluayBcblx0XHRcdFx0fSBcblx0XHRcdH0pO1xuXHRcdH1cblx0XHRlbHNlIGlmKG1hdGNoZWQubGVuZ3RoPT0wKXtcblx0XHRcdC8vIG5ldyBOb3RpY2UoJ0ZhaWwgdG8gZmluZCBjdXJyZW50IGltYWdlLWxpbmssIHBsZWFzZSB6b29tIG1hbnVhbGx5IScpXG5cdFx0fVxuXHRcdGVsc2V7XG5cdFx0XHRuZXcgTm90aWNlKCdGaW5kIG11bHRpcGxlIHNhbWUgaW1hZ2UtbGluayBpbiBsaW5lLCBwbGVhc2Ugem9vbSBtYW51YWxseSEnKVxuXHRcdH1cblx0XHRyZXR1cm47XG5cdH1cblxuXHR0eXBlIFJlZ0RpY3Rpb25hcnkgPSB7XG5cdFx0W2tleTogc3RyaW5nXTogUmVnRXhwO1xuXHR9O1xuXHRcblx0bGV0IHN0YXJ0UmVnOiBSZWdEaWN0aW9uYXJ5ID0ge1xuXHRcdCd0YWJsZSc6IC9eXFxzKlxcfC8sXG5cdFx0J2NhbGxvdXQnOiAvXj4vLFxuXHR9O1xuXG5cdGxldCBtb2RlID0gaW5UYWJsZSA/ICd0YWJsZScgOiAnY2FsbG91dCc7XG5cdHByaW50KCdtb2RlJywgbW9kZSlcblxuXHRjb25zdCBzdGFydF9yZWcgPSBzdGFydFJlZ1ttb2RlXTtcblx0bGV0IHN0YXJ0X2xpbmVfbnVtYmVyID0gdGFyZ2V0X2xpbmUubnVtYmVyO1xuXHRsZXQgbWF0Y2hlZF9yZXN1bHRzOiBNYXRjaGVkTGlua0luTGluZVtdID0gW107XG5cdGxldCBtYXRjaGVkX2xpbmVzOiBudW1iZXJbXSA9IFtdOyAgLy8xLWJhc2VkXG5cdGZvciAobGV0IGkgPSBzdGFydF9saW5lX251bWJlcjsgaSA8PSBlZGl0b3IubGluZUNvdW50KCk7IGkrKyl7XG5cdFx0bGV0IGxpbmUgPSBlZGl0b3JWaWV3LnN0YXRlLmRvYy5saW5lKGkpO1xuXHRcdGlmICghc3RhcnRfcmVnLnRlc3QobGluZS50ZXh0KSkgYnJlYWs7XG5cdFx0bGV0IG1hdGNoZWQgPSBtYXRjaExpbmVXaXRoRXh0ZXJuYWxMaW5rKGxpbmUudGV4dCwgbGluaywgYWx0VGV4dCwgbmV3V2lkdGgsIGluVGFibGUpO1xuXHRcdG1hdGNoZWRfcmVzdWx0cy5wdXNoKC4uLm1hdGNoZWQpO1xuXHRcdG1hdGNoZWRfbGluZXMucHVzaCguLi5uZXcgQXJyYXkobWF0Y2hlZC5sZW5ndGgpLmZpbGwoaSkpO1xuXHR9XG5cblx0Zm9yIChsZXQgaSA9IHN0YXJ0X2xpbmVfbnVtYmVyLTE7IGkgPj0gMTsgaS0tKXtcblx0XHRsZXQgbGluZSA9IGVkaXRvclZpZXcuc3RhdGUuZG9jLmxpbmUoaSk7XG5cdFx0aWYgKCFzdGFydF9yZWcudGVzdChsaW5lLnRleHQpKSBicmVhaztcblx0XHRsZXQgbWF0Y2hlZCA9IG1hdGNoTGluZVdpdGhFeHRlcm5hbExpbmsobGluZS50ZXh0LCBsaW5rLCBhbHRUZXh0LCBuZXdXaWR0aCwgaW5UYWJsZSk7XG5cdFx0bWF0Y2hlZF9yZXN1bHRzLnB1c2goLi4ubWF0Y2hlZCk7XG5cdFx0bWF0Y2hlZF9saW5lcy5wdXNoKC4uLm5ldyBBcnJheShtYXRjaGVkLmxlbmd0aCkuZmlsbChpKSk7XG5cdH1cblxuXHRwcmludChtYXRjaGVkX3Jlc3VsdHMpXG5cdHByaW50KG1hdGNoZWRfbGluZXMpXG5cblx0aWYgKG1hdGNoZWRfcmVzdWx0cy5sZW5ndGg9PTEpe1xuXHRcdGxldCB0YXJnZXRfbGluZSA9IGVkaXRvclZpZXcuc3RhdGUuZG9jLmxpbmUobWF0Y2hlZF9saW5lc1swXSk7XG5cdFx0aWYgKG1vZGUgPT0gJ3RhYmxlJyl7XG5cdFx0XHRsZXQgb2xkX3RleHQgPSB0YXJnZXRfbGluZS50ZXh0O1xuXHRcdFx0bGV0IG5ld19saW5lX3RleHQgPSBvbGRfdGV4dC5zdWJzdHJpbmcoMCwgbWF0Y2hlZF9yZXN1bHRzWzBdLmZyb21fY2gpICtcblx0XHRcdFx0XHRcdG1hdGNoZWRfcmVzdWx0c1swXS5uZXdfbGluayArIFxuXHRcdFx0XHRcdFx0b2xkX3RleHQuc3Vic3RyaW5nKG1hdGNoZWRfcmVzdWx0c1swXS50b19jaCk7XG5cdFx0XHRlZGl0b3JWaWV3LmRpc3BhdGNoKHsgXG5cdFx0XHRcdGNoYW5nZXM6IHsgXG5cdFx0XHRcdFx0ZnJvbTogdGFyZ2V0X2xpbmUuZnJvbSwgXG5cdFx0XHRcdFx0dG86IHRhcmdldF9saW5lLmZyb20rb2xkX3RleHQubGVuZ3RoLCBcblx0XHRcdFx0XHRpbnNlcnQ6IG5ld19saW5lX3RleHRcblx0XHRcdFx0fSBcblx0XHRcdH0pO1xuXHRcdH1lbHNle1xuXHRcdFx0ZWRpdG9yVmlldy5kaXNwYXRjaCh7IFxuXHRcdFx0XHRjaGFuZ2VzOiB7IFxuXHRcdFx0XHRcdGZyb206IHRhcmdldF9saW5lLmZyb20rbWF0Y2hlZF9yZXN1bHRzWzBdLmZyb21fY2gsIFxuXHRcdFx0XHRcdHRvOiB0YXJnZXRfbGluZS5mcm9tK21hdGNoZWRfcmVzdWx0c1swXS50b19jaCwgXG5cdFx0XHRcdFx0aW5zZXJ0OiBtYXRjaGVkX3Jlc3VsdHNbMF0ubmV3X2xpbmsgXG5cdFx0XHRcdH0gXG5cdFx0XHR9KTtcblx0XHR9XG5cdH1cblx0ZWxzZSBpZihtYXRjaGVkX3Jlc3VsdHMubGVuZ3RoPT0wKXtcblx0XHRuZXcgTm90aWNlKGBGYWlsIHRvIGZpbmQgY3VycmVudCBpbWFnZS1saW5rIGluICR7bW9kZX0sIHBsZWFzZSB6b29tIG1hbnVhbGx5IWApXG5cdH1cblx0ZWxzZXtcblx0XHRuZXcgTm90aWNlKGBGaW5kIG11bHRpcGxlIHNhbWUgaW1hZ2UtbGluayBpbiAke21vZGV9LCBwbGVhc2Ugem9vbSBtYW51YWxseSFgKVxuXHR9XG5cdHJldHVybjtcblxufVxuXG5cbmZ1bmN0aW9uIG1hdGNoTGluZVdpdGhJbnRlcm5hbExpbmsobGluZV90ZXh0OiBzdHJpbmcsIHRhcmdldF9uYW1lOiBzdHJpbmcsIG5ld193aWR0aDogbnVtYmVyLCBpbnRhYmxlOiBib29sZWFuKTogTWF0Y2hlZExpbmtJbkxpbmVbXVxue1xuXHRsZXQgcmVnV2lraUxpbmsgPSAvXFwhXFxbXFxbW15cXFtcXF1dKj9cXF1cXF0vZztcbiAgICBsZXQgcmVnTWRMaW5rID0gL1xcIVxcW1teXFxbXFxdXSo/XFxdXFwoW15cXHNcXClcXChcXFtcXF1cXHtcXH0nXSpcXCkvZztcblx0Y29uc3QgdGFyZ2V0X25hbWVfbWRsaW5rID0gdGFyZ2V0X25hbWUucmVwbGFjZSgvIC9nLCAnJTIwJyk7XG5cdGlmICghbGluZV90ZXh0LmluY2x1ZGVzKHRhcmdldF9uYW1lKSAmJiAhbGluZV90ZXh0LmluY2x1ZGVzKHRhcmdldF9uYW1lX21kbGluaykpIHJldHVybiBbXTtcblxuXHRsZXQgcmVzdWx0OiBNYXRjaGVkTGlua0luTGluZVtdID0gW107XG5cdC8vIGNvbnN0IG5ld1dpa2lMaW5rID0gaW50YWJsZSA/IGAhW1ske3RhcmdldF9uYW1lfVxcXFx8JHtuZXdfd2lkdGh9XV1gOmAhW1ske3RhcmdldF9uYW1lfXwke25ld193aWR0aH1dXWA7XG5cdHdoaWxlKHRydWUpe1xuXHRcdGxldCB3aWtpX21hdGNoID0gcmVnV2lraUxpbmsuZXhlYyhsaW5lX3RleHQpO1xuXHRcdGlmICghd2lraV9tYXRjaCkgYnJlYWs7XG5cdFx0Y29uc3QgbWF0Y2hlZF9saW5rID0gd2lraV9tYXRjaFswXTtcblx0XHRpZiAobWF0Y2hlZF9saW5rLmluY2x1ZGVzKHRhcmdldF9uYW1lKSl7XG5cdFx0XHRsZXQgbm9ybWFsX2xpbmsgPSBpbnRhYmxlID8gbWF0Y2hlZF9saW5rLnJlcGxhY2UoL1xcXFxcXHwvZywgJ3wnKTogbWF0Y2hlZF9saW5rO1xuXHRcdFx0Y29uc29sZS5sb2cobm9ybWFsX2xpbmspXG5cdFx0XHRsZXQgbGlua19tYXRjaCA9IG5vcm1hbF9saW5rLm1hdGNoKC8hXFxbXFxbKC4qPykoXFx8fFxcXVxcXSkvKTtcblx0XHRcdGxldCBsaW5rX3RleHQgPSBsaW5rX21hdGNoP2xpbmtfbWF0Y2hbMV06Jyc7XG5cblx0XHRcdGxldCBhbHRfbWF0Y2ggPSBtYXRjaGVkX2xpbmsubWF0Y2goLyFcXFtcXFsuKj8oXFx8KC4qPykpXFxdXFxdLyk7XG5cdFx0XHRsZXQgYWx0X3RleHQgPSBhbHRfbWF0Y2ggPyBhbHRfbWF0Y2hbMV0gOiAnJztcblx0XHRcdGxldCBhbHRfdGV4dF9saXN0ID0gYWx0X3RleHQuc3BsaXQoJ3wnKTtcblx0XHRcdGxldCBhbHRfdGV4dF93b19zaXplID0gJyc7XG5cdFx0XHRsZXQgbmV3X2FsdF90ZXh0ID0gJydcblx0XHRcdGZvciAobGV0IGFsdCBvZiBhbHRfdGV4dF9saXN0KXtcblx0XHRcdFx0aWYgKCEvXlxcZCskLy50ZXN0KGFsdCkgJiYgIS9eXFxzKiQvLnRlc3QoYWx0KSl7XG5cdFx0XHRcdFx0YWx0X3RleHRfd29fc2l6ZSA9IGFsdF90ZXh0X3dvX3NpemUgKyAnfCcgKyBhbHQ7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdG5ld19hbHRfdGV4dCA9IG5ld193aWR0aCE9MD9gJHthbHRfdGV4dF93b19zaXplfXwke25ld193aWR0aH1gOmFsdF90ZXh0X3dvX3NpemU7XG5cdFx0XHRuZXdfYWx0X3RleHQgPSBpbnRhYmxlID8gbmV3X2FsdF90ZXh0LnJlcGxhY2UoL1xcfC9nLCAnXFxcXHwnKTogbmV3X2FsdF90ZXh0O1xuXHRcdFx0bGV0IG5ld1dpa2lMaW5rID0gbGlua19tYXRjaD8gYCFbWyR7bGlua190ZXh0fSR7bmV3X2FsdF90ZXh0fV1dYDpgIVtbJHt0YXJnZXRfbmFtZX0ke25ld19hbHRfdGV4dH1dXWA7XG5cblx0XHRcdHJlc3VsdC5wdXNoKHtcblx0XHRcdFx0b2xkX2xpbms6bWF0Y2hlZF9saW5rLFxuXHRcdFx0XHRuZXdfbGluazpuZXdXaWtpTGluaywgXG5cdFx0XHRcdGZyb21fY2g6d2lraV9tYXRjaC5pbmRleCwgXG5cdFx0XHRcdHRvX2NoOndpa2lfbWF0Y2guaW5kZXgrbWF0Y2hlZF9saW5rLmxlbmd0aFxuXHRcdFx0fSk7XG5cdFx0fVxuXHR9XG5cblx0d2hpbGUodHJ1ZSl7XG5cdFx0bGV0IG1hdGNoID0gcmVnTWRMaW5rLmV4ZWMobGluZV90ZXh0KTtcblx0XHRpZiAoIW1hdGNoKSBicmVhaztcblx0XHRjb25zdCBtYXRjaGVkX2xpbmsgPSBtYXRjaFswXTtcblx0XHRpZiAobWF0Y2hlZF9saW5rLmluY2x1ZGVzKHRhcmdldF9uYW1lX21kbGluaykpe1xuXHRcdFx0Ly8gXHU2MjdFXHU1MjMwIG1hdGNoZWRfbGluayBcdTRFMkRcdTc2ODQgYWx0VGV4dFxuXHRcdFx0bGV0IGFsdF90ZXh0X21hdGNoID0gbWF0Y2hlZF9saW5rLm1hdGNoKC9cXFsuKj9cXF0vZykgYXMgc3RyaW5nW107XG5cdFx0XHRsZXQgYWx0X3RleHQgPSBhbHRfdGV4dF9tYXRjaFswXS5zdWJzdHJpbmcoMSwgYWx0X3RleHRfbWF0Y2hbMF0ubGVuZ3RoLTEpO1xuXHRcdFx0bGV0IHB1cmVfYWx0ID0gYWx0X3RleHQucmVwbGFjZSgvXFx8XFxkKyhcXHxcXGQrKT8kL2csICcnKTtcblx0XHRcdGlmIChpbnRhYmxlKXtcblx0XHRcdFx0cHVyZV9hbHQgPSBhbHRfdGV4dC5yZXBsYWNlKC9cXFxcXFx8XFxkKyhcXHxcXGQrKT8kL2csICcnKVxuXHRcdFx0fVxuXHRcdFx0bGV0IGxpbmtfdGV4dCA9IG1hdGNoZWRfbGluay5zdWJzdHJpbmcoYWx0X3RleHRfbWF0Y2hbMF0ubGVuZ3RoKzIsIG1hdGNoZWRfbGluay5sZW5ndGgtMSlcblx0XHRcdGxldCBuZXdNRExpbmsgPSBpbnRhYmxlID8gYCFbJHtwdXJlX2FsdH1cXFxcfCR7bmV3X3dpZHRofV0oJHtsaW5rX3RleHR9KWA6YCFbJHtwdXJlX2FsdH18JHtuZXdfd2lkdGh9XSgke2xpbmtfdGV4dH0pYDtcblx0XHRcdGlmICgvXlxcZCokLy50ZXN0KGFsdF90ZXh0KSl7XG5cdFx0XHRcdG5ld01ETGluayA9IGAhWyR7bmV3X3dpZHRofV0oJHtsaW5rX3RleHR9KWA7XG5cdFx0XHR9XG5cdFx0XHQvLyBsZXQgbmV3TGluZVRleHQgPSBsaW5lX3RleHQuc3Vic3RyaW5nKDAsIG1hdGNoLmluZGV4KSArIFxuXHRcdFx0Ly8gXHRcdFx0XHRcdG5ld01ETGluayArIFxuXHRcdFx0Ly8gXHRcdFx0XHRcdGxpbmVfdGV4dC5zdWJzdHJpbmcobWF0Y2guaW5kZXgrbWF0Y2hlZF9saW5rLmxlbmd0aCk7XG5cdFx0XHRyZXN1bHQucHVzaCh7XG5cdFx0XHRcdG9sZF9saW5rOm1hdGNoZWRfbGluayxcblx0XHRcdFx0bmV3X2xpbms6bmV3TURMaW5rLCBcblx0XHRcdFx0ZnJvbV9jaDptYXRjaC5pbmRleCwgXG5cdFx0XHRcdHRvX2NoOm1hdGNoLmluZGV4K21hdGNoZWRfbGluay5sZW5ndGhcblx0XHRcdH0pO1xuXHRcdH1cblx0fVxuXHRwcmludChcIkxpbmUgVGV4dDogXCIsIGxpbmVfdGV4dClcblx0cHJpbnQoXCJNYXRjaGVkSW5mbzpcIiwgcmVzdWx0KTtcblx0cmV0dXJuIHJlc3VsdDtcbn1cblxuXG5mdW5jdGlvbiBtYXRjaExpbmVXaXRoRXh0ZXJuYWxMaW5rKGxpbmVfdGV4dDogc3RyaW5nLCBsaW5rOiBzdHJpbmcsIGFsdF90ZXh0OiBzdHJpbmcsIG5ld193aWR0aDogbnVtYmVyLCBpbnRhYmxlOiBib29sZWFuKTogTWF0Y2hlZExpbmtJbkxpbmVbXVxue1xuXHRsZXQgcmVzdWx0OiBNYXRjaGVkTGlua0luTGluZVtdID0gW11cblx0bGV0IHJlZ01kTGluayA9IC9cXCFcXFtbXlxcW1xcXV0qP1xcXVxcKFteXFxzXFwpXFwoXFxbXFxdXFx7XFx9J10qXFwpL2c7XG5cdGlmICghbGluZV90ZXh0LmluY2x1ZGVzKGxpbmspIHx8ICFsaW5lX3RleHQuaW5jbHVkZXMoYWx0X3RleHQpKSByZXR1cm4gW107XG5cdGxldCBuZXdFeHRlcm5hbExpbmsgPSBpbnRhYmxlID8gXG5cdFx0YCFbJHthbHRfdGV4dH1cXFxcfCR7bmV3X3dpZHRofV0oJHtsaW5rfSlgIDogXG5cdFx0YCFbJHthbHRfdGV4dH18JHtuZXdfd2lkdGh9XSgke2xpbmt9KWA7XG5cdGlmICgvXlxcZCokLy50ZXN0KGFsdF90ZXh0KSB8fCAvXlxccyokLy50ZXN0KGFsdF90ZXh0KSl7XG5cdFx0bmV3RXh0ZXJuYWxMaW5rID0gYCFbJHtuZXdfd2lkdGh9XSgke2xpbmt9KWA7XG5cdH1cblx0d2hpbGUodHJ1ZSl7XG5cdFx0bGV0IG1hdGNoID0gcmVnTWRMaW5rLmV4ZWMobGluZV90ZXh0KTtcblx0XHRpZiAoIW1hdGNoKSBicmVhaztcblx0XHRsZXQgbWF0Y2hlZF9saW5rID0gbWF0Y2hbMF07XG5cdFx0aWYgKG1hdGNoZWRfbGluay5pbmNsdWRlcyhsaW5rKSAmJiBtYXRjaGVkX2xpbmsuaW5jbHVkZXMoYWx0X3RleHQpKXtcblx0XHRcdC8vIGxldCBuZXdMaW5lVGV4dCA9IGxpbmVfdGV4dC5zdWJzdHJpbmcoMCwgbWF0Y2guaW5kZXgpICsgXG5cdFx0XHQvLyBcdFx0XHRcdFx0bmV3RXh0ZXJuYWxMaW5rICsgXG5cdFx0XHQvLyBcdFx0XHRcdFx0bGluZV90ZXh0LnN1YnN0cmluZyhtYXRjaC5pbmRleCttYXRjaGVkX2xpbmsubGVuZ3RoKTtcblx0XHRcdHJlc3VsdC5wdXNoKHtcblx0XHRcdFx0b2xkX2xpbms6bWF0Y2hlZF9saW5rLCBcblx0XHRcdFx0bmV3X2xpbms6IG5ld0V4dGVybmFsTGluaywgXG5cdFx0XHRcdGZyb21fY2g6bWF0Y2guaW5kZXgsIFxuXHRcdFx0XHR0b19jaDptYXRjaC5pbmRleCttYXRjaGVkX2xpbmsubGVuZ3RoXG5cdFx0XHR9KTtcblx0XHR9XG5cdH1cblx0cHJpbnQoXCJMaW5lIFRleHQ6IFwiLCBsaW5lX3RleHQpXG5cdHByaW50KFwiTWF0Y2hlZEluZm86XCIsIHJlc3VsdCk7XG5cdHJldHVybiByZXN1bHQ7XG59XG4iLCAiaW1wb3J0IHsgTm90aWNlLCBURmlsZSwgVEZvbGRlciB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHsgZ2V0RmlsZVBhcmVudEZvbGRlciB9IGZyb20gXCJzcmMvdXRpbFwiO1xuaW1wb3J0IHsgZGVsZXRlRmlsZSB9IGZyb20gXCJzcmMvdXRpbHMvZGVsZXRlRmlsZVwiO1xuaW1wb3J0IEF0dGFjaEZsb3dQbHVnaW4gZnJvbSBcIi4uLy4uL3NyYy9tYWluXCI7XG4vKipcbiAqIGRlbEFsbEF0dGFjaHNCeUNvbW1hbmRcbiAqXG4gKiAxLiBnZXQgY3VycmVudCBmaWxlXG4gKiAyLiBnZXQgVEZpbGUgb2YgdGhlIGF0dGFjaG1lbnQgcmVmZXJlbmNlZCBieSBmaWxlXG4gKi9cbmV4cG9ydCBjb25zdCBkZWxldGVBbGxBdHRhY2hzID0gYXN5bmMgKHBsdWdpbjogQXR0YWNoRmxvd1BsdWdpbikgPT4ge1xuXHQvLyAxLiBnZXQgY3VycmVudCBmaWxlXG5cdGNvbnN0IGFjdGl2ZU1kOiBURmlsZSA9IGFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpIGFzIFRGaWxlO1xuXHRjb25zdCByZXNvbHZlZExpbmtzID0gYXBwLm1ldGFkYXRhQ2FjaGUucmVzb2x2ZWRMaW5rcztcblx0Y29uc3QgYXR0YWNoc1BhdGhzOiBzdHJpbmdbXSA9IFtdO1xuXHRmb3IgKGNvbnN0IFttZEZpbGUsIGxpbmtzXSBvZiBPYmplY3QuZW50cmllcyhyZXNvbHZlZExpbmtzKSkge1xuXHRcdGlmIChhY3RpdmVNZD8ucGF0aCA9PT0gbWRGaWxlKSB7XG5cdFx0XHRsZXQgZmlsZUNvdW50ID0gMDtcblx0XHRcdGxldCBmbGFnID0gZmFsc2U7XG5cdFx0XHRmb3IgKGNvbnN0IFtmaWxlUGF0aCwgbnJdIG9mIE9iamVjdC5lbnRyaWVzKGxpbmtzKSkge1xuXHRcdFx0XHQvLyBJZiB0aGUgZmlsZVBhdGggZW5kcyB3aXRoICcubWQnICx3aGljaCBpbmRpY2F0ZXMgdGhlIGZpbGUgaXMgbWFya2Rvd24gZmlsZSwgYW5kIGRvIG5vdCBkZWxldGUgaXRcblx0XHRcdFx0aWYgKGZpbGVQYXRoLm1hdGNoKC8uKlxcLm1kJC9tKSkgY29udGludWU7XG5cdFx0XHRcdC8vIGlmIHRoZSBhdHRhY2htZW50IGluIHRoZSBub3RlIGhhcyBiZWVuIHJlZmVyZW5jZWQgYnkgb3RoZXIgbm90ZXMgIHNpbXVsdGFuZW91c2x5IHNraXAgaXQuXG5cdFx0XHRcdGlmIChpc1JlZmVyZW5jZWRCeU90aGVyTm90ZXMoZmlsZVBhdGgsIGFjdGl2ZU1kKSkgY29udGludWU7XG5cdFx0XHRcdGF0dGFjaHNQYXRocy5wdXNoKGZpbGVQYXRoKTtcblx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHQvLyAyLiBnZXQgVEZpbGUgb2YgdGhlIGF0dGFjaG1lbnQgcmVmZXJlbmNlZCBieSBmaWxlXG5cdFx0XHRcdFx0Y29uc3QgQXR0YWNoRmlsZTogVEZpbGUgPSBhcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKFxuXHRcdFx0XHRcdFx0ZmlsZVBhdGhcblx0XHRcdFx0XHQpIGFzIFRGaWxlO1xuXHRcdFx0XHRcdGlmIChBdHRhY2hGaWxlIGluc3RhbmNlb2YgVEZpbGUpIHtcblx0XHRcdFx0XHRcdGRlbGV0ZUZpbGUoQXR0YWNoRmlsZSwgcGx1Z2luKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0Y29uc3QgcGFyZW50Rm9sZGVyID0gZ2V0RmlsZVBhcmVudEZvbGRlcihcblx0XHRcdFx0XHRcdEF0dGFjaEZpbGVcblx0XHRcdFx0XHQpIGFzIFRGb2xkZXI7XG5cdFx0XHRcdFx0aWYgKCFmbGFnKSB7XG5cdFx0XHRcdFx0XHRmaWxlQ291bnQgPSBwYXJlbnRGb2xkZXIuY2hpbGRyZW4ubGVuZ3RoO1xuXHRcdFx0XHRcdFx0ZmxhZyA9ICFmbGFnO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRmaWxlQ291bnQgPSBmaWxlQ291bnQgLSAxO1xuXHRcdFx0XHRcdGlmICghZmlsZUNvdW50KSB7XG5cdFx0XHRcdFx0XHRhd2FpdCBkZWxldGVGaWxlKHBhcmVudEZvbGRlciwgcGx1Z2luKTtcblx0XHRcdFx0XHRcdC8vIGF3YWl0IGFwcC52YXVsdC5kZWxldGUocGFyZW50Rm9sZGVyLCB0cnVlKTtcblx0XHRcdFx0XHRcdG5ldyBOb3RpY2UoXG5cdFx0XHRcdFx0XHRcdFwiQWxsIGF0dGFjaG1lbnRzIGFuZCBpdHMgcGFyZW50IGZvbGRlciBkZWxldGVkIVwiLFxuXHRcdFx0XHRcdFx0XHQzMDAwXG5cdFx0XHRcdFx0XHQpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdFx0XHRjb25zb2xlLndhcm4oZXJyb3IpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cdC8vIHJlbW92ZUFsbFVudXNlZFJlZmVyZW5jZUxpbmtzKGFjdGl2ZU1kLCBhdHRhY2hzUGF0aHMpO1xufTtcbi8qKlxuICpcbiAqIEBwYXJhbSBhdHRhY2hQYXRoXG4gKiBAcGFyYW0gY3VycmVudE1kXG4gKiBAcmV0dXJuc1xuICovXG5jb25zdCBpc1JlZmVyZW5jZWRCeU90aGVyTm90ZXMgPSAoXG5cdGF0dGFjaFBhdGg6IHN0cmluZyxcblx0Y3VycmVudE1kOiBURmlsZVxuKTogYm9vbGVhbiA9PiB7XG5cdGNvbnN0IHJlc29sdmVkTGlua3MgPSBhcHAubWV0YWRhdGFDYWNoZS5yZXNvbHZlZExpbmtzO1xuXHRsZXQgZmxhZzogYm9vbGVhbiA9IGZhbHNlO1xuXG5cdGZvciAoY29uc3QgW21kRmlsZSwgbGlua3NdIG9mIE9iamVjdC5lbnRyaWVzKHJlc29sdmVkTGlua3MpKSB7XG5cdFx0aWYgKG1kRmlsZSAhPT0gY3VycmVudE1kLnBhdGgpIHtcblx0XHRcdGZvciAoY29uc3QgW2ZpbGVQYXRoLCBucl0gb2YgT2JqZWN0LmVudHJpZXMobGlua3MpKSB7XG5cdFx0XHRcdGlmIChmaWxlUGF0aCA9PT0gYXR0YWNoUGF0aCkge1xuXHRcdFx0XHRcdGZsYWcgPSB0cnVlO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cdHJldHVybiBmbGFnO1xufTtcblxuLyoqXG4gKiBSZW1vdmUgYWxsIHJlZmVyZW5jZSBsaW5rc1xuICpcbiAqIEBwYXJhbSBpbWFnZVBhdGhzICBwYXRoICBsaXN0ICBvZiB0aGUgY3VycmVudCBkZWxldGVkIGltYWdlIHdpdGhvdXQgc3VicGF0aCxmb3JtYXQgYXMgIG5hbWUuZXh0ZW5zaW9uXG4gKiBAcGFyYW0gbWRGaWxlICB0aGUgbWFya2Rvd24gZmlsZSBjb250YWluaW5nIHRoZSBkZWxldGVkIGltYWdlXG4gKi9cbmV4cG9ydCBjb25zdCByZW1vdmVBbGxVbnVzZWRSZWZlcmVuY2VMaW5rcyA9IGFzeW5jIChcblx0YWN0aXZlTWQ6IFRGaWxlLFxuXHRhdHRhY2hzUGF0aHM6IHN0cmluZ1tdXG4pID0+IHtcblx0Ly8gMS5nZXQgcGF0aCBsaXN0IG9mIGFsbCB1bnVzZWQgYXR0YWNobWVudHNcblx0Y29uc3Qgb3JpZ2luQ29udGVudHMgPSBhd2FpdCBhcHAudmF1bHQucmVhZChhY3RpdmVNZCk7XG5cdGNvbnN0IGxpbmVzID0gb3JpZ2luQ29udGVudHMuc3BsaXQoXCJcXG5cIik7XG5cdGNvbnN0IG5ld0NvbnRlbnRzOiBzdHJpbmdbXSA9IFtdO1xuXHRsZXQgaXNOb3RUYXJnZXRMaW5lOiBib29sZWFuID0gdHJ1ZTtcblxuXHQvLyAyLiBjbGVhciBhbGwgdW51c2VkIGF0dGFjaG1lbnRzIGxpbmtzIGluIHRoZSBub3RlXG5cdC8vIEVzY2FwZSAuIHRvIFxcLiBmb3IgcmVndWxhciBleHByZXNpb25cblx0Zm9yIChjb25zdCBsaW5lIG9mIGxpbmVzKSB7XG5cdFx0Zm9yIChjb25zdCBpbmRleCBpbiBhdHRhY2hzUGF0aHMpIHtcblx0XHRcdGNvbnN0IHJlZ01kUmVmTGluayA9IG5ldyBSZWdFeHAoXG5cdFx0XHRcdFwiIVxcXFxbKC4qKT9cXFxcXVxcXFwoKCguKlxcXFwvKSspP1wiICsgYXR0YWNoc1BhdGhzW2luZGV4XSArIFwiXFxcXClcIixcblx0XHRcdFx0XCJnbVwiXG5cdFx0XHQpO1xuXHRcdFx0Y29uc3QgcmVnV2lraVJlZkxpbmsyID0gbmV3IFJlZ0V4cChcblx0XHRcdFx0XCIhXFxcXFtcXFxcWy4qP1wiICsgYXR0YWNoc1BhdGhzW2luZGV4XSArIFwiKFxcXFx8XFxcXGQqKT9cXFxcXVxcXFxdXCIsXG5cdFx0XHRcdFwiZ21cIlxuXHRcdFx0KTtcblx0XHRcdGNvbnN0IGRlY29kZUxpbmUgPSBkZWNvZGVVUkkobGluZSk7XG5cdFx0XHRjb25zdCBpc0luY2x1ZGVJbWFnZSA9IGRlY29kZUxpbmUuaW5jbHVkZXMoYXR0YWNoc1BhdGhzW2luZGV4XSk7XG5cdFx0XHRjb25zdCBpc01hcmtkb3duU3R5bGUgPSBkZWNvZGVMaW5lLm1hdGNoKHJlZ01kUmVmTGluaykgIT0gbnVsbDtcblx0XHRcdGNvbnN0IGlzV2lraVN0eWxlID0gZGVjb2RlTGluZS5tYXRjaChyZWdXaWtpUmVmTGluazIpICE9IG51bGw7XG5cdFx0XHRpZiAoaXNJbmNsdWRlSW1hZ2UgJiYgaXNNYXJrZG93blN0eWxlKSB7XG5cdFx0XHRcdGlzTm90VGFyZ2V0TGluZSA9IGZhbHNlO1xuXHRcdFx0XHRuZXdDb250ZW50cy5wdXNoKGRlY29kZUxpbmUucmVwbGFjZShyZWdNZFJlZkxpbmssIFwiXCIpKTtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHR9IGVsc2UgaWYgKGlzSW5jbHVkZUltYWdlICYmIGlzV2lraVN0eWxlKSB7XG5cdFx0XHRcdGlzTm90VGFyZ2V0TGluZSA9IGZhbHNlO1xuXHRcdFx0XHRuZXdDb250ZW50cy5wdXNoKGRlY29kZUxpbmUucmVwbGFjZShyZWdXaWtpUmVmTGluazIsIFwiXCIpKTtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRjb250aW51ZTtcblx0XHRcdH1cblx0XHR9XG5cdFx0aWYgKGlzTm90VGFyZ2V0TGluZSkgbmV3Q29udGVudHMucHVzaChsaW5lKTtcblx0fVxuXHRhcHAudmF1bHQuYWRhcHRlci53cml0ZShhY3RpdmVNZC5wYXRoLCBuZXdDb250ZW50cy5qb2luKFwiXFxuXCIpKTtcbn07XG5leHBvcnQgY29uc3QgZ2V0UmVmZW5jZWRMaW5rQ291bnQgPSAoKTogbnVtYmVyID0+IHtcblx0Y29uc3QgYWN0aXZlTWQ6IFRGaWxlID0gYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCkgYXMgVEZpbGU7XG5cdGNvbnN0IHJlc29sdmVkTGlua3MgPSBhcHAubWV0YWRhdGFDYWNoZS5yZXNvbHZlZExpbmtzO1xuXHRjb25zdCBhdHRhY2hzUGF0aHM6IHN0cmluZ1tdID0gW107XG5cdGZvciAoY29uc3QgW21kRmlsZSwgbGlua3NdIG9mIE9iamVjdC5lbnRyaWVzKHJlc29sdmVkTGlua3MpKSB7XG5cdFx0aWYgKGFjdGl2ZU1kPy5wYXRoID09PSBtZEZpbGUpIHtcblx0XHRcdGZvciAoY29uc3QgW2ZpbGVQYXRoLCBucl0gb2YgT2JqZWN0LmVudHJpZXMobGlua3MpKSB7XG5cdFx0XHRcdGlmIChmaWxlUGF0aC5tYXRjaCgvLipcXC5tZCQvbSkpIGNvbnRpbnVlO1xuXHRcdFx0XHRpZiAoaXNSZWZlcmVuY2VkQnlPdGhlck5vdGVzKGZpbGVQYXRoLCBhY3RpdmVNZCkpIGNvbnRpbnVlO1xuXHRcdFx0XHRhdHRhY2hzUGF0aHMucHVzaChmaWxlUGF0aCk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cdHJldHVybiBhdHRhY2hzUGF0aHMubGVuZ3RoO1xufTtcbiIsICJpbXBvcnQgQXR0YWNoRmxvd1BsdWdpbiBmcm9tIFwic3JjL21haW5cIjtcbmltcG9ydCB7IFRGaWxlLCBOb3RpY2UsIFRGb2xkZXIsIE1hcmtkb3duVmlldywgRWRpdG9yfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IGltYWdlUmVmZXJlbmNlZFN0YXRlIH0gZnJvbSBcIi4vZW51bS9pbWFnZVJlZmVyZW5jZWRTdGF0ZVwiO1xuaW1wb3J0IHsgcmVzdWx0RGV0ZXJtaW5lSW1hZ2VEZWxldGlvbiBhcyBkZWxldGlvblJlc3VsdCB9IGZyb20gXCIuL2ludGVyZmFjZS9yZXN1bHREZXRlcm1pbmVJbWFnZURlbGV0aW9uXCI7XG5pbXBvcnQgKiBhcyBmcyBmcm9tICdmcyc7XG5pbXBvcnQgeyBleGVjLCBleGVjU3luYyB9IGZyb20gJ2NoaWxkX3Byb2Nlc3MnO1xuaW1wb3J0IHsgZXhpc3RzU3luYyB9IGZyb20gJ2ZzJztcbmltcG9ydCB7XG5cdEVsZWN0cm9uV2luZG93LCBGaWxlU3lzdGVtQWRhcHRlcldpdGhJbnRlcm5hbEFwaSxcblx0bG9hZEltYWdlQmxvYiwgQXBwV2l0aERlc2t0b3BJbnRlcm5hbEFwaSwgRWRpdG9ySW50ZXJuYWxBcGlcbiAgfSBmcm9tIFwiLi9oZWxwZXJzXCJcbmltcG9ydCB7IEFwcCwgTW9kYWwsIFNldHRpbmcgfSBmcm9tIFwib2JzaWRpYW5cIjtcblxuZXhwb3J0IGxldCBERUJVRzpib29sZWFuID0gZmFsc2U7XG5jb25zdCBTVUNDRVNTX05PVElDRV9USU1FT1VUID0gMTgwMDtcblxuZXhwb3J0IGNvbnN0IHByaW50PShtZXNzYWdlPzogYW55LCAuLi5vcHRpb25hbFBhcmFtczogYW55W10pID0+e1xuICAgIGlmIChERUJVRykge1xuICAgICAgICBjb25zb2xlLmxvZyhtZXNzYWdlLCAuLi5vcHRpb25hbFBhcmFtcyk7XG4gICAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gc2V0RGVidWcodmFsdWU6IGJvb2xlYW4pIHtcbiAgICBERUJVRyA9IHZhbHVlO1xufVxuXG4vKipcbiAqXG4gKiBAcGFyYW0gdGFyZ2V0X2ZpbGUgXHU4OTgxXHU1MjIwXHU5NjY0XHU3Njg0XHU3NkVFXHU2ODA3XHU2NTg3XHU0RUY2XG4gKiBAcGFyYW0gY3VycmVudE1kXHRcdTVGNTNcdTUyNERcdTYyNDBcdTU3MjhcdTc2ODQgbWFya2Rvd24gXHU2NTg3XHU0RUY2XG4gKiBAcmV0dXJuc1xuICovXG5leHBvcnQgY29uc3QgY2hlY2tSZWZlcmVuY2VJbmZvID0gKFxuXHR0YXJnZXRfZmlsZTogVEZpbGUsXG5cdGN1cnJlbnRNZDogVEZpbGVcbik6IHsgc3RhdGU6IG51bWJlcjsgbWRQYXRoOiBzdHJpbmdbXSB9ID0+IHtcblxuXHRjb25zdCByZXNvbHZlZExpbmtzID0gYXBwLm1ldGFkYXRhQ2FjaGUucmVzb2x2ZWRMaW5rcztcblx0bGV0IEN1ck1EUGF0aDogc3RyaW5nO1xuXHQvLyAvLyByZWNvcmQgdGhlIHN0YXRlIG9mIGltYWdlIHJlZmVyZW5jZWQgYW5kIGFsbCBwYXRocyBvZiBtYXJrZG93biByZWZlcmVuY2luZyB0byB0aGUgaW1hZ2Vcblx0bGV0IHJlc3VsdDogZGVsZXRpb25SZXN1bHQgPSB7XG5cdFx0c3RhdGU6IDAsXG5cdFx0bWRQYXRoOiBbXSxcblx0fTtcblx0bGV0IHJlZk51bSA9IDA7IC8vIHJlY29yZCB0aGUgbnVtYmVyIG9mIG5vdGUgcmVmZXJlbmNpbmcgdG8gdGhlIGltYWdlLlxuXHRmb3IgKGNvbnN0IFttZEZpbGUsIGxpbmtzXSBvZiBPYmplY3QuZW50cmllcyhyZXNvbHZlZExpbmtzKSkge1xuXHRcdGlmIChjdXJyZW50TWQucGF0aCA9PT0gbWRGaWxlKSB7XG5cdFx0XHRDdXJNRFBhdGggPSBjdXJyZW50TWQucGF0aDtcblx0XHRcdHJlc3VsdC5tZFBhdGgudW5zaGlmdChDdXJNRFBhdGgpO1xuXHRcdH1cblx0XHRmb3IgKGNvbnN0IFtmaWxlUGF0aCwgbnJdIG9mIE9iamVjdC5lbnRyaWVzKGxpbmtzKSkge1xuXHRcdFx0aWYgKHRhcmdldF9maWxlPy5wYXRoID09PSBmaWxlUGF0aCkge1xuXHRcdFx0XHRyZWZOdW0rKztcblx0XHRcdFx0Ly8gaWYgdGhlIGRlbGV0ZWQgdGFyZ2V0IGltYWdlIHJlZmVyZW5jZWQgYnkgY3VycmVudCBub3RlIG1vcmUgdGhhbiBvbmNlXG5cdFx0XHRcdGlmIChuciA+IDEpIHtcblx0XHRcdFx0XHRyZXN1bHQuc3RhdGUgPSBpbWFnZVJlZmVyZW5jZWRTdGF0ZS5NT1JFO1xuXHRcdFx0XHRcdHJlc3VsdC5tZFBhdGgucHVzaChtZEZpbGUpO1xuXHRcdFx0XHRcdHJldHVybiByZXN1bHQ7XG5cdFx0XHRcdH1cblx0XHRcdFx0cmVzdWx0Lm1kUGF0aC5wdXNoKG1kRmlsZSk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cdGlmIChyZWZOdW0gPiAxKSB7XG5cdFx0cmVzdWx0LnN0YXRlID0gaW1hZ2VSZWZlcmVuY2VkU3RhdGUuTVVUSVBMRTtcblx0fSBlbHNlIHtcblx0XHRyZXN1bHQuc3RhdGUgPSBpbWFnZVJlZmVyZW5jZWRTdGF0ZS5PTkNFO1xuXHR9XG5cdHJldHVybiByZXN1bHQ7XG59O1xuXG5cbi8qKlxuICogXHRcdTkwMUFcdThGQzdcdTVGNTNcdTUyNERtZFx1NjU4N1x1NEVGNlx1NTQ4Q1x1NTZGRVx1NzI0N1x1NTQwRCBcdTgzQjdcdTUzRDYgXHU1NkZFXHU3MjQ3XHU2NTg3XHU0RUY2XHU1QkY5XHU4QzYxICAgXHVGRjBDXHU3QzdCXHU1NzhCXHU0RTNBVEZpbGVcbiAqIFxuXHRAcGFyYW0gY3VycmVudE1kICBcdTVGNTNcdTUyNERcdTk3MDBcdTg5ODFcdTg4QUJcdTUyMjBcdTk2NjRcdTc2ODRjdXJNZFx1NjI0MFx1NTcyOFx1NzY4NG1hcmtkb3duXHU2NTg3XHU0RUY2XG5cdEBwYXJhbSBGaWxlQmFzZU5hbWUgIFx1NUY1M1x1NTI0RFx1OTcwMFx1ODk4MVx1ODhBQlx1NTIyMFx1OTY2NFx1NzY4NGN1ck1kXHU1NDBEIG5hbWUuZXh0ZW5zaW9uXG4gKiAgQHJldHVybnMgIEF0dGFjaEZpbGVcbiAqL1xuZXhwb3J0IGNvbnN0IGdldEZpbGVCeUJhc2VOYW1lID0gKFxuXHRjdXJyZW50TWQ6IFRGaWxlLFxuXHRGaWxlQmFzZU5hbWU6IHN0cmluZ1xuKTogVEZpbGUgfCB1bmRlZmluZWQgPT4ge1xuXHRjb25zdCByZXNvbHZlZExpbmtzID0gYXBwLm1ldGFkYXRhQ2FjaGUucmVzb2x2ZWRMaW5rcztcblx0Zm9yIChjb25zdCBbbWRGaWxlLCBsaW5rc10gb2YgT2JqZWN0LmVudHJpZXMocmVzb2x2ZWRMaW5rcykpIHtcblx0XHRpZiAoY3VycmVudE1kLnBhdGggPT09IG1kRmlsZSkge1xuXHRcdFx0Zm9yIChjb25zdCBbZmlsZVBhdGgsIG5yXSBvZiBPYmplY3QuZW50cmllcyhsaW5rcykpIHtcblx0XHRcdFx0Ly8gcHJpbnQoJ2ZpbGVQYXRoJywgZmlsZVBhdGgpXG5cdFx0XHRcdC8vIHByaW50KEZpbGVCYXNlTmFtZSlcblx0XHRcdFx0aWYgKGZpbGVQYXRoLmluY2x1ZGVzKEZpbGVCYXNlTmFtZSkpIHtcblx0XHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdFx0Y29uc3QgQXR0YWNoRmlsZTogVEZpbGUgPVxuXHRcdFx0XHRcdFx0XHRhcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGZpbGVQYXRoKSBhcyBURmlsZTtcblx0XHRcdFx0XHRcdGlmIChBdHRhY2hGaWxlIGluc3RhbmNlb2YgVEZpbGUpIHtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIEF0dGFjaEZpbGU7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdFx0XHRcdG5ldyBOb3RpY2UoYCBjYW5ub3QgZ2V0IHRoZSBpbWFnZSBmaWxlYCk7XG5cdFx0XHRcdFx0XHRjb25zb2xlLmVycm9yKGVycm9yKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdH1cbn07XG5cbi8qKlxuICogXHU1MjIwXHU5NjY0XHU2MzA3XHU1QjlBXHU5NjQ0XHU0RUY2XHU2NTg3XHU0RUY2XG4gKlxuICogQHBhcmFtIGZpbGUgIFx1NjMwN1x1NUI5QVx1NzY4NFx1OTY0NFx1NEVGNlx1NjU4N1x1NEVGNlxuICogQHBhcmFtIHBsdWdpbiBcdTVGNTNcdTUyNERcdTYzRDJcdTRFRjZcbiAqIEByZXR1cm5zXG4gKi9cbmV4cG9ydCBjb25zdCBQdXJlQ2xlYXJBdHRhY2htZW50ID0gYXN5bmMgKFxuXHRmaWxlOiBURmlsZSxcblx0dGFyZ2V0X3R5cGU6IHN0cmluZyxcblx0cGx1Z2luOiBBdHRhY2hGbG93UGx1Z2luXG4pID0+IHtcblx0Y29uc3QgZGVsZXRlT3B0aW9uID0gcGx1Z2luLnNldHRpbmdzLmRlbGV0ZU9wdGlvbjtcblx0Y29uc3QgZGVsRmlsZUZvbGRlciA9IG9ubHlPbmVGaWxlRXhpc3RzKGZpbGUpO1xuXHRjb25zdCBmaWxlRm9sZGVyID0gZ2V0RmlsZVBhcmVudEZvbGRlcihmaWxlKSBhcyBURm9sZGVyO1xuXHRsZXQgbmFtZSA9IHRhcmdldF90eXBlPT0naW1nJyA/ICdJbWFnZScgOiAnRmlsZSc7XG5cdHRyeSB7XG5cdFx0aWYgKGRlbGV0ZU9wdGlvbiA9PT0gXCIudHJhc2hcIikge1xuXHRcdFx0YXdhaXQgYXBwLnZhdWx0LnRyYXNoKGZpbGUsIGZhbHNlKTtcblx0XHRcdG5ldyBOb3RpY2UoXG5cdFx0XHRcdG5hbWUgKyBcIiBtb3ZlZCB0byBPYnNpZGlhbiBUcmFzaCAhXCIsXG5cdFx0XHRcdFNVQ0NFU1NfTk9USUNFX1RJTUVPVVRcblx0XHRcdCk7XG5cdFx0XHRpZiAoZGVsRmlsZUZvbGRlcikge1xuXHRcdFx0XHRhd2FpdCBhcHAudmF1bHQudHJhc2goZmlsZUZvbGRlciwgZmFsc2UpO1xuXHRcdFx0XHRuZXcgTm90aWNlKFwiQXR0YWNobWVudCBmb2xkZXIgaGF2ZSBiZWVuIGRlbGV0ZWQhXCIsIDMwMDApO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSBpZiAoZGVsZXRlT3B0aW9uID09PSBcInN5c3RlbS10cmFzaFwiKSB7XG5cdFx0XHRhd2FpdCBhcHAudmF1bHQudHJhc2goZmlsZSwgdHJ1ZSk7XG5cdFx0XHRuZXcgTm90aWNlKG5hbWUgKyBcIiBtb3ZlZCB0byBTeXN0ZW0gVHJhc2ggIVwiLCBTVUNDRVNTX05PVElDRV9USU1FT1VUKTtcblx0XHRcdGlmIChkZWxGaWxlRm9sZGVyKSB7XG5cdFx0XHRcdGF3YWl0IGFwcC52YXVsdC50cmFzaChmaWxlRm9sZGVyLCB0cnVlKTtcblx0XHRcdFx0bmV3IE5vdGljZShcIkF0dGFjaG1lbnQgZm9sZGVyIGhhdmUgYmVlbiBkZWxldGVkIVwiLCAzMDAwKTtcblx0XHRcdH1cblx0XHR9IGVsc2UgaWYgKGRlbGV0ZU9wdGlvbiA9PT0gXCJwZXJtYW5lbnRcIikge1xuXHRcdFx0YXdhaXQgYXBwLnZhdWx0LmRlbGV0ZShmaWxlKTtcblx0XHRcdG5ldyBOb3RpY2UobmFtZSArIFwiIGRlbGV0ZWQgUGVybWFuZW50bHkgIVwiLCBTVUNDRVNTX05PVElDRV9USU1FT1VUKTtcblx0XHRcdGlmIChkZWxGaWxlRm9sZGVyKSB7XG5cdFx0XHRcdGF3YWl0IGFwcC52YXVsdC5kZWxldGUoZmlsZUZvbGRlciwgdHJ1ZSk7XG5cdFx0XHRcdG5ldyBOb3RpY2UoXCJBdHRhY2htZW50IGZvbGRlciBoYXZlIGJlZW4gZGVsZXRlZCFcIiwgMzAwMCk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9IGNhdGNoIChlcnJvcikge1xuXHRcdGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuXHRcdG5ldyBOb3RpY2UoXCJGYWlsZCB0byBkZWxlbHRlIHRoZSBcIiArIG5hbWUgKyBcIiFcIiwgU1VDQ0VTU19OT1RJQ0VfVElNRU9VVCk7XG5cdH1cbn07XG5cblxuZXhwb3J0IGNvbnN0IGhhbmRsZXJEZWxGaWxlTmV3ID0gKFxuXHRGaWxlQmFzZU5hbWU6IHN0cmluZyxcblx0Y3VycmVudE1kOiBURmlsZSxcblx0cGx1Z2luOiBBdHRhY2hGbG93UGx1Z2luLFxuXHR0YXJnZXRfdHlwZTogc3RyaW5nLFxuXHR0YXJnZXRfcG9zOiBudW1iZXIsXG5cdGluX3RhYmxlOiBib29sZWFuLFxuXHRpbl9jYWxsb3V0OiBib29sZWFuXG4pID0+IHtcblx0bGV0IGxvZ3M6IHN0cmluZ1tdO1xuXHRsZXQgbW9kYWw7XG5cdGNvbnN0IHRhcmdldF9maWxlID0gZ2V0RmlsZUJ5QmFzZU5hbWUoY3VycmVudE1kLCBGaWxlQmFzZU5hbWUpIGFzIFRGaWxlO1xuXHRjb25zdCByZWZJbmZvID0gY2hlY2tSZWZlcmVuY2VJbmZvKHRhcmdldF9maWxlLCBjdXJyZW50TWQpO1xuXHRsZXQgc3RhdGUgPSByZWZJbmZvLnN0YXRlO1xuXHRzd2l0Y2ggKHN0YXRlKSB7XG5cdFx0Y2FzZSAwOlxuXHRcdFx0Ly8gY2xlYXIgYXR0YWNobWVudCBkaXJlY3RseVxuXHRcdFx0ZGVsZXRlQ3VyVGFyZ2V0TGluayhGaWxlQmFzZU5hbWUsIHBsdWdpbiwgdGFyZ2V0X3R5cGUsIHRhcmdldF9wb3MsIGluX3RhYmxlLCBpbl9jYWxsb3V0KTtcblx0XHRcdFB1cmVDbGVhckF0dGFjaG1lbnQodGFyZ2V0X2ZpbGUsIHRhcmdldF90eXBlLCBwbHVnaW4pO1xuXHRcdFx0YnJlYWs7XG5cdFx0Y2FzZSAxOlxuXHRcdGNhc2UgMjpcblx0XHRcdGRlbGV0ZUN1clRhcmdldExpbmsoRmlsZUJhc2VOYW1lLCBwbHVnaW4sIHRhcmdldF90eXBlLCB0YXJnZXRfcG9zLCBpbl90YWJsZSwgaW5fY2FsbG91dCk7XG5cdFx0XHQvLyByZWZlcmVuY2VkIGJ5IGVpdGhvciBvbmx5IG5vdGUgb3Igb3RoZXIgbXV0aXBsZSBub3RlcyBtb3JlIHRoYW4gb25jZVxuXHRcdFx0bG9ncyA9IHJlZkluZm8ubWRQYXRoIGFzIHN0cmluZ1tdO1xuXHRcdFx0Ly8gXHU3NTMxXHU0RThFXHU2NzA5XHU1MjJCXHU3Njg0XHU1RjE1XHU3NTI4XHVGRjBDXHU2MjQwXHU0RUU1XHU1M0VBXHU1MjIwXHU5NjY0XHU1RjUzXHU1MjREXHU3Njg0XHU1RjE1XHU3NTI4XHU5NEZFXHU2M0E1XHU4MDBDXHU0RTBEXHU1MjIwXHU5NjY0XHU2NTg3XHU0RUY2XG5cdFx0XHRuZXcgTm90aWNlKFwiQXMgb3RoZXIgcmVmZXJlbmNlcyBvZiBjdXJyZW50IGZpbGUgZXhpc3QsIFwiICsgXG5cdFx0XHRcdFwianVzdCBkZWxldGVkIHRoZSBjdXJyZW50IHJlZmVyZW5jZSBsaW5rIHdpdGhvdXQgZGVsZXRpbmcgdGhlIGFjdHVhbCBmaWxlLlwiLCBcblx0XHRcdFx0MzUwMCk7XG5cdFx0ZGVmYXVsdDpcblx0XHRcdGJyZWFrO1xuXHR9XG59XG5cbi8vIFx1NTk4Mlx1Njc5Q1x1NjYyRiB0eXBlIFx1NjYyRiBcImltZ1wiXHVGRjBDXHU1QzMxXHU1MUM2XHU3ODZFXHU1MjIwXHU5NjY0XHU1NkZFXHU3MjQ3XHU1RjE1XHU3NTI4XHU5NEZFXHU2M0E1XHU3Njg0XHU5MEU4XHU1MjA2XHVGRjBDXHU1OTgyXHU2NzlDXHU2NjJGXHU1MTc2XHU0RUQ2XHU3QzdCXHU1NzhCXHVGRjBDXHU3NkY0XHU2M0E1XHU1MjIwXHU5NjY0XHU2NTc0XHU4ODRDXG4vLyB0YXJnZXRfbGluZSBcdUZGMDgxLWJhc2VkXHVGRjA5IFx1NTQ4QyB0YXJnZXRfY2ggXHU2NjJGXHU2MzA3XHU3OTNBXHU5NjQ0XHU0RUY2XHU2MjQwXHU1NzI4XHU3Njg0XHU0RjREXHU3RjZFXG5leHBvcnQgY29uc3QgZGVsZXRlQ3VyVGFyZ2V0TGluayA9IChcblx0ZmlsZV9iYXNlX25hbWU6IHN0cmluZyxcblx0cGx1Z2luOiBBdHRhY2hGbG93UGx1Z2luLFxuXHR0YXJnZXRfdHlwZTogc3RyaW5nLFxuXHR0YXJnZXRfcG9zOiBudW1iZXIsXG5cdGluX3RhYmxlOiBib29sZWFuLFxuXHRpbl9jYWxsb3V0OiBib29sZWFuXG4pID0+IHtcblx0ZmlsZV9iYXNlX25hbWUgPSBmaWxlX2Jhc2VfbmFtZS5zdGFydHNXaXRoKCcvJykgPyBmaWxlX2Jhc2VfbmFtZS5zdWJzdHJpbmcoMSk6ZmlsZV9iYXNlX25hbWU7XG5cdGNvbnN0IGFjdGl2ZVZpZXcgPSBwbHVnaW4uYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldykgYXMgTWFya2Rvd25WaWV3O1xuXHRjb25zdCBlZGl0b3IgPSBhY3RpdmVWaWV3LmVkaXRvcjtcblx0Ly8gIEB0cy1leHBlY3QtZXJyb3IsIG5vdCB0eXBlZFxuXHRjb25zdCBlZGl0b3JWaWV3ID0gZWRpdG9yLmNtIGFzIEVkaXRvclZpZXc7XG5cblx0bGV0IHRhcmdldF9saW5lID0gZWRpdG9yVmlldy5zdGF0ZS5kb2MubGluZUF0KHRhcmdldF9wb3MpO1xuXHRsZXQgbGluZV90ZXh0ID0gdGFyZ2V0X2xpbmUudGV4dDtcblxuXHRpZiAoIWluX3RhYmxlICYmICFpbl9jYWxsb3V0KXtcblx0XHRsZXQgZmluZHMgPSBmaW5kTGlua0luTGluZShmaWxlX2Jhc2VfbmFtZSwgbGluZV90ZXh0KTtcblx0XHRpZiAoZmluZHMubGVuZ3RoID09IDApe1xuXHRcdFx0bmV3IE5vdGljZShcIkZhaWwgdG8gZmluZCB0aGUgbGluay10ZXh0LCBwbGVhc2UgZGVsZXRlIGl0IG1hbnVhbGx5IVwiLCAwKTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0ZWxzZSBpZihmaW5kcy5sZW5ndGggIT0gMSl7XG5cdFx0XHRuZXcgTm90aWNlKFwiRmluZCBtdWx0aXBsZSBzYW1lIExpbmsgaW4gY3VycmVudCBsaW5lLCBwbGVhc2UgZGVsZXRlIGl0IG1hbnVhbGx5IVwiLCAwKTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0ZWxzZXtcblx0XHRcdC8vIGVkaXRvclZpZXcuZGlzcGF0Y2goe2NoYW5nZXM6IHtmcm9tOiB0YXJnZXRfbGluZS5mcm9tICsgZmluZHNbMF1bMF0sIHRvOiB0YXJnZXRfbGluZS5mcm9tICsgZmluZHNbMF1bMV0sIGluc2VydDogJyd9fSk7XG5cdFx0XHRlZGl0b3IucmVwbGFjZVJhbmdlKCcnLCB7bGluZTogdGFyZ2V0X2xpbmUubnVtYmVyLTEsIGNoOiBmaW5kc1swXVswXX0sIHtsaW5lOiB0YXJnZXRfbGluZS5udW1iZXItMSwgY2g6IGZpbmRzWzBdWzFdfSk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHR9XG5cblx0dHlwZSBSZWdEaWN0aW9uYXJ5ID0ge1xuXHRcdFtrZXk6IHN0cmluZ106IFJlZ0V4cDtcblx0fTtcblx0XG5cdGxldCBzdGFydFJlZzogUmVnRGljdGlvbmFyeSA9IHtcblx0XHQndGFibGUnOiAvXlxccypcXHwvLFxuXHRcdCdjYWxsb3V0JzogL14+Lyxcblx0fTtcblxuXHRsZXQgbW9kZSA9IGluX3RhYmxlID8gJ3RhYmxlJyA6ICdjYWxsb3V0Jztcblx0bGV0IGZpbmRzX2xpbmVzOiBudW1iZXJbXSA9IFtdO1xuXHRsZXQgZmluZHNfYWxsOiBbZnJvbTpudW1iZXIsIHRvOm51bWJlcl1bXSA9IFtdO1xuXHRmb3IgKGxldCBpPXRhcmdldF9saW5lLm51bWJlcjsgaTw9ZWRpdG9yLmxpbmVDb3VudCgpOyBpKyspe1xuXHRcdGxldCBsaW5lX3RleHQgPSBlZGl0b3IuZ2V0TGluZShpLTEpO1xuXHRcdGlmICghc3RhcnRSZWdbbW9kZV0udGVzdChsaW5lX3RleHQpKSBicmVhaztcblx0XHRwcmludChgbGluZV8ke2l9X3RleHQ6YCwgbGluZV90ZXh0KVxuXHRcdGxldCBmaW5kcyA9IGZpbmRMaW5rSW5MaW5lKGZpbGVfYmFzZV9uYW1lLCBsaW5lX3RleHQpO1xuXHRcdGlmIChmaW5kcy5sZW5ndGggPiAwKXtcblx0XHRcdGZpbmRzX2xpbmVzLnB1c2goLi4ubmV3IEFycmF5KGZpbmRzLmxlbmd0aCkuZmlsbChpKSk7XG5cdFx0XHRmaW5kc19hbGwucHVzaCguLi5maW5kcyk7XG5cdFx0fVxuXHR9XG5cblx0Zm9yIChsZXQgaT10YXJnZXRfbGluZS5udW1iZXItMTsgaT49MTsgaS0tKXtcblx0XHRsZXQgbGluZV90ZXh0ID0gZWRpdG9yLmdldExpbmUoaS0xKTtcblx0XHRpZiAoIXN0YXJ0UmVnW21vZGVdLnRlc3QobGluZV90ZXh0KSkgYnJlYWs7XG5cdFx0cHJpbnQoYGxpbmVfJHtpfV90ZXh0OmAsIGxpbmVfdGV4dClcblx0XHRsZXQgZmluZHMgPSBmaW5kTGlua0luTGluZShmaWxlX2Jhc2VfbmFtZSwgbGluZV90ZXh0KTtcblx0XHRpZiAoZmluZHMubGVuZ3RoID4gMCl7XG5cdFx0XHRmaW5kc19saW5lcy5wdXNoKC4uLm5ldyBBcnJheShmaW5kcy5sZW5ndGgpLmZpbGwoaSkpO1xuXHRcdFx0ZmluZHNfYWxsLnB1c2goLi4uZmluZHMpO1xuXHRcdH1cblx0fVxuXG5cdGlmIChmaW5kc19hbGwubGVuZ3RoID09IDApe1xuXHRcdG5ldyBOb3RpY2UoYEZhaWwgdG8gZmluZCB0aGUgbGluay10ZXh0IChmb3IgbGlua3MgaW4gJHttb2RlfSksIHBsZWFzZSBkZWxldGUgaXQgbWFudWFsbHkhYCwgMCk7XG5cdFx0cmV0dXJuO1xuXHR9XG5cdGVsc2UgaWYoZmluZHNfYWxsLmxlbmd0aCAhPSAxKXtcblx0XHRuZXcgTm90aWNlKGBGaW5kIG11bHRpcGxlIHNhbWUgTGluayBpbiBjdXJyZW50ICR7bW9kZX0sIHBsZWFzZSBkZWxldGUgaXQgbWFudWFsbHkhYCwgMCk7XG5cdFx0cmV0dXJuO1xuXHR9XG5cdGVsc2V7XG5cdFx0ZWRpdG9yLnJlcGxhY2VSYW5nZSgnJywge2xpbmU6IGZpbmRzX2xpbmVzWzBdLTEsIGNoOiBmaW5kc19hbGxbMF1bMF19LCB7bGluZTogZmluZHNfbGluZXNbMF0tMSwgY2g6IGZpbmRzX2FsbFswXVsxXX0pO1xuXHR9XG5cblx0ZWRpdG9yLmZvY3VzKCk7XG59XG5cbi8vIGNvcHkgaW1nIGZpbGUgdG8gY2xpcGJvYXJkXG5leHBvcnQgY29uc3QgaGFuZGxlckNvcHlGaWxlID0gYXN5bmMgKFxuXHRGaWxlQmFzZU5hbWU6IHN0cmluZyxcblx0Y3VycmVudE1kOiBURmlsZSxcblx0cGx1Z2luOiBBdHRhY2hGbG93UGx1Z2luXG4pID0+IHtcblx0Y29uc3QgZmlsZSA9IGdldEZpbGVCeUJhc2VOYW1lKGN1cnJlbnRNZCwgRmlsZUJhc2VOYW1lKSBhcyBURmlsZTtcblx0Y29uc3QgYmFzZVBhdGggPSAoZmlsZS52YXVsdC5hZGFwdGVyIGFzIGFueSkuYmFzZVBhdGhcblx0Y29uc3QgZmlsZV9hYl9wYXRoID0gYmFzZVBhdGggKyAnLycgKyBmaWxlLnBhdGhcblxuXHR0cnl7XG5cdFx0Y29weUZpbGVUb0NsaXBib2FyZENNRChmaWxlX2FiX3BhdGgpO1xuXHRcdG5ldyBOb3RpY2UoXCJDb3BpZWQgdG8gY2xpcGJvYXJkICFcIiwgU1VDQ0VTU19OT1RJQ0VfVElNRU9VVCk7XG5cdH1cblx0Y2F0Y2ggKGVycm9yKSB7XG5cdFx0Y29uc29sZS5lcnJvcihlcnJvcik7XG5cdFx0bmV3IE5vdGljZShcIkZhaWxkIHRvIGNvcHkgdGhlIGZpbGUgIVwiLCBTVUNDRVNTX05PVElDRV9USU1FT1VUKTtcblx0fVxuXG5cdC8vIGNvcHkgZmlsZSB0byBjbGlwYm9hcmRcblx0Ly8gdHJ5IHtcblx0XHQvLyBjb25zb2xlLmxvZyhmaWxlX2FiX3BhdGgpXG5cblx0XHQvLyBcdTUxNDhcdTY3RTVcdTc3MEJcdTUyNkFcdThEMzRcdTY3N0ZcdTUxODVcdTVCQjlcblx0XHQvLyBjb25zdCBjbGlwYm9hcmRJdGVtcyA9IGF3YWl0IG5hdmlnYXRvci5jbGlwYm9hcmQucmVhZCgpO1xuXHRcdC8vIGNvbnNvbGUubG9nKGNsaXBib2FyZEl0ZW1zWzBdKVxuXHRcdC8vIGxldCB0cCA9IGNsaXBib2FyZEl0ZW1zWzBdLnR5cGVzWzBdXG5cdFx0Ly8gY29uc29sZS5sb2codHAsIGNsaXBib2FyZEl0ZW1zWzBdLmdldFR5cGUodHApKVxuXG5cdFx0Ly8gXHU1OTBEXHU1MjM2XHU1NkZFXHU3MjQ3XHVGRjBDXHU0RjQ2XHU2NjJGXHU1M0VBXHU4MEZEXHU0RUU1UE5HXHU1RjYyXHU1RjBGXHU3Qzk4XHU4RDM0XHVGRjBDXHU1MzczXHU0RjdGXHU1OTBEXHU1MjM2XHU3Njg0XHU2NjJGR0lGXHU2MjE2XHU4MDA1SlBHXG5cdFx0Ly8gY29uc3QgaW1hZ2UgPSBmcy5yZWFkRmlsZVN5bmMoZmlsZV9hYl9wYXRoKTtcblx0XHQvLyBsZXQgZmlsZV90eXBlOiBzdHJpbmcgPSAnaW1hZ2UvcG5nJztcblx0XHQvLyBjb25zdCBibG9iID0gbmV3IEJsb2IoW2ltYWdlXSwgeyB0eXBlOiBmaWxlX3R5cGUgfSk7XG5cdFx0Ly8gY29uc3QgaXRlbSA9IG5ldyBDbGlwYm9hcmRJdGVtKHsgW2ZpbGVfdHlwZV06IGJsb2IgfSk7XG5cdFx0Ly8gYXdhaXQgbmF2aWdhdG9yLmNsaXBib2FyZC53cml0ZShbaXRlbV0pO1xuXG5cdC8vIFx0Y29weUZpbGVUb0NsaXBib2FyZENNRChmaWxlX2FiX3BhdGgpO1xuXG5cdC8vIFx0bmV3IE5vdGljZShcIkNvcGllZCB0byBjbGlwYm9hcmQgIVwiLCBTVUNDRVNTX05PVElDRV9USU1FT1VUKTtcblx0Ly8gfVxuXHQvLyBjYXRjaCAoZXJyb3IpIHtcblx0Ly8gXHRjb25zb2xlLmVycm9yKGVycm9yKTtcblx0Ly8gXHRuZXcgTm90aWNlKFwiRmFpbGQgdG8gY29weSB0aGUgZmlsZSAhXCIsIFNVQ0NFU1NfTk9USUNFX1RJTUVPVVQpO1xuXHQvLyB9XG59XG5cbi8qKlxuICpcbiAqIEBwYXJhbSBmaWxlIHRhcmdldCBkZWxldGVkIGZpbGVcbiAqIEByZXR1cm5zIHBhcmVudCBmb2xkZXIgb3IgdW5kZWZpZW5kXG4gKi9cbmV4cG9ydCBjb25zdCBnZXRGaWxlUGFyZW50Rm9sZGVyID0gKGZpbGU6IFRGaWxlKTogVEZvbGRlciB8IHVuZGVmaW5lZCA9PiB7XG5cdGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUpIHtcblx0XHRpZiAoZmlsZS5wYXJlbnQgaW5zdGFuY2VvZiBURm9sZGVyKSB7XG5cdFx0XHRyZXR1cm4gZmlsZS5wYXJlbnQ7XG5cdFx0fVxuXHR9XG5cdHJldHVybjtcbn07XG4vKipcbiAqXG4gKiBAcGFyYW0gZmlsZVxuICogQHJldHVybnNcbiAqL1xuY29uc3Qgb25seU9uZUZpbGVFeGlzdHMgPSAoZmlsZTogVEZpbGUpOiBib29sZWFuID0+IHtcblx0Y29uc3QgZmlsZUZvbGRlciA9IGdldEZpbGVQYXJlbnRGb2xkZXIoZmlsZSkgYXMgVEZvbGRlcjtcblx0cmV0dXJuIGZpbGVGb2xkZXIuY2hpbGRyZW4ubGVuZ3RoID09PSAxO1xufTtcblxuXG4vLyBcdThDMDNcdTc1MjhcdTdDRkJcdTdFREZcdTU0N0RcdTRFRTRcdTU5MERcdTUyMzZcdTY1ODdcdTRFRjZcdTUyMzBcdTdDRkJcdTdFREZcdTUyNkFcdThEMzRcdTY3N0ZcbmZ1bmN0aW9uIGNvcHlGaWxlVG9DbGlwYm9hcmRDTUQoZmlsZVBhdGg6IHN0cmluZykge1xuXG5cdGlmICghZXhpc3RzU3luYyhmaWxlUGF0aCkpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihgRmlsZSAke2ZpbGVQYXRofSBkb2VzIG5vdCBleGlzdGApO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3QgY2FsbGJhY2sgPSAoZXJyb3I6IEVycm9yIHwgbnVsbCwgc3Rkb3V0OiBzdHJpbmcsIHN0ZGVycjogc3RyaW5nKSA9PiB7XG4gICAgICAgIGlmIChlcnJvcikge1xuXHRcdFx0bmV3IE5vdGljZShgRXJyb3IgZXhlY3V0aW5nIGNvbW1hbmQ6ICR7ZXJyb3IubWVzc2FnZX1gLCBTVUNDRVNTX05PVElDRV9USU1FT1VUKTtcblx0XHRcdGNvbnNvbGUuZXJyb3IoYEVycm9yIGV4ZWN1dGluZyBjb21tYW5kOiAke2Vycm9yLm1lc3NhZ2V9YCk7XG5cdFx0XHRyZXR1cm47XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgaWYgKHByb2Nlc3MucGxhdGZvcm0gPT09ICdkYXJ3aW4nKSB7XG5cdFx0Ly8gXHU4OUUzXHU1MUIzXHU2NUI5XHU2ODQ4MTogXHU0RjFBXHU4QzAzXHU1MUZBRmluZGVyXHVGRjBDXHU0RUE3XHU3NTFGXHU3N0FDXHU5NUY0XHU3Njg0XHU3QTk3XHU1M0UzXHVGRjBDXHU0RjQ2XHU2NjJGXHU4QkU1XHU1OTBEXHU1MjM2XHU2NENEXHU0RjVDXHU1QjhDXHU1MTY4XHU2NjJGXHU3Q0ZCXHU3RURGXHU3RUE3XHU1MjJCXHU3Njg0XHVGRjBDXHU2Q0ExXHU2NzA5XHU0RUZCXHU0RjU1XHU5NjUwXHU1MjM2XG5cdFx0ZXhlY1N5bmMoYG9wZW4gLVIgXCIke2ZpbGVQYXRofVwiYCk7XG4gICAgICAgIGV4ZWNTeW5jKGBvc2FzY3JpcHQgLWUgJ3RlbGwgYXBwbGljYXRpb24gXCJTeXN0ZW0gRXZlbnRzXCIgdG8ga2V5c3Ryb2tlIFwiY1wiIHVzaW5nIGNvbW1hbmQgZG93bidgKTtcbiAgICAgICAgZXhlY1N5bmMoYG9zYXNjcmlwdCAtZSAndGVsbCBhcHBsaWNhdGlvbiBcIlN5c3RlbSBFdmVudHNcIiB0byBrZXlzdHJva2UgXCJ3XCIgdXNpbmcgY29tbWFuZCBkb3duJ2ApO1xuXHRcdGV4ZWNTeW5jKGBvcGVuIC1hIFwiT2JzaWRpYW4uYXBwXCJgKTtcblxuXHRcdC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHQvLyBcdTZENEJcdThCRDVcdTUyMDdcdTYzNjJcdThGOTNcdTUxNjVcdTZDRDVcdTY1QjlcdTY4NDg6IFx1NkEyMVx1NjJERlNoaWZ0XHU5NTJFXHU2MzA5XHU0RTBCXHVGRjBDXHU0RjQ2XHU2NjJGXHU1OTMxXHU4RDI1XHU0RTg2XG5cdFx0Ly8gZXhlY1N5bmMoYG9zYXNjcmlwdCAtZSAndGVsbCBhcHBsaWNhdGlvbiBcIlN5c3RlbSBFdmVudHNcIiB0byBrZXkgZG93biBzaGlmdCdgKTtcblx0XHQvLyBleGVjU3luYyhgb3Nhc2NyaXB0IC1lICdkZWxheSAwLjA1J2ApO1xuXHRcdC8vIGV4ZWNTeW5jKGBvc2FzY3JpcHQgLWUgJ3RlbGwgYXBwbGljYXRpb24gXCJTeXN0ZW0gRXZlbnRzXCIgdG8ga2V5IHVwIHNoaWZ0J2ApO1xuXHRcdC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuXHRcdC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHQvLyBcdTUzRTZcdTRFMDBcdTc5Q0RcdTg5RTNcdTUxQjNcdTY1QjlcdTY4NDhcdUZGMENcdTRFMERcdTRGMUFcdThDMDNcdTUxRkFGaW5kZXJcdUZGMENcdTRGNDZcdTY2MkZcdTU5MERcdTUyMzZcdTc2ODRcdTY1ODdcdTRFRjZcdTY1RTBcdTZDRDVcdTdDOThcdThEMzRcdTUyMzB3b3JkXHU2MjE2XHU4MDA1XHU1RkFFXHU0RkUxXHU0RTJEXG5cdFx0Ly8gY29uc3QgYXBwbGVTY3JpcHQgPSBgXG5cdFx0Ly8gXHRvbiBydW4gYXJnc1xuXHRcdC8vIFx0XHRzZXQgdGhlIGNsaXBib2FyZCB0byBQT1NJWCBmaWxlIChmaXJzdCBpdGVtIG9mIGFyZ3MpXG5cdFx0Ly8gXHRlbmRcblx0XHQvLyBcdGA7XG5cdFx0Ly8gZXhlYyhgb3Nhc2NyaXB0IC1lICcke2FwcGxlU2NyaXB0fScgXCIke2ZpbGVQYXRofVwiYCwgY2FsbGJhY2spO1xuXHRcdC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIH0gZWxzZSBpZiAocHJvY2Vzcy5wbGF0Zm9ybSA9PT0gJ2xpbnV4Jykge1xuXHRcdC8vIFx1NzZFRVx1NTI0RFx1NjVCOVx1Njg0OFxuXHRcdC8vIHhjbGlwIC1zZWxlY3Rpb24gY2xpcGJvYXJkIC10ICQoZmlsZSAtLW1pbWUtdHlwZSAtYiAvcGF0aC90by95b3VyL2ZpbGUpIC1pIC9wYXRoL3RvL3lvdXIvZmlsZVxuICAgICAgICAvLyBleGVjKGB4Y2xpcCAtc2VsZWN0aW9uIGMgPCAke2ZpbGVQYXRofWAsIGNhbGxiYWNrKTtcblx0XHQvLyBleGVjKGB4Y2xpcCAtc2VsZWN0aW9uIGNsaXBib2FyZCAtdCAkKGZpbGUgLS1taW1lLXR5cGUgLWIgXCIke2ZpbGVQYXRofVwiKSAtaSBcIiR7ZmlsZVBhdGh9XCJgLCBjYWxsYmFjayk7XG4gICAgfSBlbHNlIGlmIChwcm9jZXNzLnBsYXRmb3JtID09PSAnd2luMzInKSB7XG4gICAgICAgIGV4ZWMoYHBvd2Vyc2hlbGwgLWNvbW1hbmQgXCJTZXQtQ2xpcGJvYXJkIC1QYXRoICcke2ZpbGVQYXRofSdcImAsIGNhbGxiYWNrKTtcbiAgICB9XG59XG5cbmNvbnN0IGZpbmRMaW5rSW5MaW5lID0gKGZpbGVfbmFtZTogc3RyaW5nLCBsaW5lX3RleHQ6IHN0cmluZykgPT57XG5cdGNvbnN0IGZpbGVfbmFtZV9tZGxpbmsgPSBmaWxlX25hbWUucmVwbGFjZSgvIC9nLCAnJTIwJyk7XG5cdGxldCByZWdXaWtpTGluayA9IC9cXCFcXFtcXFtbXlxcW1xcXV0qP1xcXVxcXS9nO1xuICAgIGxldCByZWdNZExpbmsgPSAvXFwhXFxbW15cXFtcXF1dKj9cXF1cXChbXlxcc1xcKVxcKFxcW1xcXVxce1xcfSddKlxcKS9nO1xuXHRwcmludCgndGFyZ2V0X25hbWUgKFdJS0kvTUQpOicsIGZpbGVfbmFtZSwgZmlsZV9uYW1lX21kbGluaylcblxuXHQvLyBjb25zb2xlLmxvZygnc2VhcmNoIGluIGxpbmVfdGV4dDonLCBsaW5lX3RleHQpXG5cdGxldCBzZWFyY2hfcmVzdWx0OiBbZnJvbTpudW1iZXIsIHRvOm51bWJlcl1bXSA9IFtdXG5cdGlmIChsaW5lX3RleHQuaW5jbHVkZXMoZmlsZV9uYW1lKSl7XG5cdFx0d2hpbGUodHJ1ZSl7XG5cdFx0XHRsZXQgbWF0Y2ggPSByZWdXaWtpTGluay5leGVjKGxpbmVfdGV4dCk7XG5cdFx0XHRpZighbWF0Y2gpIGJyZWFrO1xuXHRcdFx0bGV0IG1hdGNoZWRfbGluayA9IG1hdGNoWzBdO1xuXHRcdFx0cHJpbnQoJ21hdGNoZWRfbGluazonLCBtYXRjaGVkX2xpbmspXG5cdFx0XHRwcmludCgnbWF0Y2hlZF9saW5rLmluY2x1ZGVzKGZpbGVfbmFtZSknLCBtYXRjaGVkX2xpbmsuaW5jbHVkZXMoZmlsZV9uYW1lKSlcblx0XHRcdGlmIChtYXRjaGVkX2xpbmsuaW5jbHVkZXMoZmlsZV9uYW1lKSl7XG5cdFx0XHRcdHNlYXJjaF9yZXN1bHQucHVzaChbbWF0Y2guaW5kZXgsIG1hdGNoLmluZGV4K21hdGNoZWRfbGluay5sZW5ndGhdKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHRpZiAobGluZV90ZXh0LmluY2x1ZGVzKGZpbGVfbmFtZV9tZGxpbmspKXtcblx0XHR3aGlsZSh0cnVlKXtcblx0XHRcdGxldCBtYXRjaCA9IHJlZ01kTGluay5leGVjKGxpbmVfdGV4dCk7XG5cdFx0XHRpZighbWF0Y2gpIGJyZWFrO1xuXHRcdFx0bGV0IG1hdGNoZWRfbGluayA9IG1hdGNoWzBdO1xuXHRcdFx0cHJpbnQoJ21hdGNoZWRfbGluazonLCBtYXRjaGVkX2xpbmspXG5cdFx0XHRwcmludCgnbWF0Y2hlZF9saW5rLmluY2x1ZGVzKGZpbGVfbmFtZV9tZGxpbmspJywgbWF0Y2hlZF9saW5rLmluY2x1ZGVzKGZpbGVfbmFtZV9tZGxpbmspKVxuXHRcdFx0aWYgKG1hdGNoZWRfbGluay5pbmNsdWRlcyhmaWxlX25hbWVfbWRsaW5rKSl7XG5cdFx0XHRcdHNlYXJjaF9yZXN1bHQucHVzaChbbWF0Y2guaW5kZXgsIG1hdGNoLmluZGV4K21hdGNoZWRfbGluay5sZW5ndGhdKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblx0cmV0dXJuIHNlYXJjaF9yZXN1bHQ7XG59XG5cblxuZXhwb3J0IGNvbnN0IGhhbmRsZXJSZW5hbWVGaWxlID0gKFxuXHRGaWxlQmFzZU5hbWU6IHN0cmluZyxcblx0Y3VycmVudE1kOiBURmlsZSxcblx0cGx1Z2luOiBBdHRhY2hGbG93UGx1Z2luXG4pID0+IHtcblx0Y29uc3QgdGFyZ2V0X2ZpbGUgPSBnZXRGaWxlQnlCYXNlTmFtZShjdXJyZW50TWQsIEZpbGVCYXNlTmFtZSkgYXMgVEZpbGU7XG5cdGxldCBwYXRoID0gdGFyZ2V0X2ZpbGUucGF0aDtcblx0bGV0IG5hbWUgPSB0YXJnZXRfZmlsZS5uYW1lO1xuXHRsZXQgdGFyZ2V0X2ZvbGRlciA9IHBhdGguc3Vic3RyaW5nKDAsIHBhdGgubGVuZ3RoLW5hbWUubGVuZ3RoKTtcblx0bGV0IGZpbGVfdHlwZSA9IG5hbWUuc3BsaXQoJy4nKS5wb3AoKSBhcyBzdHJpbmc7XG5cdG5ldyBSZW5hbWVNb2RhbChwbHVnaW4uYXBwLCBcblx0XHR0YXJnZXRfZm9sZGVyLCBcblx0XHRuYW1lLnN1YnN0cmluZygwLCBuYW1lLmxlbmd0aC1maWxlX3R5cGUubGVuZ3RoLTEpLCBcblx0XHRmaWxlX3R5cGUsIFxuXHRcdChyZXN1bHQpID0+IHtcblx0XHRpZiAoIXJlc3VsdCkgcmV0dXJuO1xuXHRcdGlmKHJlc3VsdD09cGF0aCkgcmV0dXJuO1xuXHRcdGFwcC52YXVsdC5hZGFwdGVyLmV4aXN0cyhyZXN1bHQpXG5cdFx0LnRoZW4oKGV4aXN0cykgPT4ge1xuXHRcdFx0aWYoZXhpc3RzKSB7XG5cdFx0XHRcdG5ldyBOb3RpY2UoYEZhaWwgdG8gcmVuYW1lIGZvciB0aGVyZSBhbHJlYXkgZXhpc3QgZmlsZSAke3Jlc3VsdH1gKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHBsdWdpbi5hcHAuZmlsZU1hbmFnZXIucmVuYW1lRmlsZSh0YXJnZXRfZmlsZSwgYCR7cmVzdWx0fWApO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9KS5vcGVuKCk7XG59XG5cblxuXG5leHBvcnQgY2xhc3MgUmVuYW1lTW9kYWwgZXh0ZW5kcyBNb2RhbCB7XG5cdHJlc3VsdDogc3RyaW5nO1xuXHRmb2xkZXI6IHN0cmluZztcblx0bmFtZTogc3RyaW5nO1xuXHRmaWxldHlwZTogc3RyaW5nO1xuXHRvblN1Ym1pdDogKHJlc3VsdDogc3RyaW5nKSA9PiB2b2lkO1xuICBcblx0Y29uc3RydWN0b3IoYXBwOiBBcHAsIGZvbGRlcjpzdHJpbmcsIG5hbWU6c3RyaW5nLCBmaWxldHlwZTpzdHJpbmcsIG9uU3VibWl0OiAocmVzdWx0OiBzdHJpbmcpID0+IHZvaWQpIHtcblx0ICBzdXBlcihhcHApO1xuXHQgIHRoaXMub25TdWJtaXQgPSBvblN1Ym1pdDtcblx0ICB0aGlzLmZvbGRlciA9IGZvbGRlcjtcblx0ICB0aGlzLm5hbWUgPSBuYW1lO1xuXHQgIHRoaXMuZmlsZXR5cGUgPSBmaWxldHlwZTtcblx0fVxuICBcblx0b25PcGVuKCkge1xuXHRcdGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xuXHRcdGxldCBzZXR0aW5nID0gbmV3IFNldHRpbmcoY29udGVudEVsKVxuXHRcdFx0LnNldE5hbWUoXCJSZW5hbWU6XCIpXG5cdFx0XHQuYWRkVGV4dCh0ZXh0ID0+IHRleHRcblx0XHRcdFx0LnNldFZhbHVlKHRoaXMubmFtZSlcblx0XHRcdFx0Lm9uQ2hhbmdlKCh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdHRoaXMucmVzdWx0ID0gYCR7dGhpcy5mb2xkZXJ9JHt2YWx1ZX0uJHt0aGlzLmZpbGV0eXBlfWA7XG5cdFx0XHRcdH0pXG5cdFx0XHQpO1xuXG5cdFx0Ly8gXHU0RjdGIERPTSBcdTY3MDlcdThEQjNcdTU5MUZcdTc2ODRcdTY1RjZcdTk1RjRcdTZFMzJcdTY3RDNcdTg4NjhcdTUzNTVcdTUxNDNcdTdEMjBcblx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdGxldCBpbnB1dEJveCA9IHNldHRpbmcuc2V0dGluZ0VsLnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W3R5cGU9XCJ0ZXh0XCJdJyk7XG5cdFx0XHRpZiAoaW5wdXRCb3ggJiYgaW5wdXRCb3gucGFyZW50RWxlbWVudCkge1xuXHRcdFx0XHRsZXQgZm9sZGVyX2luZGljYXRvciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xhYmVsJyk7XG5cdFx0XHRcdGZvbGRlcl9pbmRpY2F0b3IuaW5uZXJUZXh0ID0gYCR7dGhpcy5mb2xkZXJ9YDtcblx0XHRcdFx0Zm9sZGVyX2luZGljYXRvci5zdHlsZS5tYXJnaW5SaWdodCA9ICc0cHgnOyAgLy8gXHU1M0VGXHU0RUU1XHU2ODM5XHU2MzZFXHU5NzAwXHU4OTgxXHU4QzAzXHU2NTc0XHU5NUY0XHU4REREXG5cdFx0XHRcdGlucHV0Qm94LnBhcmVudEVsZW1lbnQuaW5zZXJ0QmVmb3JlKGZvbGRlcl9pbmRpY2F0b3IsIGlucHV0Qm94KTtcblxuXHRcdFx0XHRsZXQgZmlsZV90eXBlX2luZGljYXRvciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xhYmVsJyk7XG5cdFx0XHRcdGZpbGVfdHlwZV9pbmRpY2F0b3IuaW5uZXJUZXh0ID0gYC4ke3RoaXMuZmlsZXR5cGV9YDtcblx0XHRcdFx0ZmlsZV90eXBlX2luZGljYXRvci5zdHlsZS5tYXJnaW5MZWZ0ID0gJzRweCc7ICAvLyBcdTUzRUZcdTRFRTVcdTY4MzlcdTYzNkVcdTk3MDBcdTg5ODFcdThDMDNcdTY1NzRcdTk1RjRcdThERERcblx0XHRcdFx0aW5wdXRCb3guYWZ0ZXIoZmlsZV90eXBlX2luZGljYXRvcik7XG5cblx0XHRcdFx0Ly8gXHU4M0I3XHU1M0Q2XHU4QkJFXHU3RjZFXHU3NTRDXHU5NzYyXHU3Njg0XHU0RTBBXHU3RUE3XHU1MTQzXHU3RDIwIFxuXHRcdFx0XHRsZXQgcGFyZW50RWwgPSBzZXR0aW5nLnNldHRpbmdFbC5wYXJlbnRFbGVtZW50O1xuXHRcdFx0XHRpZiAocGFyZW50RWwpIHtcblx0XHRcdFx0XHQvLyBcdTRGN0ZcdTUxNzZcdTVCNTBcdTUxNDNcdTdEMjBcdTVDNDVcdTRFMkRcdTY2M0VcdTc5M0Fcblx0XHRcdFx0XHRwYXJlbnRFbC5zdHlsZS5kaXNwbGF5ID0gJ2ZsZXgnO1xuXHRcdFx0XHRcdHBhcmVudEVsLnN0eWxlLmp1c3RpZnlDb250ZW50ID0gJ2NlbnRlcic7XG5cdFx0XHRcdH1cblx0XHRcdFx0Ly8gXHU4RjZDXHU2MzYyaW5wdXRCb3hcdTdDN0JcdTU3OEJcdTVFNzZcdTkwMDlcdTYyRTlcdThGOTNcdTUxNjVcdTY4NDZcdTc2ODRcdTY1ODdcdTY3MkNcblx0XHRcdFx0bGV0IGlucHV0RWxlbSA9IGlucHV0Qm94IGFzIEhUTUxJbnB1dEVsZW1lbnQ7XG5cdFx0XHRcdGlucHV0RWxlbS5zZWxlY3QoKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGNvbnNvbGUuZXJyb3IoXCJcdTY1RTBcdTZDRDVcdTYyN0VcdTUyMzBcdTY1ODdcdTY3MkNcdThGOTNcdTUxNjVcdTY4NDZcIik7XG5cdFx0XHR9XG5cdFx0fSwgMCk7XG5cblx0XHQvLyBFbnRlciB0byBzdWJtaXRcblx0XHR0aGlzLnNjb3BlLnJlZ2lzdGVyKFtdLCBcIkVudGVyXCIsIChldnQ6IEtleWJvYXJkRXZlbnQpID0+IHtcblx0XHRcdGlmIChldnQuaXNDb21wb3NpbmcpIHtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXHRcdFx0dGhpcy5jbG9zZSgpO1xuXHRcdFx0dGhpcy5vblN1Ym1pdCh0aGlzLnJlc3VsdCk7XG5cdFx0fSk7XG5cdH1cbiAgXG5cdG9uQ2xvc2UoKSB7XG5cdCAgbGV0IHsgY29udGVudEVsIH0gPSB0aGlzO1xuXHQgIGNvbnRlbnRFbC5lbXB0eSgpO1xuXHR9XG4gIH0iLCAiaW1wb3J0IHsgTm90aWNlLCBURmlsZSwgVEZvbGRlciB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IEF0dGFjaEZsb3dQbHVnaW4gZnJvbSBcInNyYy9tYWluXCI7XG5jb25zdCBTVUNDRVNTX05PVElDRV9USU1FT1VUID0gMTgwMDtcbi8qKlxuICogRGVsZXRlIGF0dGFjaG1lbnRcbiAqIEBwYXJhbSBmaWxlXG4gKi9cbmV4cG9ydCBjb25zdCBkZWxldGVGaWxlID0gYXN5bmMgKFxuXHRmaWxlOiBURmlsZSB8IFRGb2xkZXIsXG5cdHBsdWdpbjogQXR0YWNoRmxvd1BsdWdpblxuKSA9PiB7XG5cdGNvbnN0IGRlbGV0ZU9wdGlvbiA9IHBsdWdpbi5zZXR0aW5ncy5kZWxldGVPcHRpb247XG5cdHRyeSB7XG5cdFx0aWYgKGRlbGV0ZU9wdGlvbiA9PT0gXCIudHJhc2hcIikge1xuXHRcdFx0YXdhaXQgYXBwLnZhdWx0LnRyYXNoKGZpbGUsIGZhbHNlKTtcblx0XHR9IGVsc2UgaWYgKGRlbGV0ZU9wdGlvbiA9PT0gXCJzeXN0ZW0tdHJhc2hcIikge1xuXHRcdFx0YXdhaXQgYXBwLnZhdWx0LnRyYXNoKGZpbGUsIHRydWUpO1xuXHRcdH0gZWxzZSBpZiAoZGVsZXRlT3B0aW9uID09PSBcInBlcm1hbmVudFwiKSB7XG5cdFx0XHRhd2FpdCBhcHAudmF1bHQuZGVsZXRlKGZpbGUpO1xuXHRcdH1cblx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRjb25zb2xlLmVycm9yKGVycm9yKTtcblx0XHRuZXcgTm90aWNlKFwiRmFpbGQgdG8gZGVsZXRlIHRoZSBmaWxlL2ZvbGRlciAhXCIsIFNVQ0NFU1NfTk9USUNFX1RJTUVPVVQpO1xuXHR9XG59O1xuLyoqXG4gKiBEZWxldGUgbm90ZVxuICogQHBhcmFtIGZpbGVcbiAqL1xuLyogZXhwb3J0IGNvbnN0IGRlbGV0ZU5vdGUgPSAoZmlsZTogVEZpbGUpID0+IHtcblx0Ly8gQHRzLWlnbm9yZVxuXHRhcHAuZmlsZU1hbmFnZXIucHJvbXB0Rm9yRGVsZXRpb24oZmlsZSk7XG59OyAqL1xuIiwgImltcG9ydCBBdHRhY2hGbG93UGx1Z2luIGZyb20gXCJzcmMvbWFpblwiO1xuaW1wb3J0IHsgZGVsZXRlQWxsQXR0YWNocyB9IGZyb20gXCJzcmMvb3B0aW9ucy9kZWxlbGVBbGxBdHRhY2hzSW5UaGVOb3RlXCI7XG5cbmV4cG9ydCBjb25zdCBhZGRDb21tYW5kID0gKG15UGx1Z2luOiBBdHRhY2hGbG93UGx1Z2luKSA9PiB7XG5cdG15UGx1Z2luLmFkZENvbW1hbmQoe1xuXHRcdGlkOiBcImNsZWFyLWFsbC1hdHRhY2htZW50cy1pbi1jdXJyZW50LWZpbGVcIixcblx0XHRuYW1lOiBcImNsZWFyIGFsbCBhdHRhY2htZW50cyBpbiBjdXJyZW50IGZpbGVcIixcblx0XHRjYWxsYmFjazogYXN5bmMgKCkgPT4ge1xuXHRcdFx0ZGVsZXRlQWxsQXR0YWNocyhteVBsdWdpbik7XG5cdFx0fSxcblx0fSk7XG59O1xuIiwgImltcG9ydCBBdHRhY2hGbG93UGx1Z2luIGZyb20gJy4vbWFpbic7XG5pbXBvcnQgeyBQbHVnaW5TZXR0aW5nVGFiLCBTZXR0aW5nLCBBcHAgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBzZXREZWJ1ZyB9IGZyb20gJy4vdXRpbCc7XG5cblxuXG5leHBvcnQgaW50ZXJmYWNlIEF0dGFjaEZsb3dTZXR0aW5ncyB7XG4gICAgZGVsZXRlT3B0aW9uOiBzdHJpbmc7XG4gICAgbG9nc01vZGFsOiBib29sZWFuO1xuICAgIGRyYWdSZXNpemU6IGJvb2xlYW47XG4gICAgZGVidWc6IGJvb2xlYW47XG59XG5cbmV4cG9ydCBjb25zdCBERUZBVUxUX1NFVFRJTkdTOiBBdHRhY2hGbG93U2V0dGluZ3MgPSB7XG4gICAgZGVsZXRlT3B0aW9uOiAnLnRyYXNoJyxcbiAgICBsb2dzTW9kYWw6IHRydWUsXG4gICAgZHJhZ1Jlc2l6ZTogZmFsc2UsXG4gICAgZGVidWc6IGZhbHNlLFxufTtcblxuXG5leHBvcnQgY2xhc3MgQXR0YWNoRmxvd1NldHRpbmdzVGFiIGV4dGVuZHMgUGx1Z2luU2V0dGluZ1RhYiB7XG5cbiAgICBwbHVnaW46IEF0dGFjaEZsb3dQbHVnaW47XG5cblxuICAgIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IEF0dGFjaEZsb3dQbHVnaW4pIHtcbiAgICAgICAgc3VwZXIoYXBwLCBwbHVnaW4pO1xuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcbiAgICB9XG5cblxuICAgIGRpc3BsYXkoKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XG4gICAgICAgIGNvbnRhaW5lckVsLmVtcHR5KCk7XG4gICAgICAgIGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdoMicsIHsgdGV4dDogJ0F0dGFjaEZsb3cgcGx1Z2luIFNldHRpbmdzJyB9KTtcblxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKCdEZWxldGVkIEF0dGFjaG1lbnQgRGVzdGluYXRpb24nKVxuICAgICAgICAgICAgLnNldERlc2MoJ1NlbGVjdCB3aGVyZSB5b3Ugd2FudCBBdHRhY2htZW50cyB0byBiZSBtb3ZlZCBvbmNlIHRoZXkgYXJlIGRlbGV0ZWQnKVxuICAgICAgICAgICAgLmFkZERyb3Bkb3duKChkcm9wZG93bikgPT4ge1xuICAgICAgICAgICAgICAgIGRyb3Bkb3duLmFkZE9wdGlvbigncGVybWFuZW50JywgJ0RlbGV0ZSBQZXJtYW5lbnRseScpO1xuICAgICAgICAgICAgICAgIGRyb3Bkb3duLmFkZE9wdGlvbignLnRyYXNoJywgJ01vdmUgdG8gT2JzaWRpYW4gVHJhc2gnKTtcbiAgICAgICAgICAgICAgICBkcm9wZG93bi5hZGRPcHRpb24oJ3N5c3RlbS10cmFzaCcsICdNb3ZlIHRvIFN5c3RlbSBUcmFzaCcpO1xuICAgICAgICAgICAgICAgIGRyb3Bkb3duLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmRlbGV0ZU9wdGlvbik7XG4gICAgICAgICAgICAgICAgZHJvcGRvd24ub25DaGFuZ2UoKG9wdGlvbikgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5kZWxldGVPcHRpb24gPSBvcHRpb247XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG5cdFx0XHQuc2V0TmFtZShcIkRyYWcgVG8gUmVzaXplIEltYWdlc1wiKVxuXHRcdFx0LnNldERlc2MoXCJcdTYyRDZcdTYyRkRcdThDMDNcdTY1NzRcdTU2RkVcdTcyNDdcdTU5MjdcdTVDMEZcIilcblx0XHRcdC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT4ge1xuXHRcdFx0XHR0b2dnbGUuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuZHJhZ1Jlc2l6ZSlcblx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5kcmFnUmVzaXplID0gdmFsdWU7XG5cdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0XHR9KTtcblx0XHRcdH0pO1xuICAgICAgICBcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG5cdFx0XHQuc2V0TmFtZShcIlByaW50IERlYnVnIEluZm9ybWF0aW9uXCIpXG5cdFx0XHQuc2V0RGVzYyhcIlx1NjNBN1x1NTIzNlx1NTNGMFx1OEY5M1x1NTFGQVx1OEMwM1x1OEJENVx1NEZFMVx1NjA2RlwiKVxuXHRcdFx0LmFkZFRvZ2dsZSgodG9nZ2xlKSA9PiB7XG5cdFx0XHRcdHRvZ2dsZS5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5kZWJ1Zylcblx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5kZWJ1ZyA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2V0RGVidWcodmFsdWUpO1xuXHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHR9KTtcbiAgICB9XG59XG4iLCAiLyoqXG4gKiBnZXQgbW91c2UgZXZlbnQgdGFyZ2V0XG4gKiBAcGFyYW0gZXZlbnQgXG4gKi9cbmV4cG9ydCBjb25zdCBnZXRNb3VzZUV2ZW50VGFyZ2V0ID0gKGV2ZW50OiBNb3VzZUV2ZW50KTogSFRNTEVsZW1lbnQgPT4ge1xuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgY29uc3QgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0IGFzIEhUTUxFbGVtZW50O1xuICAgIHJldHVybiB0YXJnZXQ7XG59XG4iLCAiaW1wb3J0IHsgTW9kYWwsIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgQXR0YWNoRmxvd1BsdWdpbiBmcm9tIFwic3JjL21haW5cIjtcbmltcG9ydCB7XG5cdGRlbGV0ZUFsbEF0dGFjaHMsXG5cdGdldFJlZmVuY2VkTGlua0NvdW50LFxufSBmcm9tIFwic3JjL29wdGlvbnMvZGVsZWxlQWxsQXR0YWNoc0luVGhlTm90ZVwiO1xuaW1wb3J0IHsgZGVsZXRlRmlsZSB9IGZyb20gXCJzcmMvdXRpbHMvZGVsZXRlRmlsZVwiO1xuXG5leHBvcnQgY2xhc3MgRGVsZXRlQWxsTG9nc01vZGFsIGV4dGVuZHMgTW9kYWwge1xuXHRub3RlOiBURmlsZTtcblx0bXlQbHVnaW46IEF0dGFjaEZsb3dQbHVnaW47XG5cdGNvbnN0cnVjdG9yKG5vdGU6IFRGaWxlLCBteVBsdWdpbjogQXR0YWNoRmxvd1BsdWdpbikge1xuXHRcdHN1cGVyKGFwcCk7XG5cdFx0dGhpcy5ub3RlID0gbm90ZTtcblx0XHR0aGlzLm15UGx1Z2luID0gbXlQbHVnaW47XG5cdH1cblx0Z2V0TG9nKCk6IHN0cmluZyB7XG5cdFx0Y29uc3QgcmVmZXJlbmNlTWVzc2FnZSA9IGBBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gZGVsZXRlIFwiJHt0aGlzLm5vdGUuYmFzZW5hbWV9Lm1kXCI/XFxuXFxuSXQgd2lsbCBiZSBtb3ZlZCB0byB5b3VyICR7dGhpcy5teVBsdWdpbi5zZXR0aW5ncy5kZWxldGVPcHRpb259LmA7XG5cdFx0cmV0dXJuIHJlZmVyZW5jZU1lc3NhZ2U7XG5cdH1cblx0c2hvd0xvZ3MoKSB7XG5cdFx0Y29uc3QgbG9ncyA9IHRoaXMuY29udGVudEVsLmNyZWF0ZUVsKFwiZGl2XCIpO1xuXHRcdGxvZ3MuYWRkQ2xhc3MoXCJhdHRhY2htZW50LWZsb3ctbG9nXCIpO1xuXHRcdGxvZ3Muc2V0VGV4dCh0aGlzLmdldExvZygpKTtcblx0fVxuXHRvbk9wZW4oKSB7XG5cdFx0Y29uc3QgeyBjb250ZW50RWwgfSA9IHRoaXM7XG5cdFx0Y29uc3QgbXlNb2RhbCA9IHRoaXM7XG5cdFx0Y29uc3QgaGVhZGVyV3JhcHBlciA9IGNvbnRlbnRFbC5jcmVhdGVFbChcImRpdlwiKTtcblx0XHRoZWFkZXJXcmFwcGVyLmFkZENsYXNzKFwiYXR0YWNobWVudC1mbG93LWNlbnRlci13cmFwcGVyXCIpO1xuXHRcdHRoaXMuc2hvd0xvZ3MoKTtcblx0XHRjb25zdCByZWZlcmVuY2VkTWVzc2FnZVdyYXBwZXIgPSBjb250ZW50RWwuY3JlYXRlRWwoXCJzcGFuXCIpO1xuXHRcdHJlZmVyZW5jZWRNZXNzYWdlV3JhcHBlci5zdHlsZS5jb2xvciA9IFwicmVkXCI7XG5cdFx0Y29uc3QgcmVmZXJlbmNlZE1lc3NhZ2UgPSBgVGhlcmUgYXJlKGlzKSBjdXJyZW50bHkgIFske2dldFJlZmVuY2VkTGlua0NvdW50KCl9XSAgbm9uLW11bHRpLXJlZmVyZW5jZWQgbGluayhzKSBwb2ludGluZyB0byB0aGlzIG5vdGUuYDtcblx0XHRyZWZlcmVuY2VkTWVzc2FnZVdyYXBwZXIuYXBwZW5kKHJlZmVyZW5jZWRNZXNzYWdlKTtcblx0XHQvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHRjb25zdCBidXR0b25XcmFwcGVyID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRWwoXCJkaXZcIikgYXMgSFRNTERpdkVsZW1lbnQ7XG5cdFx0YnV0dG9uV3JhcHBlci5hZGRDbGFzcyhcImF0dGFjaG1lbnQtZmxvdy1jZW50ZXItd3JhcHBlclwiKTtcblx0XHRjb25zdCBoZWFkZXJFbCA9IGhlYWRlcldyYXBwZXIuY3JlYXRlRWwoXCJoMVwiLCB7XG5cdFx0XHR0ZXh0OiBcIkRlbGV0ZSB0aGUgZmlsZSBhbmQgaXRzIGFsbCBhdHRhY2htZW50cyAtIGxvZ3MgXCIsXG5cdFx0fSk7XG5cdFx0aGVhZGVyRWwuYWRkQ2xhc3MoXCJtb2RhbC10aXRsZVwiKTtcblx0XHR0aGlzLnNob3dDb25maXJtQnV0dG9uKGJ1dHRvbldyYXBwZXIsIG15TW9kYWwpO1xuXHRcdHRoaXMuc2hvd0NhbmNlbEJ0bihidXR0b25XcmFwcGVyLCBteU1vZGFsKTtcblx0fVxuXHQvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdHNob3dDYW5jZWxCdG4oYnV0dG9uV3JhcHBlcjogSFRNTERpdkVsZW1lbnQsIG15TW9kYWw6IE1vZGFsKSB7XG5cdFx0Ly8gLS0tLS0tLS1jbG9zZUJ1dHRvbi0tLS0tLS0tXG5cdFx0Y29uc3QgY2xvc2VCdXR0b24gPSBidXR0b25XcmFwcGVyLmNyZWF0ZUVsKFwiYnV0dG9uXCIsIHtcblx0XHRcdHRleHQ6IFwiQ2FuY2VsXCIsXG5cdFx0fSk7XG5cdFx0Y2xvc2VCdXR0b24uc2V0QXR0cmlidXRlKFwiYXJpYS1sYWJlbFwiLCBcIkNhbmNlbCB0aGUgb3BlcmF0aW9uXCIpO1xuXHRcdGNsb3NlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG5cdFx0XHRteU1vZGFsLmNsb3NlKCk7XG5cdFx0fSk7XG5cdH1cblx0c2hvd0NvbmZpcm1CdXR0b24oYnV0dG9uV3JhcHBlcjogSFRNTERpdkVsZW1lbnQsIG15TW9kYWw6IE1vZGFsKSB7XG5cdFx0Y29uc3QgcmVtb3ZlTGlua0J1dHRvbiA9IGJ1dHRvbldyYXBwZXIuY3JlYXRlRWwoXCJidXR0b25cIiwge1xuXHRcdFx0dGV4dDogXCJDb25maXJtXCIsXG5cdFx0fSk7XG5cdFx0cmVtb3ZlTGlua0J1dHRvbi5zZXRBdHRyaWJ1dGUoXG5cdFx0XHRcImFyaWEtbGFiZWxcIixcblx0XHRcdFwiQ29udGludWUgdG8gZGVsZXRlIGN1cnJlbnQgZmlsZSBhbmQgaXRzIGFsbCBub24tbXVsdGktcmVmZXJlbmNlZCBhdHRhY2htZW50c1wiXG5cdFx0KTtcblx0XHRyZW1vdmVMaW5rQnV0dG9uLmFkZENsYXNzKFwibW9kLXdhcm5pbmdcIik7XG5cdFx0cmVtb3ZlTGlua0J1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgYXN5bmMgKCkgPT4ge1xuXHRcdFx0ZGVsZXRlRmlsZSh0aGlzLm5vdGUsIHRoaXMubXlQbHVnaW4pO1xuXHRcdFx0ZGVsZXRlQWxsQXR0YWNocyh0aGlzLm15UGx1Z2luKTtcblx0XHRcdG15TW9kYWwuY2xvc2UoKTtcblx0XHR9KTtcblx0fVxufVxuIiwgIi8vIFRoaXMgZmlsZSBpcyBjb3BpZWQgZnJvbSByZXBvOiBodHRwczovL2dpdGh1Yi5jb20vTm9tYXJDdWIvb2JzaWRpYW4tY29weS11cmwtaW4tcHJldmlld1xuXG4vLyBNSVQgTGljZW5zZVxuLy8gQ29weXJpZ2h0IChjKSAyMDIyIE5vbWFyQ3ViXG5cbi8vIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHlcbi8vIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWxcbi8vIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHNcbi8vIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGxcbi8vIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpc1xuLy8gZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczpcblxuLy8gVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW4gYWxsXG4vLyBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuXG4vLyBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4vLyBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbi8vIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuLy8gQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuLy8gTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbi8vIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU4gVEhFXG4vLyBTT0ZUV0FSRS5cblxuaW1wb3J0IHsgQXBwLCBFZGl0b3IsIEVkaXRvclBvc2l0aW9uLCBGaWxlU3lzdGVtQWRhcHRlciB9IGZyb20gXCJvYnNpZGlhblwiO1xuXG5jb25zdCBsb2FkSW1hZ2VCbG9iVGltZW91dCA9IDUwMDA7XG5cbmV4cG9ydCBpbnRlcmZhY2UgRWxlY3Ryb25XaW5kb3cgZXh0ZW5kcyBXaW5kb3cge1xuICAgIFdFQlZJRVdfU0VSVkVSX1VSTDogc3RyaW5nXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRWRpdG9ySW50ZXJuYWxBcGkgZXh0ZW5kcyBFZGl0b3Ige1xuICAgIHBvc0F0TW91c2UoZXZlbnQ6IE1vdXNlRXZlbnQpOiBFZGl0b3JQb3NpdGlvbjtcbiAgICBnZXRDbGlja2FibGVUb2tlbkF0KHBvc2l0aW9uOiBFZGl0b3JQb3NpdGlvbik6IHtcbiAgICAgICAgdGV4dDogc3RyaW5nXG4gICAgfSB8IG51bGw7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRmlsZVN5c3RlbUFkYXB0ZXJXaXRoSW50ZXJuYWxBcGkgZXh0ZW5kcyBGaWxlU3lzdGVtQWRhcHRlciB7XG4gICAgb3BlbihwYXRoOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQXBwV2l0aERlc2t0b3BJbnRlcm5hbEFwaSBleHRlbmRzIEFwcCB7XG4gICAgb3BlbldpdGhEZWZhdWx0QXBwKHBhdGg6IHN0cmluZyk6IFByb21pc2U8dm9pZD47XG4gICAgc2hvd0luRm9sZGVyKHBhdGg6IHN0cmluZyk6IFByb21pc2U8dm9pZD47XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTGlzdGVuZXIge1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgKHRoaXM6IERvY3VtZW50LCBldjogRXZlbnQpOiBhbnk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB3aXRoVGltZW91dDxUPihtczogbnVtYmVyLCBwcm9taXNlOiBQcm9taXNlPFQ+KTogUHJvbWlzZTxUPiB7XG4gICAgY29uc3QgdGltZW91dCA9IG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgY29uc3QgaWQgPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIGNsZWFyVGltZW91dChpZCk7XG4gICAgICAgICAgICByZWplY3QoYHRpbWVkIG91dCBhZnRlciAke21zfSBtc2ApXG4gICAgICAgIH0sIG1zKVxuICAgIH0pXG4gICAgcmV0dXJuIFByb21pc2UucmFjZShbXG4gICAgICAgIHByb21pc2UsXG4gICAgICAgIHRpbWVvdXRcbiAgICBdKSBhcyBQcm9taXNlPFQ+XG59XG5cbi8vIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0hUTUwvQ09SU19lbmFibGVkX2ltYWdlXG4vLyBvcHRpb24/OiBodHRwczovL3d3dy5ucG1qcy5jb20vcGFja2FnZS9odG1sLXRvLWltYWdlXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbG9hZEltYWdlQmxvYihpbWdTcmM6IHN0cmluZyk6IFByb21pc2U8QmxvYj4ge1xuICAgIGNvbnN0IGxvYWRJbWFnZUJsb2JDb3JlID0gKCkgPT4ge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2U8QmxvYj4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgaW1hZ2UgPSBuZXcgSW1hZ2UoKTtcbiAgICAgICAgICAgIGltYWdlLmNyb3NzT3JpZ2luID0gXCJhbm9ueW1vdXNcIjtcbiAgICAgICAgICAgIGltYWdlLm9ubG9hZCA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBjYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiY2FudmFzXCIpO1xuICAgICAgICAgICAgICAgIGNhbnZhcy53aWR0aCA9IGltYWdlLndpZHRoO1xuICAgICAgICAgICAgICAgIGNhbnZhcy5oZWlnaHQgPSBpbWFnZS5oZWlnaHQ7XG4gICAgICAgICAgICAgICAgY29uc3QgY3R4ID0gY2FudmFzLmdldENvbnRleHQoXCIyZFwiKSE7XG4gICAgICAgICAgICAgICAgY3R4LmRyYXdJbWFnZShpbWFnZSwgMCwgMCk7XG4gICAgICAgICAgICAgICAgY2FudmFzLnRvQmxvYigoYmxvYjogQmxvYikgPT4ge1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGJsb2IpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGltYWdlLm9uZXJyb3IgPSBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgZmV0Y2goaW1hZ2Uuc3JjLCB7IFwibW9kZVwiOiBcIm5vLWNvcnNcIiB9KTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhcInBvc3NpYmxlIENPUlMgdmlvbGF0aW9uLCBmYWxsaW5nIGJhY2sgdG8gYWxsT3JpZ2lucyBwcm94eVwiKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2dudW5zL2FsbE9yaWdpbnNcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgYmxvYiA9IGF3YWl0IGxvYWRJbWFnZUJsb2IoYGh0dHBzOi8vYXBpLmFsbG9yaWdpbnMud2luL3Jhdz91cmw9JHtlbmNvZGVVUklDb21wb25lbnQoaW1nU3JjKX1gKTtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShibG9iKTtcbiAgICAgICAgICAgICAgICB9IGNhdGNoIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaW1hZ2Uuc3JjID0gaW1nU3JjO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIHJldHVybiB3aXRoVGltZW91dChsb2FkSW1hZ2VCbG9iVGltZW91dCwgbG9hZEltYWdlQmxvYkNvcmUoKSlcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIG9uRWxlbWVudChcbiAgICBlbDogRG9jdW1lbnQsXG4gICAgZXZlbnQ6IGtleW9mIEhUTUxFbGVtZW50RXZlbnRNYXAsXG4gICAgc2VsZWN0b3I6IHN0cmluZyxcbiAgICBsaXN0ZW5lcjogTGlzdGVuZXIsXG4gICAgb3B0aW9ucz86IHsgY2FwdHVyZT86IGJvb2xlYW47IH1cbikge1xuICAgIGVsLm9uKGV2ZW50LCBzZWxlY3RvciwgbGlzdGVuZXIsIG9wdGlvbnMpO1xuICAgIHJldHVybiAoKSA9PiBlbC5vZmYoZXZlbnQsIHNlbGVjdG9yLCBsaXN0ZW5lciwgb3B0aW9ucyk7XG59Il0sCiAgIm1hcHBpbmdzIjogIjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsdUJBQThFOzs7QUNBOUUsdUJBQXVDOzs7QUNDdkMsc0JBQTREO0FBSTVELDJCQUErQjtBQUMvQixnQkFBMkI7QUFLM0IsdUJBQW9DO0FBRTdCLElBQUksUUFBZ0I7QUFDM0IsSUFBTSx5QkFBeUI7QUFFeEIsSUFBTSxRQUFNLENBQUMsWUFBa0IsbUJBQXlCO0FBQzNELE1BQUksT0FBTztBQUNQLFlBQVEsSUFBSSxTQUFTLEdBQUcsY0FBYztBQUFBLEVBQzFDO0FBQ0o7QUFFTyxrQkFBa0IsT0FBZ0I7QUFDckMsVUFBUTtBQUNaO0FBUU8sSUFBTSxxQkFBcUIsQ0FDakMsYUFDQSxjQUN5QztBQUV6QyxRQUFNLGdCQUFnQixJQUFJLGNB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
