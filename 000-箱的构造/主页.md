---
aliases:
  - HomePage
tags: 
cssclasses:
  - myhome
  - hide-metadata
  - cards
  - 行列标题底色模式
banner: "[[assets/主页.assets/国际服开服.jpg]]"
banner_x: 0.542
banner_y: 0.879
---
> [!dictum] 
> ```dataviewjs
> // 修改标签
> const tag = "#金句"
> // 获取 Obsidian 中的所有 Markdown 文件
> let folderpath="000-箱的构造/箱中memos"
> const files = app.vault.getMarkdownFiles().filter(file=>file.path.includes(folderpath))
> // 将带有标签的文件筛选出来
> const taggedFiles = new Set(files.reduce((acc, file) => {
>     const tags = app.metadataCache.getFileCache(file).tags
>     if (tags) {
>       let filtered = tags.filter(t => t.tag === tag)
>       if (filtered) {
>         return […acc, file]
>       }
>     }
>     return acc
> }, []))
> 
> // 创建带有标签的行数组
> const arr = Array.from(taggedFiles).map(async(file) => {
> const content = await app.vault.cachedRead(file)
> const lines = await content.split("\n").filter(line => line.includes(tag))
> return [file.name, lines]
> })
> 
> // 输出名言
> let randomline = arr[Math.floor(Math.random() * arr.length)];
> if (randomline.startsWith("#金句")) {
>   let sentence = "——" + randomline.substring(4);
>   dv.span("<center>" + sentence + "</center>");
> }

>[!noborder|banner]  &nbsp;
> ```dataviewjs
let ftMd = dv.pages("").file.sort(t => t.cday)[0]
let total = parseInt([new Date() - ftMd.ctime] / (60*60*24*1000))
let nofold = '!"000-箱的构造/插件" and !"000-箱的构造/templates" and !"000-箱的构造/script" and !"assets"'
let allFile = dv.pages(nofold).file
let rolefile = dv.pages('"100-UTTU人物合辑" and !"100-UTTU人物合辑/100-UTTU人物合辑.md" and !"100-UTTU人物合辑/维尔汀｜Vertin.md"').file
let psyfile = dv.pages('"200-相从心生" and !"200-相从心生/200-相从心生.md"').file
let totalRole = "共收录 =="+rolefile.length+"== 位箱中伙伴"
let totalPsy = " =="+psyfile.length+"== 篇心相档案"
let totalTag = "有 =="+allFile.etags.distinct().length+"== 个相关标签"
let greet = '<%+ tp.date.now("A好，今天是YYYY年M月Do dddd") %>。'
dv.paragraph(greet + "第一张档案记录于*"+ new Date(ftMd.ctime).toLocaleDateString("zh-CN", { year: 'numeric', month: '2-digit', day: '2-digit' })+"*，到今天已有=="+total+"==天；"+totalRole+"、"+totalPsy+"，"+totalTag+"。")

```dataviewjs
let ftMd = dv.pages("").file.sort(t => t.cday)[0]
let total = parseInt([new Date() - ftMd.ctime] / (60*60*24*1000))
let nofold = '!"000-箱的构造/插件" and !"000-箱的构造/templates" and !"000-箱的构造/script" and !"assets"'
let allFile = dv.pages(nofold).file
let rolefile = dv.pages('"100-UTTU人物合辑" and !"100-UTTU人物合辑/100-UTTU人物合辑.md" and !"100-UTTU人物合辑/维尔汀｜Vertin.md"').file
let psyfile = dv.pages('"200-相从心生" and !"200-相从心生/200-相从心生.md"').file
let totalRole = "共收录 =="+rolefile.length+"== 位箱中伙伴"
let totalPsy = "共撰写 =="+psyfile.length+"== 篇心相档案"
let totalTag = "有 =="+allFile.etags.distinct().length+"== 个相关标签" 
const progressrole = `<progress value="${Math.round((rolefile.length / 76) * 100)}" max="100" class="nyan-cat"></progress>`
const progresspsy = `<progress value="${Math.round((psyfile.length / 52) * 100)}" max="100" class="nyan-cat"></progress>`
const percentagerole = `${Math.round((rolefile.length / 76) * 100)} %`
const percentagepsy = `${Math.round((psyfile.length / 52) * 100)} %`

dv.span(`
> [!note]+ 撰写进度
     ==角色档案==撰写进度：${progressrole}    **${percentagerole}**
      ==心相档案==撰写进度：${progresspsy}    **${percentagepsy}**
`)

```

